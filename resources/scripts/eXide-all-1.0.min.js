define("eXide/mode/xquery_highlight_rules",function(a,d){var e=a("ace/lib/oop"),g=a("ace/lib/lang"),c=a("ace/mode/text_highlight_rules").TextHighlightRules,b=function(){var a=g.arrayToMap("return|for|let|where|order|by|declare|function|variable|xquery|version|option|namespace|import|module|switch|default|if|then|else|as|and|or|typeswitch|case|ascending|descending|empty|in".split("|"));this.$rules={start:[{token:"text",regex:"<\\!\\[CDATA\\[",next:"cdata"},{token:"xml_pe",regex:"<\\?.*?\\?>"},{token:"comment",
regex:"<\\!--",next:"comment"},{token:"comment",regex:"\\(:",next:"comment"},{token:"text",regex:"<\\/?",next:"tag"},{token:"constant",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"variable",regex:"\\$[a-zA-Z_][a-zA-Z0-9_\\-:]*\\b"},{token:"string",regex:'".*?"'},{token:"string",regex:"'.*?'"},{token:"text",regex:"\\s+"},{token:"support.function",regex:"\\w[\\w+_\\-:]+(?=\\()"},{token:"keyword.operator",regex:"\\*|=|<|>|\\-|\\+|and|or|eq|ne|lt|gt"},{token:"lparen",regex:"[[({]"},
{token:"rparen",regex:"[\\])}]"},{token:function(c){return a[c]?"keyword":"identifier"},regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"}],tag:[{token:"text",regex:">",next:"start"},{token:"keyword",regex:"[-_a-zA-Z0-9:]+"},{token:"text",regex:"\\s+"},{token:"string",regex:'".*?"'},{token:"string",regex:"'.*?'"}],cdata:[{token:"text",regex:"\\]\\]>",next:"start"},{token:"text",regex:"\\s+"},{token:"text",regex:"(?:[^\\]]|\\](?!\\]>))+"}],comment:[{token:"comment",regex:".*?--\>",next:"start"},{token:"comment",
regex:".*:\\)",next:"start"},{token:"comment",regex:".+"}]}};e.inherits(b,c);d.XQueryHighlightRules=b});
define("eXide/mode/behaviour/xquery",function(a,d){var e=a("ace/lib/oop"),g=a("ace/mode/behaviour").Behaviour,c=a("ace/mode/behaviour/cstyle").CstyleBehaviour,b=function(a){this.inherit(c,["braces","parens","string_dquotes"]);this.parent=a;this.add("brackets","insertion",function(a,c,b,f,g){return g=="\n"&&(c=b.getCursorPosition(),f.doc.getLine(c.row).substring(c.column,c.column+2)=="</")?(a=this.$getIndent(f.doc.getLine(c.row))+f.getTabString(),f=this.$getIndent(f.doc.getLine(c.row)),{text:"\n"+
a+"\n"+f,selection:[1,a.length,1,a.length]}):!1});this.add("slash","insertion",function(c,b,g,d,e){e=="/"&&(c=g.getCursorPosition(),b=d.doc.getLine(c.row),c.column>0&&b.charAt(c.column-1)=="<"&&(b=b.substring(0,c.column)+"/"+b.substring(c.column),g=d.doc.getAllLines(),g[c.row]=b,a.exec("closeTag",g.join(d.doc.getNewLineCharacter()),c.row)));return!1})};e.inherits(b,g);d.XQueryBehaviour=b});
define("eXide/mode/xquery",function(a,d){var e=a("ace/lib/oop"),g=a("ace/mode/text").Mode,c=a("ace/tokenizer").Tokenizer,b=a("eXide/mode/xquery_highlight_rules").XQueryHighlightRules,f=a("eXide/mode/behaviour/xquery").XQueryBehaviour,i=a("ace/range").Range,r=function(a){this.$tokenizer=new c((new b).getRules());this.$behaviour=new f(a)};e.inherits(r,g);(function(){this.getNextLineIndent=function(a,c,b){a=this.$getIndent(c);c.match(/\s*(?:then|else|return|[{\(]|<\w+>)\s*$/)&&(a+=b);return a};this.checkOutdent=
function(a,c,b){return!/^\s+$/.test(c)?!1:/^\s*[\}\)]/.test(b)};this.autoOutdent=function(a,c,b){a=c.getLine(b).match(/^(\s*[\}\)])/);if(!a)return 0;var a=a[1].length,f=c.findMatchingBracket({row:b,column:a});if(!f||f.row==b)return 0;f=this.$getIndent(c.getLine(f.row));c.replace(new i(b,0,b,a-1),f)};this.$getIndent=function(a){return(a=a.match(/^(\s+)/))?a[1]:""};this.toggleCommentLines=function(a,c,b,f){for(var g=!0,d=/^\s*\(:(.*):\)/,a=b;a<=f;a++)if(!d.test(c.getLine(a))){g=!1;break}for(var e=new i(0,
0,0,0),a=b;a<=f;a++)b=c.getLine(a),e.start.row=a,e.end.row=a,e.end.column=b.length,c.replace(e,g?b.match(d)[1]:"(:"+b+":)")}}).call(r.prototype);d.Mode=r});
define("eXide/mode/behaviour/xml",function(a,d){var e=a("ace/lib/oop"),g=a("ace/mode/behaviour").Behaviour,c=a("ace/mode/behaviour/cstyle").CstyleBehaviour;a("eXide/mode/behaviour/xquery");var b=function(a){this.inherit(c,["braces","parens","string_dquotes"]);this.parent=a;this.add("brackets","insertion",function(a,c,b,f,g){return g=="\n"&&(c=b.getCursorPosition(),f.doc.getLine(c.row).substring(c.column,c.column+2)=="</")?(a=this.$getIndent(f.doc.getLine(c.row))+f.getTabString(),f=this.$getIndent(f.doc.getLine(c.row)),
{text:"\n"+a+"\n"+f,selection:[1,a.length,1,a.length]}):!1});this.add("slash","insertion",function(c,b,g,d,e){e=="/"&&(c=g.getCursorPosition(),b=d.doc.getLine(c.row),c.column>0&&b.charAt(c.column-1)=="<"&&(b=b.substring(0,c.column)+"/"+b.substring(c.column),g=d.doc.getAllLines(),g[c.row]=b,a.exec("closeTag",g.join(d.doc.getNewLineCharacter()),c.row)));return!1})};e.inherits(b,g);d.XMLBehaviour=b});
define("eXide/mode/xml",function(a,d){var e=a("ace/lib/oop"),g=a("ace/mode/xml").Mode,c=a("ace/tokenizer").Tokenizer,b=a("ace/mode/xml_highlight_rules").XmlHighlightRules,f=a("eXide/mode/behaviour/xml").XMLBehaviour,i=a("ace/range").Range,r=function(a){this.$tokenizer=new c((new b).getRules());this.$behaviour=new f(a)};e.inherits(r,g);(function(){this.toggleCommentLines=function(a,c,b,f){for(var g=!0,d=/^\s*<\!--(.*)--\>/,a=b;a<=f;a++)if(!d.test(c.getLine(a))){g=!1;break}for(var e=new i(0,0,0,0),
a=b;a<=f;a++)b=c.getLine(a),e.start.row=a,e.end.row=a,e.end.column=b.length,c.replace(e,g?b.match(d)[1]:"<\!--"+b+"--\>")}}).call(r.prototype);d.Mode=r});
define("eXide/mode/html",function(a,d){var e=a("ace/lib/oop"),g=a("ace/mode/html").Mode,c=a("ace/tokenizer").Tokenizer,b=a("ace/mode/html_highlight_rules").HtmlHighlightRules,f=a("eXide/mode/behaviour/xml").XMLBehaviour,i=a("ace/range").Range,r=function(a){this.$tokenizer=new c((new b).getRules());this.$behaviour=new f(a)};e.inherits(r,g);(function(){this.toggleCommentLines=function(a,c,b,f){for(var g=!0,d=/^\s*<\!--(.*)--\>/,a=b;a<=f;a++)if(!d.test(c.getLine(a))){g=!1;break}for(var e=new i(0,0,0,
0),a=b;a<=f;a++)b=c.getLine(a),e.start.row=a,e.end.row=a,e.end.column=b.length,c.replace(e,g?b.match(d)[1]:"<\!--"+b+"--\>")}}).call(r.prototype);d.Mode=r});var eXide=eXide||{};eXide.namespace=function(a){var a=a.split("."),d=eXide,e;a[0]=="eXide"&&(a=a.slice(1));for(e=0;e<a.length;e++)typeof d[a[e]]=="undefined"&&(d[a[e]]={}),d=d[a[e]];return d};eXide.namespace("eXide.util");
eXide.util=function(){var a={dir1:"up",dir2:"left",firstpos1:15,firstpos2:15};return{popup:function(a,e,g,c){function b(a){i&&(i.empty(),a.find(".tooltip").each(function(){i.html($(this).html())}))}var f=$(a),i=e?$(e):null,r=null;g.sort(function(a,c){return a.label==c.label?0:a.label>c.label?1:-1});f.empty().css("display","block").focus();a=document.createElement("a");a.href="#";a.className="popup-close";a.appendChild(document.createTextNode("Close"));f.append(a);$(a).click(function(a){a.preventDefault();
f.css("display","none");i&&i.css("display","none")});a=document.createElement("ul");for(e=0;e<g.length;e++){var h=document.createElement("li");if(e==0)h.className="first";h.appendChild(document.createTextNode(g[e].label));if(g[e].tooltip){var t=document.createElement("span");t.className="tooltip";t.appendChild(document.createTextNode(g[e].tooltip));h.appendChild(t)}a.appendChild(h);$(h).click(function(){r.removeClass("selection");$(this).addClass("selection");r=$(this);b(r)});$(h).dblclick(function(){var a=
f.find("li").index(r);f.css("display","none");i&&i.css("display","none");c.call(null,g[a])})}f.append(a);r=f.find("ul li:first").addClass("selection");b(r);var q=$(a).css("position","absolute").scrollTop(0);i&&i.css({display:"block",top:q.offset().top+"px"});var G=q.innerHeight();$(f).keydown(function(a){a.preventDefault();if(a.which==40)a=r.next(),a.length>0&&(r.removeClass("selection"),a.addClass("selection"),r=a,a.position().top+a.height()>=G&&a.get(0).scrollIntoView(),b(a));else if(a.which==38)a=
r.prev(),a.length>0&&(r.removeClass("selection"),a.addClass("selection"),r=a,a.hasClass("first")?q.scrollTop(0):a.position().top<0&&a.get(0).scrollIntoView(),b(a));else if(a.which==13){var d=f.find("li").index(r);f.css("display","none");i&&i.css("display","none");$(f).unbind(a);c.call(null,g[d])}else return f.css("display","none"),i&&i.css("display","none"),$(f).unbind(a),c.call(null,null),!0;return!1})},supportsHtml5Storage:function(){try{return"localStorage"in window&&window.localStorage!==null}catch(a){return!1}},
normalizePath:function(a){for(var a=a.replace(/^xmldb:exist:\/\//,""),e=[],a=a.split("/"),g=a.length-1;g>-1;g--)a[g]==".."?g--:e.push(a[g]);return e.reverse().join("/")},parseSignature:function(a){var e=a.indexOf("(");if(e>-1){var g=a.substring(0,e+1),a=a.substring(e);if(a=a.match(/\$[\w:-_]+/g))for(e=0;e<a.length;e++)e>0&&(g+=", "),g+=a[e];g+=")";return g}return a},message:function(d){$.pnotify({pnotify_text:d,pnotify_shadow:!0,pnotify_hide:!0,pnotify_closer:!0,pnotify_opacity:0.75,pnotify_addclass:"stack-bottomright",
pnotify_stack:a})},error:function(d,e){var g={pnotify_text:d,pnotify_type:"error",pnotify_shadow:!0,pnotify_hide:!0,pnotify_addclass:"stack-bottomright",pnotify_stack:a};if(e)g.pnotify_title=e;$.pnotify(g)}}}();eXide.namespace("eXide.util.Dialog");
eXide.util.Dialog=function(){var a,d=null;$(document).ready(function(){$(document.body).append('<div id="eXide-dialog-message">\t<img id="eXide-dialog-message-icon" src="resources/images/error.png"/>\t<div id="eXide-dialog-message-body"></div></div>');a=$("#eXide-dialog-message");a.dialog({modal:!0,autoOpen:!1,buttons:{OK:function(){$(this).dialog("close")}}});$(document.body).append('<div id="eXide-dialog-input">\t<img id="eXide-dialog-input-icon" src="resources/images/information.png"/>\t<div id="eXide-dialog-input-body"></div></div>');
inputDialog=$("#eXide-dialog-input");inputDialog.dialog({modal:!0,autoOpen:!1,buttons:{OK:function(){$(this).dialog("close");d!=null&&d.apply($("eXide-dialog-input-body"),[])},Cancel:function(){$(this).dialog("close")}}})});return{message:function(d,g){g==null&&(g="");a.dialog("option","title",d);$("#eXide-dialog-message-body").html(g);$("#eXide-dialog-message-icon").attr("src","resources/images/information.png");a.dialog("open")},warning:function(d,g){g==null&&(g="");a.dialog("option","title",d);
$("#eXide-dialog-message-body").html(g);$("#eXide-dialog-message-icon").attr("src","resources/images/error.png");a.dialog("open")},input:function(a,g,c){d=c;inputDialog.dialog("option","title",a);$("#eXide-dialog-input-body").html(g);inputDialog.dialog("open")}}}();eXide.namespace("eXide.util.mimeTypes");
eXide.util.mimeTypes=function(){var a={xml:["text/xml","application/xml","application/xhtml+xml"],xquery:["application/xquery"],css:["text/css"],html:["text/html"],javascript:["application/x-javascript"]};return{getMime:function(a){var e=a.indexOf(";");e>-1&&(a=a.substring(0,e));return a},getLangFromMime:function(d){for(var e in a)for(var g=a[e],c=0;c<g.length;c++)if(d==g[c])return e;return"xquery"},getMimeFromLang:function(d){return(d=a[d])?d[0]:"application/xquery"}}}();eXide.namespace("eXide.util.oop");
eXide.util.oop.inherit=function(){var a=function(){};return function(d,e){a.prototype=e.prototype;d.prototype=new a;d.super_=e.prototype;d.prototype.constructor=d}}();eXide.util.oop.extend=function(){return function(a,d){for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}}();(function(a){a.log=function(){window.console&&window.console.log&&console.log.apply(window.console,arguments)};a.fn.log=function(){a.log(this);return this}})(jQuery);eXide.namespace("eXide.events.Sender");eXide.events.Sender=function(){Constr=function(){};Constr.prototype={addEventListener:function(a,d,e){this.events=this.events||{};var g=this.events[a];g||(g=[],this.events[a]=g);g.push({obj:d,callback:e})},$triggerEvent:function(a,d){this.events=this.events||{};var e=this.events[a];if(e)for(var g=0;g<e.length;g++)e[g].callback.apply(e[g].obj,d)}};return Constr}();eXide.namespace("eXide.edit.commands");
eXide.edit.commands=function(){function a(a,g){return{win:a,mac:g,sender:"editor"}}var d=require("ace/lib/useragent");return{init:function(d){var g=d.editor.commands;$.log("commands: %o",g);g.addCommand({name:"fold",bindKey:a("Alt-L","Alt-F"),exec:function(a){a.editor.session.toggleFold(!1)},readOnly:!0});g.addCommand({name:"unfold",bindKey:a("Alt-Shift-L","Alt-Shift-F"),exec:function(a){a.editor.session.toggleFold(!0)},readOnly:!0});g.addCommand({name:"saveDocument",bindKey:a("Ctrl-Shift-S","Command-Shift-S"),
exec:function(){eXide.app.saveDocument()}});g.addCommand({name:"runQuery",bindKey:a("Ctrl-Return","Command-Return"),exec:function(){eXide.app.runQuery()}});g.addCommand({name:"openDocument",bindKey:a("Ctrl-Shift-O","Command-Shift-O"),exec:function(){eXide.app.openDocument()}});g.addCommand({name:"newDocument",bindKey:a("Ctrl-Shift-N","Command-Shift-N"),exec:function(){eXide.app.newDocument()}});g.addCommand({name:"closeDocument",bindKey:a("Ctrl-Shift-W","Command-Shift-W"),exec:function(){eXide.app.closeDocument()}});
g.addCommand({name:"autocomplete",bindKey:a("Ctrl-Space","Ctrl-Space"),exec:function(){d.autocomplete()}});g.addCommand({name:"nextTab",bindKey:a("Ctrl-Shift-PageDown","Command-Shift-PageDown"),exec:function(){d.nextTab()}});g.addCommand({name:"previousTab",bindKey:a("Ctrl-Shift-PageUp","Command-Shift-PageUp"),exec:function(){d.previousTab()}});g.addCommand({name:"functionDoc",bindKey:a("F1","F1"),exec:function(){d.exec("showFunctionDoc")}});g.addCommand({name:"gotoDefinition",bindKey:a("F3","F3"),
exec:function(){d.exec("gotoDefinition")}});g.addCommand({name:"searchIncremental",bindKey:a("Ctrl-F","Command-F"),exec:function(){d.quicksearch.start()}});g.addCommand({name:"findModule",bindKey:a("F4","F4"),exec:function(){var a=d.getActiveDocument();eXide.find.Modules.select(a.syntax)}});g.addCommand({name:"indentOrParam",bindKey:a("Tab","Tab"),exec:function(){var a=d.getActiveDocument();(!a.template||!a.template.nextParam())&&d.editor.indent()}});g.addCommand({name:"escape",bindKey:a("Esc","Esc"),
exec:function(){d.getActiveDocument().template=null;d.editor.clearSelection()}});g.addCommand({name:"dbManager",bindKey:a("Ctrl-Shift-M","Command-Shift-M"),exec:function(){eXide.app.manage()}})},help:function(a,g){$(a).find("table").each(function(){this.innerHTML="";var a=g.editor.commands;for(key in a.commands){var b=a.commands[key],f=document.createElement("tr"),e=document.createElement("td");e.appendChild(document.createTextNode(b.name));f.appendChild(e);e=document.createElement("td");b.bindKey&&
(d.isMac?e.appendChild(document.createTextNode(b.bindKey.mac)):e.appendChild(document.createTextNode(b.bindKey.win)));f.appendChild(e);this.appendChild(f)}})}}}();eXide.namespace("eXide.edit.ModeHelper");eXide.edit.ModeHelper=function(){Constr=function(a){this.parent=a;this.editor=this.parent.editor;this.commands={}};Constr.prototype={addCommand:function(a,d){if(!this.commands)this.commands={};this.commands[a]=d},exec:function(a,d,e){if(this.commands&&this.commands[a]){for(var d=[d],g=0;g<e.length;g++)d.push(e[g]);$.log("Calling command %s ...",a);this.commands[a].apply(this,d)}else eXide.util.message("Not supported in this mode.")}};return Constr}();eXide.namespace("eXide.edit.XQueryModeHelper");
eXide.edit.XQueryModeHelper=function(){function a(a){var c;c=a.line?a["#text"]:a;var b=e.exec(c),f=-1;b?f=parseInt(b[1])-1:a.line&&(f=parseInt(a.line)-1);return{line:f,msg:c}}var d=/^[\$\w:\-_\.]+/;Constr=function(a){this.parent=a;this.editor=this.parent.editor;this.addCommand("showFunctionDoc",this.showFunctionDoc);this.addCommand("gotoDefinition",this.gotoDefinition);this.addCommand("locate",this.locate);this.addCommand("closeTag",this.closeTag);this.addCommand("importModule",this.importModule)};
eXide.util.oop.inherit(Constr,eXide.edit.ModeHelper);Constr.prototype.closeTag=function(g,c,b){var g="xmldb:exist://"+g.getBasePath(),f=this;$.ajax({type:"POST",url:"modules/compile.xql",data:{q:c,base:g},dataType:"json",success:function(c){c.result=="fail"&&(c=a(c.error),c.line<=b&&(c=/constructor:\s(.*)$/.exec(c.msg),c.length>0&&f.editor.insert(c[1]+">")))},error:function(){}})};Constr.prototype.validate=function(a,c,b){$.log("Running validation...");var f=this,d="xmldb:exist://"+a.getBasePath();
$.ajax({type:"POST",url:"modules/compile.xql",data:{q:c,base:d},dataType:"json",success:function(c){f.compileError(c,a);b.call(this,!0)},error:function(a,c){b.call(this,!0);$.log("Compile error: %s - %s",c,a.responseText)}})};Constr.prototype.compileError=function(g,c){if(g.result=="fail"){var b=a(g.error),f=[{row:b.line,text:b.msg,type:"error"}];this.parent.updateStatus(b.msg,c.getPath()+"#"+b.line);c.getSession().setAnnotations(f)}else this.parent.clearErrors(),this.parent.updateStatus("")};Constr.prototype.autocomplete=
function(a){require("pilot/lang");for(var c=require("ace/range").Range,b=this.editor.getSelection(),f=a.getSession(),b=b.getSelectionLead(),f=f.getDisplayLine(b.row),d=b.column-1,e=b.column;d>=0;){var h=f.substring(d,e);if(h.match(/^\$[\w:\-_\.]+$/))break;if(!h.match(/^[\w:\-_\.]+$/)){d++;break}d--}f=f.substring(d,e);$.log("completing token: %s",f);c=new c(b.row,d,b.row,e);b=this.editor.renderer.textToScreenCoordinates(b.row,b.column);d=this.parent.getHeight();if(b.pageY+150>d)b.pageY=d-150,$.log("window height: %i, pageY: %i",
d,b.pageY);$("#autocomplete-box").css({left:b.pageX+"px",top:b.pageY+10+"px"});$("#autocomplete-help").css({left:b.pageX+324+"px",top:b.pageY+10+"px"});f.length==0?this.templateLookup(a,f,c,!0):this.functionLookup(a,f,c,!0);return!0};Constr.prototype.$localVars=function(a,c){for(var b=[],f=/declare function|};/,d=/let \$[\w\:]+|for \$[\w\:]+|\$[\w\:]+\)/,e=/\$[\w\:]+/,h=RegExp("^\\"+a),t=this.editor.getSession(),q=c.start.row;q>-1;){var G=t.getDisplayLine(q),A;if(A=G.match(d))$.log("Var: %s",A[0]),
A=A[0].match(e),A[0].match(h)&&b.push({name:A[0],type:"variable"});if(G.match(f)){$.log("Stop: %s",G);break}q--}return b};Constr.prototype.functionLookup=function(a,c,b,f){var d=this;$.ajax({url:"modules/docs.xql",dataType:"text",type:"POST",data:{prefix:c},success:function(e){var e=$.parseJSON(e),h=[],t;c.substring(0,1)=="$"?(t="^\\"+c,h=d.$localVars(c,b,f)):t="^"+c;var q=RegExp(t);$.each(a.functions,function(a,c){c.name.match(q)&&h.push(c)});e&&(h=h.concat(e));e=[];for(t=0;t<h.length;t++){var G=
{label:h[t].signature?h[t].signature:h[t].name,type:h[t].type};if(h[t].help)G.tooltip=h[t].help;e.push(G)}d.$addTemplates(c,e);d.$showPopup(a,b,e)},error:function(a,c){eXide.util.error(c)}})};Constr.prototype.templateLookup=function(a,c,b){var f=[];this.$addTemplates(c,f);this.$showPopup(a,b,f)};Constr.prototype.$addTemplates=function(a,c){for(var b=this.parent.outline.getTemplates(a),f=0;f<b.length;f++)c.push({type:"template",label:"[S] "+b[f].name,tooltip:b[f].help,template:b[f].template})};Constr.prototype.$showPopup=
function(a,c,b){var f=this;eXide.util.popup($("#autocomplete-box"),$("#autocomplete-help"),b,function(b){if(b){var d=b.label;b.type=="template"?d=b.template:b.type=="function"&&(d=eXide.util.parseSignature(d));a.template=new eXide.edit.Template(f.parent,c,d,b.type);a.template.insert()}f.editor.focus()})};Constr.prototype.getFunctionAtCursor=function(a){var c=a.row,c=this.editor.getSession().getDisplayLine(c),b=a.column;do b--;while(b>=0&&c.charAt(b).match(d));b++;for(a=a.column;a<c.length&&c.charAt(a).match(d);)a++;
return c.substring(b,a)};Constr.prototype.showFunctionDoc=function(a){var c=this.editor.getSelection().getSelectionLead(),b=this.editor.renderer.textToScreenCoordinates(c.row,c.column);$("#autocomplete-box").css({left:b.pageX+"px",top:b.pageY+20+"px"});$("#autocomplete-help").css({left:b.pageX+324+"px",top:b.pageY+20+"px"});c=this.getFunctionAtCursor(c);this.functionLookup(a,c,null,!1)};Constr.prototype.gotoDefinition=function(a){var c=this.getFunctionAtCursor(this.editor.getSelection().getSelectionLead());
c&&this.parent.outline.gotoDefinition(a,c)};Constr.prototype.locate=function(a,c,b){switch(c){case "function":this.gotoFunction(a,b);break;default:this.gotoVarDecl(a,b)}};Constr.prototype.gotoFunction=function(a,c){$.log("Goto function %s",c);var b=this.getModuleNamespacePrefix();b!=null&&(c=c.replace(/[^:]+:/,b+":"));for(var b=RegExp("function\\s+"+c+"\\s*\\("),f=a.$session.getLength(),d=0;d<f;d++)if(a.$session.getLine(d).match(b)){this.editor.gotoLine(d+1);this.editor.focus();break}};Constr.prototype.gotoVarDecl=
function(a,c){var b=this.getModuleNamespacePrefix();b!=null&&(c=c.replace(/[^:]+:/,"$"+b+":"));$.log("Goto variable declaration %s",c);for(var b=RegExp("variable\\s+\\"+c),f=a.$session.getLength(),d=0;d<f;d++)if(a.$session.getLine(d).match(b)){this.editor.gotoLine(d+1);this.editor.focus();break}};Constr.prototype.getModuleNamespacePrefix=function(){for(var a=/^\s*module\s+namespace\s+([^=\s]+)\s*=/,c=this.parent.getActiveDocument().$session.getLength(),b=0;b<c;b++){var f=this.parent.getActiveDocument().$session.getLine(b).match(a);
if(f)return f[1]}return null};Constr.prototype.importModule=function(a,c,b,f){$.log("location = %s path = %s",f,a.path);a=a.getBasePath();f=f.lastIndexOf(a,0)===0?f.substring(a.length+1):"xmldb:exist://"+f;this.editor.insert("import module namespace "+c+'="'+b+'" at "'+f+'";\n')};var e=/.*line:?\s(\d+)/i;return Constr}();eXide.namespace("eXide.edit.XMLModeHelper");
eXide.edit.XMLModeHelper=function(){Constr=function(a){this.parent=a;this.editor=this.parent.editor;this.addCommand("closeTag",this.closeTag)};eXide.util.oop.inherit(Constr,eXide.edit.ModeHelper);Constr.prototype.closeTag=function(a,d,e){a.getBasePath();var g=this;$.ajax({type:"POST",url:"modules/validate-xml.xql",data:{xml:d},dataType:"json",success:function(a){a.status&&a.status=="invalid"&&parseInt(a.message.line)-1<=e&&(a=/element type \"([^\"]+)\"/.exec(a.message["#text"]),a.length>0&&g.editor.insert(a[1]+
">"))},error:function(){}})};Constr.prototype.validate=function(a,d,e){var g=this;$.ajax({type:"POST",url:"modules/validate-xml.xql",data:{xml:d},dataType:"json",success:function(c){g.compileError(c,a);e.call(this,!0)},error:function(a,b){e.call(this,!0);$.log("Compile error: %s - %s",b,a.responseText)}})};Constr.prototype.compileError=function(a,d){$.log("Validation returned %o",a);if(a.status&&a.status=="invalid"){var e=[{row:parseInt(a.message.line)-1,text:a.message["#text"],type:"error"}];$.log("annotation: %o",
e);this.parent.updateStatus(a.message["#text"],d.getPath()+"#"+a.message.line);d.getSession().setAnnotations(e)}else this.parent.clearErrors(),this.parent.updateStatus("")};return Constr}();eXide.namespace("eXide.edit.Outline");
eXide.edit.Outline=function(){Constr=function(){this.funcDefRe=/declare\s+function\s+([^\(]+)\(/g;this.varDefRe=/declare\s+variable\s+\$[^\s;]+/gm;this.varRe=/declare\s+variable\s+(\$[^\s;]+)/;this.parseImportRe=/import\s+module\s+namespace\s+[^=]+\s*=\s*["'][^"']+["']\s*at\s+["'][^"']+["']\s*;/g;this.moduleRe=/import\s+module\s+namespace\s+([^=\s]+)\s*=\s*["']([^"']+)["']\s*at\s+["']([^"']+)["']\s*;/;this.currentDoc=null;this.templates=[];this.$loadTemplates()};Constr.prototype={getTemplates:function(a){for(var a=
RegExp("^"+a),d=[],e=0;e<this.templates.length;e++)this.templates[e].name.match(a)&&d.push(this.templates[e]);return d},gotoDefinition:function(a,d){$.each(a.functions,function(a,g){d==g.name&&eXide.app.locate(g.type,g.source==""?null:g.source,d)})},updateOutline:function(a){this.currentDoc=a;a.functions=[];$("#outline").empty();if(a.getMime()=="application/xquery"){var d=a.getText();this.$parseLocalFunctions(d,a);this.$outlineUpdate(a);(d=this.$parseImports(d))&&this.$resolveImports(a,d)}},clearOutline:function(){$("#outline").empty()},
$parseLocalFunctions:function(a,d){for(d.functions=[];;){var e=this.funcDefRe.exec(a);if(e==null)break;var g=this.funcDefRe.lastIndex,c=this.$findMatchingParen(a,g);d.functions.push({type:"function",name:e[1],signature:e[1]+"("+a.substring(g,c)+")"})}if(e=a.match(this.varDefRe))for(g=0;g<e.length;g++)c=this.varRe.exec(e[g]),d.functions.push({type:"variable",name:c[1]})},$findMatchingParen:function(a,d){for(var e=1,g=d;g<a.length;g++){var c=a.charAt(g);if(c==")"){if(e-=1,e==0)return g}else c=="("&&
(e+=1)}return-1},$parseImports:function(a){return a.match(this.parseImportRe)},$resolveImports:function(a,d){for(var e=this,g=[],c=[],b=0;b<d.length;b++){var f=this.moduleRe.exec(d[b]);f!=null&&f.length==4&&(c.push("prefix="+encodeURIComponent(f[1])),c.push("uri="+encodeURIComponent(f[2])),c.push("source="+encodeURIComponent(f[3])))}b="xmldb:exist://"+a.getBasePath();c.push("base="+encodeURIComponent(b));$.ajax({url:"outline",dataType:"json",type:"POST",data:c.join("&"),success:function(c){if(c!=
null){for(var c=c.modules,b=0;b<c.length;b++){var f=c[b].functions;if(f)for(var d=0;d<f.length;d++)g.push({type:"function",name:f[d].name,signature:f[d].signature,source:c[b].source});if(f=c[b].variables)for(d=0;d<f.length;d++)g.push({type:"variable",name:"$"+f[d],source:c[b].source})}a.functions=a.functions.concat(g);e.$outlineUpdate(a)}}});return g},$sortFunctions:function(a){a.functions.sort(function(a,e){return a.name==e.name?0:a.name>e.name?1:-1})},$outlineUpdate:function(a){this.$sortFunctions(a);
if(this.currentDoc==a){$("body").layout().open("west");eXide.app.resize();var d=$("#outline");d.empty();for(var e=0;e<a.functions.length;e++){var g=a.functions[e],c=document.createElement("li"),b=document.createElement("a");if(g.signature)b.title=g.signature;b.className=g.type=="function"?"t_function":"t_variable";b.href=g.source?"#"+g.source:"#";b.appendChild(document.createTextNode(g.name));c.appendChild(b);d.append(c);$(b).click(function(){var a=this.hash.substring(1);this.className=="t_function"?
eXide.app.locate("function",a==""?null:a,$(this).text()):eXide.app.locate("variable",a==""?null:a,$(this).text());return!1})}}},$loadTemplates:function(){var a=this;$.ajax({url:"templates/snippets.xml",dataType:"xml",type:"GET",success:function(d){$(d).find("snippet").each(function(){var d=$(this),g=d.attr("abbrev"),c=d.find("description").text(),d=d.find("code").text();a.templates.push({TYPE:"template",name:g,help:c,template:d})})}})}};return Constr}();eXide.namespace("eXide.edit.Document");
eXide.edit.Document=function(){Constr=function(a,d,e){this.name=a;this.path=d;this.mime="application/xquery";this.syntax="xquery";this.saved=!1;this.editable=!0;this.functions=[];this.helper=null;this.history=[];this.$session=e;a=eXide.app.getPreferences().softWrap;this.$session.setUseWrapMode(a!=0);a>0?this.$session.setWrapLimitRange(a,a):a<0&&this.$session.setWrapLimitRange(null,null)};Constr.prototype.getText=function(){return this.$session.getValue()};Constr.prototype.getName=function(){return this.name};
Constr.prototype.getPath=function(){return this.path};Constr.prototype.setPath=function(a){this.path=a};Constr.prototype.getBasePath=function(){return this.path.replace(/(^.+)\/[^\/]*$/,"$1")};Constr.prototype.getMime=function(){return this.mime};Constr.prototype.getSyntax=function(){return this.syntax};Constr.prototype.getSession=function(){return this.$session};Constr.prototype.isSaved=function(){return this.saved};Constr.prototype.isEditable=function(){return this.editable};Constr.prototype.isXQuery=
function(){return this.mime=="application/xquery"};Constr.prototype.setModeHelper=function(a){this.helper=a};Constr.prototype.getModeHelper=function(){return this.helper};Constr.prototype.addToHistory=function(a){this.history.push(a)};Constr.prototype.getLastLine=function(){return this.history.pop(line)};Constr.prototype.getCurrentLine=function(){return this.$session.getSelection().getSelectionLead().row};return Constr}();eXide.namespace("eXide.edit.Editor");
eXide.edit.Editor=function(){var a=require("ace/virtual_renderer").VirtualRenderer,d=require("ace/editor").Editor,e=require("ace/edit_session").EditSession,g=require("ace/undomanager").UndoManager;Constr=function(c){var b=this;b.container=c;b.documents=[];b.activeDoc=null;b.tabCounter=0;b.newDocCounter=0;b.pendingCheck=!1;b.themes={};c=new a(b.container,"ace/theme/eclipse");c.setShowGutter(!0);this.editor=new d(c);this.editor.setBehavioursEnabled(!0);eXide.edit.commands.init(b);this.outline=new eXide.edit.Outline;
this.addEventListener("activate",this.outline,this.outline.updateOutline);this.addEventListener("validate",this.outline,this.outline.updateOutline);this.addEventListener("close",this.outline,this.outline.clearOutline);this.status=document.getElementById("error-status");$(this.status).click(function(a){a.preventDefault();var c=this.pathname,a=this.hash.substring(1);if(c=b.getDocument(c))b.switchTo(c),b.editor.gotoLine(parseInt(a)+1)});this.quicksearch=new eXide.find.IncrementalSearch($("#search-box"),
this.editor);$("#tab-next").button({icons:{primary:"ui-icon-triangle-1-e"},text:!1}).click(function(){b.nextTab()});$("#tab-prev").button({icons:{primary:"ui-icon-triangle-1-w"},text:!1}).click(function(){b.previousTab()});this.lastChangeEvent=(new Date).getTime();this.validateTimeout=null;b.modes={xquery:new eXide.edit.XQueryModeHelper(b),xml:new eXide.edit.XMLModeHelper(b),html:new eXide.edit.XMLModeHelper(b)}};eXide.util.oop.inherit(Constr,eXide.events.Sender);Constr.prototype.init=function(){this.documents.length==
0&&this.newDocument()};Constr.prototype.exec=function(){if(this.activeDoc.getModeHelper()){var a=Array.prototype.slice.call(arguments,1);this.activeDoc.getModeHelper().exec(arguments[0],this.activeDoc,a)}else eXide.util.message("Not supported in this mode.")};Constr.prototype.getActiveDocument=function(){return this.activeDoc};Constr.prototype.getText=function(){return this.activeDoc.getText()};Constr.prototype.newDocument=function(a){for(var b=0,f=0;f<this.documents.length;f++)this.documents[f].path.match(/^__new__(\d+)/)&&
(b=parseInt(RegExp.$1));b++;a=typeof a=="string"?new e(a):new e('xquery version "1.0";\n');this.$initDocument(new eXide.edit.Document("new-document "+b,"__new__"+b,a))};Constr.prototype.newDocumentWithText=function(a,b,f){a=new eXide.edit.Document(f.name,f.path,new e(a));a.editable=f.writable;a.mime=b;a.syntax=eXide.util.mimeTypes.getLangFromMime(b);a.saved=!1;f.line&&(a.addToHistory(f.line),this.editor.gotoLine(f.line));this.$initDocument(a)};Constr.prototype.openDocument=function(a,b,f){f.writable?
eXide.util.message("Opening "+f.path):eXide.util.message("Opening "+f.path+" readonly!");a=new eXide.edit.Document(f.name,f.path,new e(a));a.editable=f.writable;a.mime=b;a.syntax=eXide.util.mimeTypes.getLangFromMime(b);a.saved=!0;f.line&&(a.addToHistory(f.line),b=a.$session.getSelection(),b.clearSelection(),b.moveCursorTo(f.line,1),a.$session.setScrollTop(f.line));$.log("opening %s, mime: %s, syntax: %s, line: %i",f.name,a.mime,a.syntax,f.line);this.$initDocument(a)};Constr.prototype.$initDocument=
function(a){var b=this;b.$setMode(a);a.$session.setUndoManager(new g);a.$session.addEventListener("change",function(){if(a.saved)a.saved=!1,b.updateTabStatus(a.path,a);b.triggerCheck()});b.addTab(a);b.editor.setSession(a.$session);b.editor.resize();b.editor.focus()};Constr.prototype.setMode=function(a){this.activeDoc.syntax=a;this.$setMode(this.activeDoc,!0)};Constr.prototype.$setMode=function(a,b){switch(a.getSyntax()){case "xquery":var f=require("eXide/mode/xquery").Mode;a.$session.setMode(new f(this));
if(b)a.mime="application/xquery";break;case "xml":f=require("eXide/mode/xml").Mode;a.$session.setMode(new f(this));if(b)a.mime="application/xml";break;case "html":f=require("eXide/mode/html").Mode;a.$session.setMode(new f(this));if(b)a.mime="text/html";break;case "javascript":f=require("ace/mode/javascript").Mode;a.$session.setMode(new f);if(b)a.mime="application/x-javascript";break;case "css":if(f=require("ace/mode/css").Mode,a.$session.setMode(new f),b)a.mime="text/css"}a.setModeHelper(this.modes[a.getSyntax()])};
Constr.prototype.closeDocument=function(){this.$triggerEvent("close",[this.activeDoc]);$('#tabs a[title="'+this.activeDoc.path+'"]').parent().remove();for(var a=0;a<this.documents.length;a++)this.documents[a].path==this.activeDoc.path&&this.documents.splice(a,1);this.documents.length==0?this.newDocument():(this.activeDoc=this.documents[this.documents.length-1],$('#tabs a[title="'+this.activeDoc.path+'"]').addClass("active"),this.editor.setSession(this.activeDoc.$session),this.editor.resize(),this.$triggerEvent("activate",
[this.activeDoc]))};Constr.prototype.saveDocument=function(a,b,f){var d=this,g=d.activeDoc.path,e=d.activeDoc.name;if(a)d.activeDoc.path=a.path,d.activeDoc.name=a.name;eXide.util.message("Storing resource "+d.activeDoc.name+"...");a={path:d.activeDoc.path,data:d.activeDoc.getText()};if(d.activeDoc.mime)a.mime=d.activeDoc.mime;$.ajax({url:"modules/store.xql",type:"POST",data:a,dataType:"json",success:function(a){a.status=="error"?f?f.apply(d.activeDoc,[a.message]):eXide.util.error(a.message):(d.activeDoc.saved=
!0,d.updateTabStatus(g,d.activeDoc),b?b.apply(d.activeDoc):eXide.util.message(d.activeDoc.name+" stored."))},error:function(a){d.activeDoc.path=g;d.activeDoc.name=e;f?f.apply(d.activeDoc,a.responseText):eXide.util.error(a.responseText)}})};Constr.prototype.getDocument=function(a){for(var a=eXide.util.normalizePath(a),b=0;b<this.documents.length;b++)if(this.documents[b].path==a)return this.documents[b]};Constr.prototype.onInput=function(a,b){var f=a.getModeHelper();if(f&&f.onInput)f.onInput(a,b)};
Constr.prototype.autocomplete=function(){var a=this.activeDoc.getModeHelper();a&&a.autocomplete&&a.autocomplete(this.activeDoc)};Constr.prototype.getHeight=function(){return $(this.container).height()};Constr.prototype.resize=function(){this.editor.resize()};Constr.prototype.clearErrors=function(){this.editor.getSession().clearAnnotations()};Constr.prototype.forEachDocument=function(a){for(var b=0;b<this.documents.length;b++)a(this.documents[b])};Constr.prototype.addTab=function(a){var b=this,f="t"+
b.tabCounter++,d=a.name;a.saved||(d+="*");$("#tabs li a").removeClass("active");var g=document.createElement("li"),e=document.createElement("a");e.appendChild(document.createTextNode(d));e.className="tab active";e.id=f;e.title=a.path;g.appendChild(e);$("#tabs").append(g);$(e).click(function(f){f.preventDefault();b.switchTo(a)});b.activeDoc=a;b.documents.push(a);b.$triggerEvent("activate",[a]);b.scrollToTab($(e))};Constr.prototype.nextTab=function(){if(!(this.documents.length<2)){for(var a=0,b=0;b<
this.documents.length;b++)if(this.documents[b]==this.activeDoc){a=b;break}a==this.documents.length-1?a=0:a++;this.switchTo(this.documents[a])}};Constr.prototype.previousTab=function(){if(!(this.documents.length<2)){for(var a=0,b=0;b<this.documents.length;b++)if(this.documents[b]==this.activeDoc){a=b;break}a==0?a=this.documents.length-1:a--;this.switchTo(this.documents[a])}};Constr.prototype.switchTo=function(a){this.editor.setSession(a.$session);this.editor.resize();this.activeDoc=a;var b=this;$("#tabs a").each(function(){var f=
$(this);this.title==a.path?(f.addClass("active"),b.scrollToTab(f)):f.removeClass("active")});this.updateStatus("");this.$triggerEvent("activate",[a])};Constr.prototype.updateTabStatus=function(a,b){var f;f=b.saved?b.name:b.name+"*";$('#tabs a[title="'+a+'"]').attr("title",b.path).text(f)};Constr.prototype.scrollToTab=function(a){var b=a.offset().left,a=b+a.outerWidth(),f=$("#tabs").innerWidth(),d=$("#tabs").scrollLeft();a>f?($("#tab-next").show(),$("#tab-prev").show(),$("#tabs").scrollLeft(a-f)):
b<d&&(b<f?$("#tabs").scrollLeft(0):$("#tabs").scrollLeft(b));$.log("Scrolling to %d %d",b,$("#tabs").scrollLeft())};Constr.prototype.setTheme=function(a){$.log("Changing theme to %s",a);var b=this;b.loadTheme(a,function(){b.editor.setTheme("ace/theme/"+a)})};Constr.prototype.loadTheme=function(a,b){if(this.themes[a])return b();require("ace/lib/net");this.themes[a]=1;var f="resources/scripts/ace/theme-"+a.split("/").pop()+".js",d=document.getElementsByTagName("head")[0],g=document.createElement("script");
g.src=f;d.appendChild(g);g.onload=b};Constr.prototype.updateStatus=function(a,b){this.status.innerHTML=a;if(b)this.status.href=b};Constr.prototype.triggerCheck=function(){if(this.activeDoc.getModeHelper()){var a=this;if(!a.pendingCheck){var b=(new Date).getTime();a.validateTimeout&&b-a.lastChangeEvent<2E3&&clearTimeout(a.validateTimeout);a.lastChangeEvent=b;a.validateTimeout=setTimeout(function(){a.validate.apply(a)},2E3)}}};Constr.prototype.validate=function(){var a=this,b=a.activeDoc.getModeHelper();
if(b&&b.validate)a.pendingCheck=!0,$.log("Running validation..."),b.validate(a.activeDoc,a.getText(),function(){a.pendingCheck=!1}),a.$triggerEvent("validate",[a.activeDoc])};Constr.prototype.evalError=function(a){var b=/.*line\s(\d+)/i.exec(a),f=-1;b&&(f=parseInt(b[1]));$.log("error in line %d",b[1]);this.editor.focus();this.editor.gotoLine(f);b=[{row:f-1,text:a,type:"error"}];this.updateStatus(a);this.editor.getSession().setAnnotations(b)};Constr.prototype.focus=function(){this.editor.focus()};
Constr.prototype.saveState=function(){var a=0;$.each(this.documents,function(b,f){f.path.match("^__new__.*")?(localStorage["eXide."+a+".path"]=f.path,localStorage["eXide."+a+".name"]=f.name,localStorage["eXide."+a+".mime"]=f.mime,localStorage["eXide."+a+".data"]=f.getText(),localStorage["eXide."+a+".last-line"]=f.getCurrentLine()):(localStorage["eXide."+a+".path"]=f.path,localStorage["eXide."+a+".name"]=f.name,localStorage["eXide."+a+".mime"]=f.mime,localStorage["eXide."+a+".writable"]=f.editable?
"true":"false",localStorage["eXide."+a+".last-line"]=f.getCurrentLine(),f.saved||(localStorage["eXide."+a+".data"]=f.getText()));a++});localStorage["eXide.documents"]=a};return Constr}();$(document).ready(function(){var a=function(a){if(a=="")return{};for(var e={},g=0;g<a.length;++g){var c=a[g].split("=");c.length==2&&(e[c[0]]=decodeURIComponent(c[1].replace(/\+/g," ")))}return e}(window.location.search.substr(1).split("&"));eXide.app.init(function(d){var e=a.open,g=a.snip;e&&!d[e]?eXide.app.findDocument(a.open):g&&eXide.app.newDocument(g)})});eXide.namespace("eXide.app");
eXide.app=function(){var a,d,e,g=0,c=0,b=0,f=0,i={theme:"ace/theme/dawn",fontSize:"12px",showInvisibles:!1,showPrintMargin:!0,showHScroll:!1,softWrap:"free"};return{init:function(b){a=new eXide.edit.Editor(document.getElementById("editor"));d=new eXide.edit.PackageEditor(document.getElementById("deployment-editor"));e=new eXide.browse.Browser(document.getElementById("open-dialog"));eXide.app.initGUI();var c=eXide.app.restoreState();a.init();a.addEventListener("outlineChange",eXide.app.onOutlineChange);
eXide.app.resize();$(window).resize(eXide.app.resize);$(window).unload(function(){eXide.app.saveState()});eXide.find.Modules.addEventListener("open",null,function(a){eXide.app.findDocument(a.at)});eXide.find.Modules.addEventListener("import",null,function(b){a.exec("importModule",b.prefix,b.uri,b.at)});b&&b(c)},resize:function(){$("#editor");$(".header");a.resize()},newDocument:function(b){a.newDocument(b)},findDocument:function(b){var c=a.getDocument(b);c==null?(b={name:b.match(/[^\/]+$/),path:b},
eXide.app.$doOpenDocument(b)):a.switchTo(c)},locate:function(b,c,f){if(c==null)a.exec("locate",b,f);else{$.log("Locating %s in document %s",f,c);var d=a.getDocument(c);d==null?(c={name:c.match(/[^\/]+$/),path:c},eXide.app.$doOpenDocument(c,function(){a.exec("locate",b,f)})):(a.switchTo(d),a.exec("locate",b,f))}},openDocument:function(){e.reload(["reload"],"open");$("#open-dialog").dialog("option","title","Open Document");$("#open-dialog").dialog("option","buttons",{cancel:function(){$(this).dialog("close");
a.focus()},open:eXide.app.openSelectedDocument});$("#open-dialog").dialog("open")},openSelectedDocument:function(a){var b=e.getSelection();b&&eXide.app.$doOpenDocument(b);(a==void 0||a)&&$("#open-dialog").dialog("close")},$doOpenDocument:function(b,c){b.path=eXide.util.normalizePath(b.path);var f=a.getDocument(b.path);f?a.switchTo(f):$.ajax({url:"modules/load.xql?path="+b.path,dataType:"text",success:function(f,d,g){d=eXide.util.mimeTypes.getMime(g.getResponseHeader("Content-Type"));a.openDocument(f,
d,b);c&&c.call(null,b)},error:function(a){eXide.util.error("Failed to load document "+b.path+": "+a.status+" "+a.statusText)}})},closeDocument:function(){a.getActiveDocument().isSaved()?a.closeDocument():$("#dialog-confirm-close").dialog({resizable:!1,height:140,modal:!0,buttons:{Close:function(){$(this).dialog("close");a.closeDocument()},Cancel:function(){$(this).dialog("close")}}})},saveDocument:function(){eXide.app.requireLogin(function(){a.getActiveDocument().getPath().match("^__new__")?(e.reload(["reload",
"create"],"save"),$("#open-dialog").dialog("option","title","Save Document"),$("#open-dialog").dialog("option","buttons",{Cancel:function(){$(this).dialog("close")},Save:function(){a.saveDocument(e.getSelection(),function(){$("#open-dialog").dialog("close");d.autoSync(a.getActiveDocument().getBasePath())},function(a){eXide.util.Dialog.warning("Failed to Save Document",a)})}}),$("#open-dialog").dialog("open")):a.saveDocument(null,function(){eXide.util.message(a.getActiveDocument().getName()+" stored.");
d.autoSync(a.getActiveDocument().getBasePath())},function(a){eXide.util.Dialog.warning("Failed to Save Document",a)})})},saveDocumentAs:function(){eXide.app.requireLogin(function(){e.reload(["reload","create"],"save");$("#open-dialog").dialog("option","title","Save Document As ...");$("#open-dialog").dialog("option","buttons",{Cancel:function(){$(this).dialog("close")},Save:function(){a.saveDocument(e.getSelection(),function(){$("#open-dialog").dialog("close");d.autoSync(a.getActiveDocument().getBasePath())},
function(a){eXide.util.Dialog.warning("Failed to Save Document",a)})}});$("#open-dialog").dialog("open")})},exec:function(){a.exec(arguments)},download:function(){var b=a.getActiveDocument();b.getPath().match("^__new__")||!b.isSaved()?eXide.util.error("There are unsaved changes in the document. Please save it first."):window.location.href="modules/load.xql?download=true&path="+encodeURIComponent(b.getPath())},runQuery:function(){a.updateStatus("Running query ...");var d=a.getText(),e="xmldb:exist://"+
a.getActiveDocument().getBasePath();$("#results-container .results").empty();$.ajax({type:"POST",url:"execute",dataType:"xml",data:{qu:d,base:e},success:function(d){d=d.documentElement;if(d.nodeName=="error")d=$(d).text(),eXide.util.error(d,"Compilation Error"),a.evalError(d);else{a.updateStatus("");a.clearErrors();var e=$("body").layout();e.open("south");e.sizePane("south",300);eXide.app.resize();b=c=1;g=d.getAttribute("hits");f=c+10-1;g<f&&(f=g);eXide.util.message("Found "+g+" in "+d.getAttribute("elapsed")+
"s");eXide.app.retrieveNext()}},error:function(a){eXide.util.error(a.responseText,"Server Error")}})},checkQuery:function(){a.validate()},retrieveNext:function(){$.log("retrieveNext: %d",b);if(b>0&&b<=f){var a="results/"+b;b++;$.ajax({url:a,dataType:"html",success:function(a){$("#results-container .results").append(a);$("#results-container .current").text("Showing results "+c+" to "+(b-1)+" of "+g);$("#results-container .pos:last a").click(function(){eXide.app.findDocument(this.pathname);return!1});
eXide.app.retrieveNext()}})}},browseNext:function(){b>0&&f<g&&(c=b,f=b+10-1,g<f&&(f=g),$("#results-container .results").empty(),eXide.app.retrieveNext());return!1},browsePrevious:function(){b>0&&c>1&&(c-=10,c<1&&(c=1),b=c,f=b+9,g<f&&(f=g),$("#results-container .results").empty(),eXide.app.retrieveNext());return!1},manage:function(){eXide.app.requireLogin(function(){e.reload(["reload","create","upload","open","cut","copy","paste"],"manage");$("#open-dialog").dialog("option","title","DB Manager");$("#open-dialog").dialog("option",
"buttons",{Close:function(){$(this).dialog("close")}});$("#open-dialog").dialog("open")})},deploymentSettings:function(){var b=/^(.*)\/[^\/]+$/.exec(a.getActiveDocument().getPath());b&&eXide.app.requireLogin(function(){$.log("Editing deployment settings for collection: %s",b[1]);d.open(b[1])})},newDeployment:function(){eXide.app.requireLogin(function(){d.open()})},deploy:function(){eXide.app.requireLogin(function(){var b=/^(.*)\/[^\/]+$/.exec(a.getActiveDocument().getPath());if(!b)return eXide.util.error("The file open in the editor does not belong to an application package!"),
!1;$.log("Deploying application from collection: %s",b[1]);d.deploy(b[1])});return!1},synchronize:function(){eXide.app.requireLogin(function(){var b=/^(.*)\/[^\/]+$/.exec(a.getActiveDocument().getPath());b?d.synchronize(b[1]):eXide.util.error("The file open in the editor does not belong to an application package!")})},downloadApp:function(){eXide.app.requireLogin(function(){var b=/^(.*)\/[^\/]+$/.exec(a.getActiveDocument().getPath());$.log("downloading %s",b);b?d.download(b[1]):eXide.util.error("The file open in the editor does not belong to an application package!")})},
openApp:function(){var b=/^(.*)\/[^\/]+$/.exec(a.getActiveDocument().getPath());b?d.runApp(b[1]):eXide.util.error("The file open in the editor does not belong to an application package!")},preferences:function(){var a=$("#preferences-dialog form");$('select[name="theme"]',a).val(i.theme);$('select[name="font-size"]',a).val(i.fontSize);$('input[name="show-invisibles"]',a).attr("checked",i.showInvisibles);$('input[name="print-margin"]',a).attr("checked",i.showPrintMargin);var b=i.softWrap;b==0?b="off":
b===-1&&(b="free");$('input[name="soft-wrap"]',a).val(b);$("#preferences-dialog").dialog("open")},applyPreferences:function(){$.log("preferences: %o",i);a.setTheme(i.theme);a.editor.setShowInvisibles(i.showInvisibles);a.editor.renderer.setShowPrintMargin(i.showPrintMargin);a.forEachDocument(function(a){i.softWrap>0?a.getSession().setWrapLimitRange(i.softWrap,i.softWrap):i.softWrap<0&&a.getSession().setWrapLimitRange(null,null);a.getSession().setUseWrapMode(i.softWrap!=0)});$("#editor").css("font-size",
i.fontSize);a.resize()},getPreferences:function(){return i},restoreState:function(){if(!eXide.util.supportsHtml5Storage)return!1;for(conf in i){var b="eXide.preferences."+conf;localStorage[b]&&(i[conf]=localStorage[b]=="true"?!0:localStorage[b]=="false"?!1:localStorage[b])}eXide.app.applyPreferences();var b={},c=localStorage["eXide.documents"];c||(c=0);for(var f=0;f<c;f++){var g={path:localStorage["eXide."+f+".path"],name:localStorage["eXide."+f+".name"],writable:localStorage["eXide."+f+".writable"]==
"true",line:parseInt(localStorage["eXide."+f+".last-line"])};$.log("Restoring doc %s, going to line = %i",g.path,g.line);var e=localStorage["eXide."+f+".data"];e?a.newDocumentWithText(e,localStorage["eXide."+f+".mime"],g):eXide.app.$doOpenDocument(g);b[g.path]=g}d.restoreState();return b},saveState:function(){if(eXide.util.supportsHtml5Storage){localStorage.clear();for(conf in i)localStorage["eXide.preferences."+conf]=i[conf];a.saveState();d.saveState()}},ping:function(){$.ajax({url:"index.html",
type:"HEAD",success:function(){setTimeout(function(){eXide.app.ping()},3E4)},error:function(a,b){$.log("ping failed: %s",b);eXide.app.login=null;$("#user").empty();$("#login").text("Login")}})},$checkLogin:function(){if(eXide.app.login)return!0;eXide.util.error("Warning: you are not logged in.");return!1},requireLogin:function(a){eXide.app.login?a():($("#login-dialog").dialog("option","close",function(){eXide.app.login?a():eXide.util.error("Warning: you are not logged in!")}),$("#login-dialog").dialog("open"))},
initGUI:function(){$("body").layout({enableCursorHotkey:!1,north__size:70,north__resizable:!1,north__closable:!0,north__showOverflowOnHover:!0,south__minSize:200,south__initClosed:!0,west__size:200,west__initClosed:!0,west__contentSelector:".content",center__minSize:300,center__onresize:eXide.app.resize,center__contentSelector:".content"});$(".menu ul li").hover(function(){$("ul",this).css({visibility:"visible",display:"none"}).show(400)},function(){$("ul",this).css({visibility:"hidden"})});$("#open-dialog").dialog({title:"Open File",
modal:!1,autoOpen:!1,height:480,width:700,open:function(){e.init()},resize:function(){e.resize()}});$("#preferences-dialog").dialog({title:"Preferences",modal:!0,autoOpen:!1,height:400,width:600,buttons:{Cancel:function(){$(this).dialog("close");a.focus()},Save:function(){var b=$("form",this);i.theme=$('select[name="theme"]',b).val();i.fontSize=$('select[name="font-size"]',b).val();i.showInvisibles=$('input[name="show-invisibles"]',b).is(":checked");i.showPrintMargin=$('input[name="print-margin"]',
b).is(":checked");b=$('select[name="soft-wrap"]',b).val();b==="free"?b=-1:b==="off"&&(b=0);i.softWrap=parseInt(b);eXide.app.applyPreferences();$(this).dialog("close");a.focus()}}});$("#login-dialog").dialog({title:"Login",modal:!0,autoOpen:!1,buttons:{Login:function(){$.ajax({url:"login",data:$("#login-form").serialize(),success:function(){eXide.app.login=$('#login-form input[name="user"]').val();$.log("Logged in as %s",eXide.app.login);$("#login-dialog").dialog("close");$("#user").text("Logged in as "+
eXide.app.login+". ");$("#login").text("Logout");setTimeout(function(){eXide.app.ping()},3E4);a.focus()},error:function(){$("#login-error").text("Login failed. Bad username or password.");$("#login-dialog input:first").focus()}})},Cancel:function(){$(this).dialog("close");a.focus()}},open:function(){$(this).find("input").val("");$(this).find("input:first").focus();$("#login-error").empty();var a=$(this);a.find("input").keyup(function(b){b.keyCode==13&&a.parent().find(".ui-dialog-buttonpane button:first").trigger("click")})}});
$("#keyboard-help").dialog({title:"Keyboard Shortcuts",modal:!1,autoOpen:!1,height:400,buttons:{Close:function(){$(this).dialog("close")}},open:function(){eXide.edit.commands.help($("#keyboard-help"),a)}});$("#about-dialog").dialog({title:"About",modal:!1,autoOpen:!1,height:300,width:450,buttons:{Close:function(){$(this).dialog("close")}}});var b=$("#open").button({icons:{primary:"ui-icon-folder-open"}});b.click(eXide.app.openDocument);$("#menu-file-open").click(eXide.app.openDocument);b=$("#close").button({icons:{primary:"ui-icon-close"}});
b.click(eXide.app.closeDocument);$("#menu-file-close").click(eXide.app.closeDocument);b=$("#new").button({icons:{primary:"ui-icon-document"}});b.click(eXide.app.newDocument);$("#menu-file-new").click(eXide.app.newDocument);b=$("#run").button({icons:{primary:"ui-icon-play"}});b.click(eXide.app.runQuery);b=$("#validate").button({icons:{primary:"ui-icon-check"}});b.click(eXide.app.checkQuery);b=$("#save").button({icons:{primary:"ui-icon-disk"}});b.click(eXide.app.saveDocument);$("#menu-file-save").click(eXide.app.saveDocument);
$("#menu-file-save-as").click(eXide.app.saveDocumentAs);b=$("#download").button({icons:{primary:"ui-icon-transferthick-e-w"}});b.click(eXide.app.download);$("#menu-file-download").click(eXide.app.download);$("#menu-file-manager").click(eXide.app.manage);$("#menu-deploy-new").click(eXide.app.newDeployment);$("#menu-deploy-edit").click(eXide.app.deploymentSettings);$("#menu-deploy-deploy").click(eXide.app.deploy);$("#menu-deploy-sync").click(eXide.app.synchronize);$("#menu-deploy-download").click(eXide.app.downloadApp);
$("#menu-edit-undo").click(function(b){b.preventDefault();a.editor.undo()});$("#menu-edit-redo").click(function(b){b.preventDefault();a.editor.redo()});$("#menu-edit-toggle-comment").click(function(b){b.preventDefault();a.editor.toggleCommentLines()});$("#menu-edit-preferences").click(eXide.app.preferences);$("#menu-navigate-definition").click(function(a){a.preventDefault();eXide.app.exec("gotoDefinition")});$("#menu-navigate-modules").click(function(b){b.preventDefault();b=a.getActiveDocument();
eXide.find.Modules.select(b.syntax)});$("#menu-deploy-run").click(eXide.app.openApp);$("#menu-help-keyboard").click(function(a){a.preventDefault();$("#keyboard-help").dialog("open")});$("#menu-help-about").click(function(a){a.preventDefault();$("#about-dialog").dialog("open")});$("#syntax").change(function(){a.setMode($(this).val())});a.addEventListener("activate",null,function(a){$("#syntax").val(a.getSyntax())});$("#login").click(function(a){a.preventDefault();eXide.app.login?($.get("logout"),$("#user").empty(),
$("#login").text("Login"),eXide.app.login=null):$("#login-dialog").dialog("open")});$("#results-container .next").click(eXide.app.browseNext);$("#results-container .previous").click(eXide.app.browsePrevious)}}}();eXide.namespace("eXide.edit.Projects");
eXide.edit.Projects=function(){Constr=function(){this.projects={}};Constr.prototype.getProject=function(a,d){var e=this;$.getJSON("modules/deployment.xql",{info:a},function(a){if(a){var c=e.projects[a.abbrev];c?eXide.util.oop.extend(c,a):(c=a,e.projects[a.abbrev]=c);d(c)}else eXide.util.error("Application not found: The document currently opened in the editor should belong to an application package.")})};Constr.prototype.getProjectFor=function(a){for(k in this.projects){var d=this.projects[k];$.log("collection: %s -> root: %s",
a.substring(0,d.root.length),d.root);if(a.substring(0,d.root.length)===d.root)return d}return null};Constr.prototype.saveState=function(){var a=0;for(k in this.projects){var d=this.projects[k];for(n in d)localStorage["eXide.projects."+a+"."+n]=d[n];a++}localStorage["eXide.projects"]=a};Constr.prototype.restoreState=function(){var a=localStorage["eXide.projects"];a||(a=0);this.projects={};for(var d=0;d<a;d++){var e=localStorage["eXide.projects."+d+".abbrev"];this.projects[e]={abbrev:e,root:localStorage["eXide.projects."+
d+".root"],dir:localStorage["eXide.projects."+d+".dir"],autoSync:localStorage["eXide.projects."+d+".autoSync"]}}};return Constr}();eXide.namespace("eXide.edit.PackageEditor");
eXide.edit.PackageEditor=function(){Constr=function(){var a=this;this.projects=new eXide.edit.Projects;this.currentProject=null;this.container=$("#dialog-deploy");this.container.dialog({title:"Deployment Editor",modal:!1,autoOpen:!1,width:520,height:600});this.syncDialog=$("#synchronize-dialog");this.syncDialog.dialog({title:"Synchronize to Directory",modal:!1,autoOpen:!1,width:500,height:400,buttons:{Synchronize:function(){var d=a.syncDialog.find('input[name="dir"]').val();!d||d.length==0?$("#synchronize-report").text("No output directory specified!"):
(a.currentProject.dir=d,d=a.syncDialog.find("form").serialize(),$("#synchronize-report").text("Synchronization in progress ..."),$("#synchronize-report").load("modules/synchronize.xql",d))},Close:function(){$(this).dialog("close")}}});a.syncDialog.find('input[name="auto"]').click(function(){if(a.currentProject)a.currentProject.autoSync=$(this).is(":checked")})};Constr.prototype={open:function(a){var d=this,e=null;a&&(e={collection:a});$.ajax({url:"modules/deployment.xql",type:"POST",data:e,success:function(a){d.container.html(a);
d.container.form({done:function(){var a=d.container.find("form").serialize();$.ajax({url:"modules/deployment.xql",type:"POST",data:a,success:function(){d.container.dialog("close")},error:function(a){eXide.util.error(a.responseText)}})},cancel:function(){d.container.dialog("close")}});d.container.find(".author-repeat").repeat("#author-add-trigger",{deleteTrigger:"#author-remove-trigger"});d.container.dialog("open")},error:function(a){eXide.util.error(a.responseText)}})},deploy:function(a){eXide.util.Dialog.input("Deploy",
'<p>Note: target has to be different from the source package or it will be overwritten!</p><p><label for="target">Target collection:</label><input id="deployment-target" type="text" name="target" value="'+a+'-test"size="30"/></p>',function(){var d=$("#deployment-target").val();d===""&&(d=a);$.ajax({url:"modules/deployment.xql",type:"POST",dataType:"json",data:{collection:a,target:d,deploy:"true"},success:function(a){a=location.protocol+"//"+location.hostname+":"+location.port+"/exist/apps/"+a+"/";
eXide.util.Dialog.message("Application Deployed",'<p>The application has been deployed. On a standard installation the following link should open it:</p><center><a href="'+a+'" target="_new">'+a+"</a></center>")},error:function(a){a.status==404?eXide.util.error("Deployment failed. The document currently opened in the editor should belong to an application package."):eXide.util.Dialog.warning("Deployment Error","<p>An error has been reported by the database:</p><p>"+a.responseText+"</p>")}})})},download:function(a){window.location.href=
"modules/deployment.xql?download=true&collection="+encodeURIComponent(a)},synchronize:function(a){var d=this;d.projects.getProject(a,function(a){a.isAdmin?(d.currentProject=a,d.syncDialog.find(".project-name").text(a.abbrev),d.syncDialog.find('input[name="start"]').val(a.deployed),a.dir&&d.syncDialog.find('input[name="dir"]').val(a.dir),d.syncDialog.find('input[name="collection"]').val(a.root),d.syncDialog.find('input[name="auto"]').val(a.autoSync?"on":"off"),d.syncDialog.dialog("open")):eXide.util.error("You need to be logged in as an admin user with dba role to use this feature.")})},
autoSync:function(a){(a=this.projects.getProjectFor(a))&&a.autoSync&&$.ajax({url:"modules/synchronize.xql",type:"GET",data:{collection:a.root,start:a.deployed,dir:a.dir},success:function(){eXide.util.message("Synchronized directory")}})},runApp:function(a){this.projects.getProject(a,function(a){var e="/exist/apps/"+a.root.replace(/^\/db\//,"")+"/";eXide.util.Dialog.message("Run Application "+a.abbrev,'<p>Click on the following link to open your application:</p><center><a href="'+e+'" target="_new">'+
e+"</a></center>")})},saveState:function(){this.projects.saveState()},restoreState:function(){this.projects.restoreState()}};return Constr}();eXide.namespace("eXide.edit.Template");
eXide.edit.Template=function(){var a=/\n/;Constr=function(d,e,g,c){var b=g.split(a).length;this.code=g;this.editor=d.editor;this.range=e;this.type=c;this.startLine=e.start.row;this.endLine=this.startLine+b-1;$.log("startLine = %i, endLine = %i",this.startLine,this.endLine);this.currentLine=this.startLine;this.lineOffset=this.startColumn=e.start.column;this.regex=/\$[\w\-:_]+/g;if(this.startColumn>0)this.regex.lastIndex=this.startColumn};Constr.prototype={insert:function(){this.editor.getSession().remove(this.range);this.editor.insert(this.code);
var a=this.editor.getSelection().getSelectionLead();this.code.substring(0,1)!="$"&&a.column>0&&this.editor.navigateLeft();this.type!="variable"&&this.nextParam();this.editor.focus()},nextParam:function(){var a=this.editor.getSession(),e=this.editor.getSelection(),g=e.getSelectionLead();$.log("lead.row = %i startLine = %i",g.row,this.startLine);if(g.row<this.startLine||g.row>this.endLine)return!1;for(var c=g=!1;this.currentLine<=this.endLine;){var b=a.getDisplayLine(this.currentLine);$.log("Checking line %s",
b);if(b=this.regex.exec(b)){$.log("Matched %s",b[0]);e.setSelectionAnchor(this.currentLine,b.index);e.selectTo(this.currentLine,b.index+b[0].length);this.lineOffset=b.index;c=!0;break}else this.lineOffset=0,this.currentLine++;if(this.currentLine>this.endLine&&!g){$.log("loop %i",this.startColumn);this.currentLine=this.startLine;if(this.startColumn>0)this.lineOffset=this.startColumn,this.regex.lastIndex=this.lineOffset;g=!0}}return c}};return Constr}();eXide.namespace("eXide.browse.CollectionBrowser");
eXide.browse.CollectionBrowser=function(){Constr=function(a){var d=this;this.events={activate:[]};this.selected=null;var e=document.createElement("div");e.className="eXide-browse-collections eXide-browse-content";a.append(e);this.container=$(e);this.container.dynatree({persist:!1,rootVisible:!1,initAjax:{url:"modules/collections.xql"},clickFolderMode:1,autoFocus:!1,keyboard:!1,onActivate:function(a){var c=a.data.key;$.log("activate %s: is writable: %s",c,a.data.writable);d.selected=c;d.$triggerEvent("activate",
[c,a.data.writable])},onPostInit:function(){var a=null;d.selected&&(a=this.getNodeByKey(d.selected));a==null&&(a=this.getNodeByKey("/db"));a.activate();a.expand(!0)}})};Constr.prototype={getSelection:function(){return this.selected},getSelected:function(){return{isCollection:!1,name:this.selected}},reload:function(){$.log("Reloading tree...");this.container.dynatree("getTree").reload()},createCollection:function(){var a=this;eXide.app.$checkLogin()&&eXide.util.Dialog.input("Create Collection",'<label for="collection">Name: </label><input type="text" name="collection" id="eXide-browse-collection-name"/>',
function(){$.getJSON("modules/collections.xql",{create:$("#eXide-browse-collection-name").val(),collection:a.selected},function(d){d.status=="fail"?eXide.util.Dialog.warning("Create Collection Error",d.message):a.reload()})})},deleteCollection:function(){var a=this;eXide.util.Dialog.input("Confirm Deletion","Are you sure you want to delete collection "+a.selected+"?",function(){$.getJSON("modules/collections.xql",{remove:a.selected},function(d){d.status=="fail"?eXide.util.Dialog.warning("Delete Collection Error",
d.message):a.reload()})})},addEventListener:function(a,d,e){(a=this.events[a])&&a.push({obj:d,callback:e})},$triggerEvent:function(a,d){var e=this.events[a];if(e)for(var g=0;g<e.length;g++)e[g].callback.apply(e[g].obj,d)}};return Constr}();eXide.namespace("eXide.browse.ResourceBrowser");
eXide.browse.ResourceBrowser=function(){var a=[{id:"name",name:"Name",field:"name",width:120,formatter:function(a,c,b,f,d){return d.isCollection?'<span class="collection"><img src="resources/images/folder_add.png"/> '+b+"</span>":b}},{id:"permissions",name:"Permissions",field:"permissions",width:80},{id:"owner",name:"Owner",field:"owner",width:70},{id:"group",name:"Group",field:"group",width:70},{id:"lastMod",name:"Last Modified",field:"last-modified",width:115}],d={editable:!1,multiSelect:!1},e=
{editable:!1,multiSelect:!0};Constr=function(d){var c=this;this.container=$(d);this.clipboard=[];this.clipboardMode="copy";this.events={activate:[],activateCollection:[],activateParent:[]};this.mode="save";this.collection=null;this.data=[];this.grid=new Slick.Grid(this.container,this.data,a,e);var b=new Slick.RowSelectionModel({selectActiveRow:!0});this.grid.setSelectionModel(b);b.onSelectedRangesChanged.subscribe(function(){var a=b.getSelectedRows();if(c.data.length!=0){for(var d=!0,g=0;g<a.length;g++)if(c.data.length>
a[g]&&!c.data[a[g]].writable){d=!1;break}c.$triggerEvent("activate",[a.length==1&&!c.data[a[0]].isCollection?c.data[a[0]]:null,d])}});this.grid.onDblClick.subscribe(function(a){a=c.grid.getCellFromEvent(a);c.data[a.row].isCollection&&c.$triggerEvent("activateCollection",[c.collection+"/"+c.data[a.row].name])});this.grid.onKeyDown.subscribe(function(a){if(!a.shiftKey&&!a.altKey&&!a.ctrlKey)if(a.which==13)a.stopPropagation(),a.preventDefault(),a=b.getSelectedRows(),a.length==1&&(c.data[a[0]].isCollection?
c.$triggerEvent("activateCollection",[c.collection+"/"+c.data[a[0]].name]):eXide.app.openSelectedDocument());else if(a.which==8){var d=c.collection.lastIndexOf("/");d>0&&(a.stopPropagation(),a.preventDefault(),c.collection!="/db"&&(a=c.collection.substring(0,d),c.$triggerEvent("activateCollection",[a])))}});this.grid.onViewportChanged.subscribe(function(){var a=c.grid.getViewport();c.load(a.top,a.bottom)})};Constr.prototype={setMode:function(a){this.mode=a;a=="manage"?this.grid.setOptions(e):this.grid.setOptions(d)},
resize:function(){this.grid.resizeCanvas();this.container.find(".grid-canvas").focus()},update:function(a){$.log("Opening collection %s",a);this.collection=a;this.grid.invalidate();this.data.length=0;this.grid.getSelectionModel().setSelectedRanges([]);this.grid.onViewportChanged.notify()},load:function(a,c){var b=this;$.getJSON("modules/collections.xql",{root:this.collection,view:"r",start:a,end:c},function(d){for(var e=a;e<=c;e++)b.grid.invalidateRow(e);if(d&&d.items){b.data.length=d.total;for(e=
0;e<d.items.length;e++)b.data[a+e]=d.items[e]}else b.data.length=0;b.grid.updateRowCount();b.grid.render();a==0&&(b.grid.setActiveCell(0,0),b.grid.setSelectedRows([0]),b.container.find(".grid-canvas").focus())})},hasSelection:function(){var a=this.grid.getSelectionModel().getSelectedRows();return a&&a.length>0},getSelected:function(){var a=this.grid.getSelectionModel().getSelectedRows();if(a.length==0)return null;for(var c=[],b=0;b<a.length;b++)c.push(this.collection+"/"+this.data[a[b]].name);return c},
deleteResource:function(){var a=this.grid.getSelectionModel().getSelectedRows();if(a.length!=0){for(var c=[],b=0;b<a.length;b++)c.push(this.data[a[b]].name);var d=this;eXide.util.Dialog.input("Confirm Deletion","Are you sure you want to delete the selected resources?",function(){$.log("Deleting resources %o",c);$.getJSON("modules/collections.xql",{remove:c,root:d.collection},function(a){$.log(a.status);a.status=="fail"?eXide.util.Dialog.warning("Delete Resource Error",a.message):d.reload()})})}},
cut:function(){this.clipboardMode="move";this.copy()},copy:function(){var a=this.grid.getSelectionModel().getSelectedRows();this.clipboard=[];for(var c=0;c<a.length;c++){var b=this.data[a[c]].name;b.substr(0,1)!="/"&&(b=this.collection+"/"+b);this.clipboard.push(b)}$.log("Clipboard: %o",this.clipboard)},paste:function(){var a=this;$.log("Copying resources %o to %s",this.clipboard,this.collection);var c={root:this.collection};c[this.clipboardMode]=this.clipboard;$.getJSON("modules/collections.xql",
c,function(b){$.log(b.status);b.status=="fail"?eXide.util.Dialog.warning("Delete Resource Error",b.message):a.reload()})},reload:function(){this.update(this.collection)},addEventListener:function(a,c,b){(a=this.events[a])&&a.push({obj:c,callback:b})},$triggerEvent:function(a,c){var b=this.events[a];if(b)for(var d=0;d<b.length;d++)b[d].callback.apply(b[d].obj,c)}};return Constr}();eXide.namespace("eXide.browse.Upload");
eXide.browse.Upload=function(){Constr=function(a){this.container=a;this.events={done:[]};$("#file_upload").fileUploadUI({sequentialUploads:!0,uploadTable:$("#files"),buildUploadRow:function(a,d){return $("<tr><td>"+a[d].name+'</td><td class="file_upload_progress"><div></div></td><td class="file_upload_cancel"><button class="ui-state-default ui-corner-all" title="Cancel"><span class="ui-icon ui-icon-cancel">Cancel</span></button></td></tr>')},buildDownloadRow:function(a){return a.error?$("<tr><td>"+
a.name+"</td><td>"+a.error+"</td></tr>"):null}});var d=this;$("#eXide-browse-upload-done").button().click(function(){$("#files").empty();d.$triggerEvent("done",[])})};Constr.prototype={update:function(a){$('input[name="collection"]',this.container).val(a)},addEventListener:function(a,d,e){(a=this.events[a])&&a.push({obj:d,callback:e})},$triggerEvent:function(a,d){var e=this.events[a];if(e)for(var g=0;g<e.length;g++)e[g].callback.apply(e[g].obj,d)}};return Constr}();eXide.namespace("eXide.browse.Browser");
eXide.browse.Browser=function(){function a(a,e,g,c,b){var f=document.createElement("button");f.title=e;f.id="eXide-browse-toolbar-"+g;f.tabindex=c;e=document.createElement("img");e.src="resources/images/"+b;f.appendChild(e);a.append(f);return f}Constr=function(d){var e=this,g=$(".eXide-browse-toolbar",d),c=a(g,"Reload","reload",1,"arrow_refresh.png");$(c).click(function(){e.collections.reload()});this.btnCreateCollection=a(g,"Create Collection","create",3,"folder_add.png");$(this.btnCreateCollection).click(function(a){a.preventDefault();
e.collections.createCollection()});this.btnUpload=a(g,"Upload Files","upload",4,"database_add.png");$(this.btnUpload).click(function(a){a.preventDefault();$(".eXide-browse-resources",d).hide();$(".eXide-browse-upload",d).show()});this.btnDeleteResource=a(g,"Delete","delete-resource",5,"bin.png");$(this.btnDeleteResource).click(function(a){a.preventDefault();e.resources.deleteResource()});c=a(g,"Open Selected","open",6,"page_edit.png");$(c).click(function(a){a.preventDefault();eXide.app.openSelectedDocument(!1)});
c=a(g,"Copy","copy",7,"page_copy.png");c=a(g,"Cut","cut",8,"cut.png");c=a(g,"Paste","paste",9,"page_paste.png");this.selection=$(".eXide-browse-form input",d);this.container=d;this.resources=new eXide.browse.ResourceBrowser($(".eXide-browse-resources",d));this.collections=new eXide.browse.CollectionBrowser($(".eXide-browse-collections",d));this.upload=new eXide.browse.Upload($(".eXide-browse-upload",d).hide());this.layout=null;this.collections.addEventListener("activate",this,this.onActivateCollection);
this.collections.addEventListener("activate",this.resources,this.resources.update);this.collections.addEventListener("activate",this.upload,this.upload.update);this.resources.addEventListener("activate",this,this.onActivateResource);this.resources.addEventListener("activateCollection",this,this.onChangeCollection);this.upload.addEventListener("done",this,function(){$(".eXide-browse-resources",d).show();$(".eXide-browse-upload",d).hide();this.reload()});$("#eXide-browse-toolbar-copy").click(function(a){a.preventDefault();
e.resources.copy()});$("#eXide-browse-toolbar-cut").click(function(a){a.preventDefault();e.resources.cut()});$("#eXide-browse-toolbar-paste").click(function(a){a.preventDefault();e.resources.paste()})};Constr.prototype={init:function(){var a=$(this.container).innerHeight()-$(".eXide-browse-form",this.container).height()-25;$(".eXide-browse-panel",this.container).height(a);if(this.layout==null)this.layout=$(".eXide-browse-panel",this.container).layout({enableCursorHotkey:!1,north__resizable:!1,north__closable:!1,
north__spacing_open:0,south__resizable:!1,west__size:200,west__initClosed:!1,west__contentSelector:".eXide-browse-content",center__minSize:300,center__contentSelector:".eXide-browse-content",onresize:function(){this.resources.resize()}}),this.resources.resize()},reload:function(a,e){if(a){$(".eXide-browse-toolbar button",this.container).hide();for(var g=0;g<a.length;g++)$("#eXide-browse-toolbar-"+a[g]).show()}this.resources.setMode(e);e==="open"||e==="save"?$(".eXide-browse-form",this.container).show():
$(".eXide-browse-form",this.container).hide();this.layout!=null&&(this.resize(),this.collections.reload(),this.resources.update(this.collections.getSelection()),$(this.selection).val(""))},resize:function(){var a=$(this.container).innerHeight()-$(".eXide-browse-form",this.container).height()-25;$(".eXide-browse-panel",this.container).height(a);this.layout.resizeAll()},deleteSelected:function(){var a=this.resources.getSelected();a==null&&(a=this.collections.getSelected());for(var e=0;e<a.length;e++)$.log("Selected: %o",
a[e]);var g=this;eXide.util.Dialog.input("Confirm Deletion","Are you sure you want to delete the selected resources?",function(){$.log("Deleting resources %o",a);$.getJSON("modules/collections.xql",{remove:a},function(a){$.log(a.status);a.status=="fail"?eXide.util.Dialog.warning("Delete Error",a.message):g.reload()})})},getSelection:function(){var a=$(this.selection).val();return a==null||a==""?null:{name:a,path:this.collections.getSelection()+"/"+a,writable:!0}},onActivateResource:function(a,e){a?
$(this.selection).val(a.name):$(this.selection).val("");e?$(this.btnDeleteResource).css("display",""):$(this.btnDeleteResource).css("display","none")},onActivateCollection:function(a,e){e?($(this.btnCreateCollection).css("display",""),$(this.btnUpload).css("display",""),$(this.btnDeleteResource).css("display","")):($(this.btnCreateCollection).css("display","none"),$(this.btnUpload).css("display","none"),$(this.btnDeleteResource).css("display","none"));this.resources.update(a,e);this.upload.update(a,
e)},onChangeCollection:function(a){this.collections.selected=a;this.collections.reload();this.resources.update(this.collections.getSelection())}};return Constr}();eXide.namespace("eXide.find.IncrementalSearch");
eXide.find.IncrementalSearch=function(){Constr=function(a,d){var e=this;e.input=$(a);e.input.hide();e.input.keyup(function(a){switch(a.which){case 27:case 13:e.input.hide();e.editor.focus();break;case 40:a.preventDefault();e.editor.findNext();break;case 38:a.preventDefault();e.editor.findPrevious();break;default:e.onChange()}});e.editor=d};Constr.prototype.start=function(){this.currentLine=this.editor.getSession().getSelection().getSelectionLead().row;this.input.val("");this.input.show().focus()};
Constr.prototype.onChange=function(){this.editor.gotoLine(this.currentLine);this.editor.find(this.input.val())};return Constr}();eXide.namespace("eXide.find.Modules");
eXide.find.Modules=function(){var a={open:[],"import":[]},d=[{id:"prefix",name:"Prefix",field:"prefix",minWidth:100,sortable:!0,resizable:!0},{id:"uri",name:"URI",field:"uri",minWidth:240,sortable:!0,resizable:!0},{id:"at",name:"Location",field:"at",minWidth:200,sortable:!0,resizable:!0}],e={editable:!1,multiSelect:!1},g=[],c;$(document).ready(function(){c=new Slick.Grid("#module-list",g,d,e);var a=new Slick.RowSelectionModel({selectActiveRow:!0});c.setSelectionModel(a);c.onDblClick.subscribe(function(a){a=
c.getCellFromEvent(a);eXide.find.Modules.$triggerEvent("open",[g[a.row]])});$("#select-module-dialog").dialog({modal:!1,autoOpen:!1,height:400,width:600,open:eXide.find.Modules.$init})});return{select:function(a){var c={Open:function(){eXide.find.Modules.trigger("open");$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}};a=="xquery"&&(c.Import=function(){eXide.find.Modules.trigger("import");$(this).dialog("close")});$("#select-module-dialog").dialog("option","buttons",c);$("#select-module-dialog").dialog("open")},
trigger:function(a){var d=c.getSelectionModel().getSelectedRows();d.length==1&&eXide.find.Modules.$triggerEvent(a,[g[d[0]]])},$init:function(){c.resizeCanvas();c.invalidate();g.length=0;$.getJSON("modules/find.xql",function(a){g.length=a.length;for(var d=0;d<a.length;d++)g[d]=a[d];c.updateRowCount();c.render();c.setActiveCell(0,0);c.setSelectedRows([0]);$("#module-list").find(".grid-canvas").focus()})},addEventListener:function(b,c,d){(b=a[b])&&b.push({obj:c,callback:d})},$triggerEvent:function(b,
c){var d=a[b];if(d)for(var g=0;g<d.length;g++)d[g].callback.apply(d[g].obj,c)}}}();(function(a){a.fn.drag=function(c,b,d){var g=typeof c=="string"?c:"",e=a.isFunction(c)?c:a.isFunction(b)?b:null;g.indexOf("drag")!==0&&(g="drag"+g);d=(c==e?b:d)||{};return e?this.bind(g,d,e):this.trigger(g)};var d=a.event,e=d.special,g=e.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",livekey:"livedrag",add:function(c){var b=a.data(this,g.datakey),f=c.data||{};b.related+=1;if(!b.live&&c.selector)b.live=!0,d.add(this,"draginit."+g.livekey,
g.delegate);a.each(g.defaults,function(a){f[a]!==void 0&&(b[a]=f[a])})},remove:function(){a.data(this,g.datakey).related-=1},setup:function(){if(!a.data(this,g.datakey)){var c=a.extend({related:0},g.defaults);a.data(this,g.datakey,c);d.add(this,"mousedown",g.init,c);this.attachEvent&&this.attachEvent("ondragstart",g.dontstart)}},teardown:function(){a.data(this,g.datakey).related||(a.removeData(this,g.datakey),d.remove(this,"mousedown",g.init),d.remove(this,"draginit",g.delegate),g.textselect(!0),
this.detachEvent&&this.detachEvent("ondragstart",g.dontstart))},init:function(c){var b=c.data,f;if(!(b.which>0&&c.which!=b.which)&&!a(c.target).is(b.not)&&(!b.handle||a(c.target).closest(b.handle,c.currentTarget).length))if(b.propagates=1,b.interactions=[g.interaction(this,b)],b.target=c.target,b.pageX=c.pageX,b.pageY=c.pageY,b.dragging=null,f=g.hijack(c,"draginit",b),b.propagates){if((f=g.flatten(f))&&f.length)b.interactions=[],a.each(f,function(){b.interactions.push(g.interaction(this,b))});b.propagates=
b.interactions.length;b.drop!==!1&&e.drop&&e.drop.handler(c,b);g.textselect(!1);d.add(document,"mousemove mouseup",g.handler,b);return!1}},interaction:function(c,b){return{drag:c,callback:new g.callback,droppable:[],offset:a(c)[b.relative?"position":"offset"]()||{top:0,left:0}}},handler:function(a){var b=a.data;switch(a.type){case !b.dragging&&"mousemove":if(Math.pow(a.pageX-b.pageX,2)+Math.pow(a.pageY-b.pageY,2)<Math.pow(b.distance,2))break;a.target=b.target;g.hijack(a,"dragstart",b);if(b.propagates)b.dragging=
!0;case "mousemove":if(b.dragging){g.hijack(a,"drag",b);if(b.propagates){b.drop!==!1&&e.drop&&e.drop.handler(a,b);break}a.type="mouseup"}case "mouseup":if(d.remove(document,"mousemove mouseup",g.handler),b.dragging&&(b.drop!==!1&&e.drop&&e.drop.handler(a,b),g.hijack(a,"dragend",b)),g.textselect(!0),b.click===!1&&b.dragging)jQuery.event.triggered=!0,setTimeout(function(){jQuery.event.triggered=!1},20),b.dragging=!1}},delegate:function(c){var b=[],f,e=a.data(this,"events")||{};a.each(e.live||[],function(e,
h){if(h.preType.indexOf("drag")===0&&(f=a(c.target).closest(h.selector,c.currentTarget)[0]))d.add(f,h.origType+"."+g.livekey,h.origHandler,h.data),a.inArray(f,b)<0&&b.push(f)});return!b.length?!1:a(b).bind("dragend."+g.livekey,function(){d.remove(this,"."+g.livekey)})},hijack:function(c,b,f,e,r){if(f){var h={event:c.originalEvent,type:c.type},t=b.indexOf("drop")?"drag":"drop",q,G=e||0,A,aa,e=!isNaN(e)?e:f.interactions.length;c.type=b;c.originalEvent=null;f.results=[];do if((A=f.interactions[G])&&
!(b!=="dragend"&&A.cancelled)){aa=g.properties(c,f,A);A.results=[];a(r||A[t]||f.droppable).each(function(e,h){q=(aa.target=h)?d.handle.call(h,c,aa):null;if(q===!1){if(t=="drag")A.cancelled=!0,f.propagates-=1;b=="drop"&&(A[t][e]=null)}else b=="dropinit"&&A.droppable.push(g.element(q)||h);if(b=="dragstart")A.proxy=a(g.element(q)||A.drag)[0];A.results.push(q);delete c.result;if(b!=="dropinit")return q});f.results[G]=g.flatten(A.results);if(b=="dropinit")A.droppable=g.flatten(A.droppable);b=="dragstart"&&
!A.cancelled&&aa.update()}while(++G<e);c.type=h.type;c.originalEvent=h.event;return g.flatten(f.results)}},properties:function(a,b,d){var e=d.callback;e.drag=d.drag;e.proxy=d.proxy||d.drag;e.startX=b.pageX;e.startY=b.pageY;e.deltaX=a.pageX-b.pageX;e.deltaY=a.pageY-b.pageY;e.originalX=d.offset.left;e.originalY=d.offset.top;e.offsetX=a.pageX-(b.pageX-e.originalX);e.offsetY=a.pageY-(b.pageY-e.originalY);e.drop=g.flatten((d.drop||[]).slice());e.available=g.flatten((d.droppable||[]).slice());return e},
element:function(a){if(a&&(a.jquery||a.nodeType==1))return a},flatten:function(c){return a.map(c,function(b){return b&&b.jquery?a.makeArray(b):b&&b.length?g.flatten(b):b})},textselect:function(c){a(document)[c?"unbind":"bind"]("selectstart",g.dontstart).attr("unselectable",c?"off":"on").css("MozUserSelect",c?"":"none")},dontstart:function(){return!1},callback:function(){}};g.callback.prototype={update:function(){e.drop&&this.available.length&&a.each(this.available,function(a){e.drop.locate(this,a)})}};
e.draginit=e.dragstart=e.dragend=g})(jQuery);/*
 jquery.layout 1.3.0 - Release Candidate 29.15
 $Date: 2011-06-25 08:00:00 (Sat, 25 Jun 2011) $
 $Rev: 302915 $

 Copyright (c) 2010 
 Fabrizio Balliano (http://www.fabrizioballiano.net)
 Kevin Dalman (http://allpro.net)

 Dual licensed under the GPL (http://www.gnu.org/licenses/gpl.html)
 and MIT (http://www.opensource.org/licenses/mit-license.php) licenses.

 Changelog: http://layout.jquery-dev.net/changelog.cfm#1.3.0.rc29.15

 Docs: http://layout.jquery-dev.net/documentation.html
 Tips: http://layout.jquery-dev.net/tips.html
 Help: http://groups.google.com/group/jquery-ui-layout
*/
(function(a){a.layout={version:"1.3.rc29.15",revision:0.032915,language:{Open:"Open",Close:"Close",Resize:"Resize",Slide:"Slide Open",Pin:"Pin",Unpin:"Un-Pin",noRoomToOpenTip:"Not enough room to show this pane.",pane:"pane",selector:"selector",errButton:"Error Adding Button \n\nInvalid ",errContainerMissing:"UI Layout Initialization Error\n\nThe specified layout-container does not exist.",errCenterPaneMissing:"UI Layout Initialization Error\n\nThe center-pane element does not exist.\n\nThe center-pane is a required element.",
errContainerHeight:"UI Layout Initialization Warning\n\nThe layout-container \"CONTAINER\" has no height.\n\nTherefore the layout is 0-height and hence 'invisible'!"},browser:{mozilla:!!a.browser.mozilla,webkit:!!a.browser.webkit||!!a.browser.safari,msie:!!a.browser.msie,isIE6:!!a.browser.msie&&a.browser.version==6,boxModel:!1},scrollbarWidth:function(){return window.scrollbarWidth||a.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||a.layout.getScrollbarSize("height")},
getScrollbarSize:function(d){var e=a('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),g={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};e.remove();window.scrollbarWidth=g.width;window.scrollbarHeight=g.height;return d.match(/^(width|height)$/i)?g[d]:g},showInvisibly:function(d,e){if(!d)return{};d.jquery||(d=a(d));var g={display:d.css("display"),visibility:d.css("visibility")};return e||
g.display=="none"?(d.css({display:"block",visibility:"hidden"}),g):{}},getElementDimensions:function(d){var e={},g=e.css={},c={},b,f,i=a.layout.cssNum,r=d.offset();e.offsetLeft=r.left;e.offsetTop=r.top;a.each("Left,Right,Top,Bottom".split(","),function(h,i){b=g["border"+i]=a.layout.borderWidth(d,i);f=g["padding"+i]=a.layout.cssNum(d,"padding"+i);c[i]=b+f;e["inset"+i]=f});e.offsetWidth=d.innerWidth();e.offsetHeight=d.innerHeight();e.outerWidth=d.outerWidth();e.outerHeight=d.outerHeight();e.innerWidth=
Math.max(0,e.outerWidth-c.Left-c.Right);e.innerHeight=Math.max(0,e.outerHeight-c.Top-c.Bottom);g.width=d.width();g.height=d.height();g.top=i(d,"top",!0);g.bottom=i(d,"bottom",!0);g.left=i(d,"left",!0);g.right=i(d,"right",!0);return e},getElementCSS:function(a,e){var g={},c=a[0].style,b=e.split(","),f="Top,Bottom,Left,Right".split(","),i="Color,Style,Width".split(","),r,h,t,q,G,A;for(q=0;q<b.length;q++)if(r=b[q],r.match(/(border|padding|margin)$/))for(G=0;G<4;G++)if(h=f[G],r=="border")for(A=0;A<3;A++)t=
i[A],g[r+h+t]=c[r+h+t];else g[r+h]=c[r+h];else g[r]=c[r];return g},cssWidth:function(d,e){var g=a.layout.borderWidth,c=a.layout.cssNum;if(e<=0)return 0;if(!a.layout.browser.boxModel)return e;g=e-g(d,"Left")-g(d,"Right")-c(d,"paddingLeft")-c(d,"paddingRight");return Math.max(0,g)},cssHeight:function(d,e){var g=a.layout.borderWidth,c=a.layout.cssNum;if(e<=0)return 0;if(!a.layout.browser.boxModel)return e;g=e-g(d,"Top")-g(d,"Bottom")-c(d,"paddingTop")-c(d,"paddingBottom");return Math.max(0,g)},cssNum:function(d,
e,g){d.jquery||(d=a(d));var c=a.layout.showInvisibly(d),e=a.curCSS(d[0],e,!0),g=g&&e=="auto"?e:parseInt(e,10)||0;d.css(c);return g},borderWidth:function(d,e){d.jquery&&(d=d[0]);var g="border"+e.substr(0,1).toUpperCase()+e.substr(1);return a.curCSS(d,g+"Style",!0)=="none"?0:parseInt(a.curCSS(d,g+"Width",!0),10)||0},isMouseOverElem:function(d,e){var g=a(e||this),c=g.offset(),b=c.top,c=c.left,f=c+g.outerWidth(),g=b+g.outerHeight(),i=d.pageX,r=d.pageY;return a.layout.browser.msie&&i<0&&r<0||i>=c&&i<=
f&&r>=b&&r<=g}};a.fn.layout=function(d){function e(b){if(!b)return!0;var c=b.keyCode;if(c<33)return!0;var d={38:"north",40:"south",37:"west",39:"east"},f=b.shiftKey,e=b.ctrlKey,g,w,R,l;e&&c>=37&&c<=40&&j[d[c]].enableCursorHotkey?l=d[c]:(e||f)&&a.each(o.borderPanes.split(","),function(a,b){g=j[b];w=g.customHotkey;R=g.customHotkeyModifier;if(f&&R=="SHIFT"||e&&R=="CTRL"||e&&f)if(w&&c==(isNaN(w)||w<=9?w.toUpperCase().charCodeAt(0):w))return l=b,!1});if(!l||!u[l]||!j[l].closable||p[l].isHidden)return!0;
Ua(l);b.stopPropagation();return b.returnValue=!1}function g(b){if(E()){this&&this.tagName&&(b=this);var d;T(b)?d=u[b]:a(b).data("layoutRole")?d=a(b):a(b).parents().each(function(){if(a(this).data("layoutRole"))return d=a(this),!1});if(d&&d.length){var f=d.data("layoutEdge"),b=p[f];b.cssSaved&&c(f);if(b.isSliding||b.isResizing||b.isClosed)b.cssSaved=!1;else{var e={zIndex:o.zIndex.pane_normal+2},g={},l=d.css("overflow"),w=d.css("overflowX"),R=d.css("overflowY");if(l!="visible")g.overflow=l,e.overflow=
"visible";if(w&&!w.match(/visible|auto/))g.overflowX=w,e.overflowX="visible";if(R&&!R.match(/visible|auto/))g.overflowY=w,e.overflowY="visible";b.cssSaved=g;d.css(e);a.each(o.allPanes.split(","),function(a,b){b!=f&&c(b)})}}}}function c(b){if(E()){this&&this.tagName&&(b=this);var c;T(b)?c=u[b]:a(b).data("layoutRole")?c=a(b):a(b).parents().each(function(){if(a(this).data("layoutRole"))return c=a(this),!1});if(c&&c.length){var b=c.data("layoutEdge"),b=p[b],d=b.cssSaved||{};!b.isSliding&&!b.isResizing&&
c.css("zIndex",o.zIndex.pane_normal);c.css(d);b.cssSaved=!1}}}function b(b,c,d){var f=a(b),e=j.showErrorMessages;if(f.length){if(o.borderPanes.indexOf(c)==-1)if(e)alert(K.errButton+K.pane+": "+c);else return b=j[c].buttonClass+"-"+d,f.addClass(b+" "+b+"-"+c).data("layoutName",j.name),f}else e&&alert(K.errButton+K.selector+": "+b);return null}function f(a,b,c){switch(b.toLowerCase()){case "toggle":i(a,c);break;case "open":r(a,c);break;case "close":h(a,c);break;case "pin":t(a,c);break;case "toggle-slide":i(a,
c,!0);break;case "open-slide":r(a,c,!0)}}function i(a,c,d){(a=b(a,c,"toggle"))&&a.click(function(a){Ua(c,!!d);a.stopPropagation()})}function r(a,c,d){(a=b(a,c,"open"))&&a.attr("title",K.Open).click(function(a){na(c,!!d);a.stopPropagation()})}function h(a,c){var d=b(a,c,"close");d&&d.attr("title",K.Close).click(function(a){oa(c);a.stopPropagation()})}function t(c,d){var f=b(c,d,"pin");if(f){var e=p[d];f.click(function(b){G(a(this),d,e.isSliding||e.isClosed);e.isSliding||e.isClosed?na(d):oa(d);b.stopPropagation()});
G(f,d,!e.isClosed&&!e.isSliding);o[d].pins.push(c)}}function q(b,c){a.each(o[b].pins,function(d,f){G(a(f),b,c)})}function G(a,b,c){var d=a.attr("pin");if(!(d&&c==(d=="down"))){var d=j[b].buttonClass+"-pin",f=d+"-"+b,b=d+"-up "+f+"-up",d=d+"-down "+f+"-down";a.attr("pin",c?"down":"up").attr("title",c?K.Unpin:K.Pin).removeClass(c?b:d).addClass(c?d:b)}}function A(b){for(var b=a.extend({},j.cookie,b||{}).name||j.name||"Layout",c=document.cookie,c=c?c.split(";"):[],d,f=0,e=c.length;f<e;f++)if(d=a.trim(c[f]).split("="),
d[0]==b)return Va(decodeURIComponent(d[1]));return""}function aa(b,c){var d=a.extend({},j.cookie,c||{}),f=d.name||j.name||"Layout",e="",g="",w=!1;d.expires.toUTCString?g=d.expires:typeof d.expires=="number"&&(g=new Date,d.expires>0?g.setDate(g.getDate()+d.expires):(g.setYear(1970),w=!0));g&&(e+=";expires="+g.toUTCString());d.path&&(e+=";path="+d.path);d.domain&&(e+=";domain="+d.domain);d.secure&&(e+=";secure");w?(p.cookie={},document.cookie=f+"="+e):(p.cookie=Ba(b||d.keys),document.cookie=f+"="+encodeURIComponent(ab(p.cookie))+
e);return a.extend({},p.cookie)}function x(b){if(b=A(b))p.cookie=a.extend({},b),ra(b);return b}function ra(b,c){b=Ia(b);a.extend(!0,j,b);if(p.initialized){var d,f,e,g,w=!c;a.each(o.allPanes.split(","),function(a,c){d=b[c];if(typeof d=="object")f=d.size,g=d.initClosed,e=d.initHidden,(f>0||f=="auto")&&Ca(c,f),e===!0?ib(c,w):g===!1?na(c,!1,w):g===!0?oa(c,!1,w):e===!1&&bb(c,!1,w)})}}function Ba(b){var c={},d={isClosed:"initClosed",isHidden:"initHidden"},f,e,g;if(!b)b=j.cookie.keys;a.isArray(b)&&(b=b.join(","));
for(var b=b.replace(/__/g,".").split(","),w=0,R=b.length;w<R;w++)f=b[w].split("."),e=f[0],f=f[1],o.allPanes.indexOf(e)<0||(g=p[e][f],g!=void 0&&(f=="isClosed"&&p[e].isSliding&&(g=!0),(c[e]||(c[e]={}))[d[f]?d[f]:f]=g));return c}function ab(a){function b(a){var c=[],d=0,O,f,e;for(O in a)f=a[O],e=typeof f,e=="string"?f='"'+f+'"':e=="object"&&(f=b(f)),c[d++]='"'+O+'":'+f;return"{"+c.join(",")+"}"}return b(a)}function Va(a){try{return window.eval("("+a+")")||{}}catch(b){return{}}}var K=a.layout.language,
j={name:"",containerClass:"ui-layout-container",scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,autoBindCustomButtons:!1,zIndex:null,initPanes:!0,showErrorMessages:!0,defaults:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",
findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:K.Close,togglerTip_closed:K.Open,togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskIframesOnResize:!0,resizeNestedLayout:!0,
resizeWhileDragging:!1,resizeContentWhileDragging:!1,noRoomToOpenTip:K.noRoomToOpenTip,resizerTip:K.Resize,sliderTip:K.Slide,sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:a.layout.browser.webkit,preventPrematureSlideClose:!1,showOverflowOnHover:!1,enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,triggerEventsOnLoad:!1,
triggerEventsWhileDragging:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},
east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0},useStateCookie:!1,cookie:{name:"",autoSave:!0,autoLoad:!0,domain:"",path:"",expires:"",secure:!1,keys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden"}},
M={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},p={id:"layout"+(new Date).getTime(),initialized:!1,container:{},north:{},south:{},east:{},west:{},center:{},cookie:{}},o={allPanes:"north,south,west,east,center",borderPanes:"north,south,west,east",altSide:{north:"south",
south:"north",east:"west",west:"east"},hidden:{visibility:"hidden"},visible:{visibility:"visible"},zIndex:{pane_normal:1,resizer_normal:2,iframe_mask:2,pane_sliding:100,pane_animate:1E3,resizer_drag:1E4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},
cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"Top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"},pins:[]},south:{side:"Bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"},pins:[]},
east:{side:"Right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"},pins:[]},west:{side:"Left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"},pins:[]},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},P={data:{},set:function(a,b,c){P.clear(a);P.data[a]=setTimeout(b,c)},clear:function(a){var b=P.data;b[a]&&(clearTimeout(b[a]),delete b[a])}},T=function(a){try{return typeof a==
"string"||typeof a=="object"&&a.constructor.toString().match(/string/i)!==null}catch(b){return!1}},J=function(a,b){return Math.max(a,b)},Ia=function(b){var c,d={cookie:{},defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}},b=b||{};b.effects||b.cookie||b.defaults||b.north||b.south||b.west||b.east||b.center?d=a.extend(!0,d,b):a.each(b,function(a,b){c=a.split("__");if(!c[1]||d[c[0]])d[c[1]?c[0]:"defaults"][c[1]?c[1]:c[0]]=
b});return d},Ja=function(b,c,d){function f(g){var w=o[g];w.doCallback?(e.push(g),g=w.callback.split(",")[1],g!=c&&!a.inArray(g,e)>=0&&f(g)):(w.doCallback=!0,w.callback=b+","+c+","+(d?1:0))}var e=[];a.each(o.borderPanes.split(","),function(a,b){if(o[b].isMoving)return f(b),!1})},H=function(a){a=o[a];o.isLayoutBusy=!1;delete a.isMoving;if(a.doCallback&&a.callback){a.doCallback=!1;var b=a.callback.split(","),c=b[2]>0?!0:!1;b[0]=="open"?na(b[1],c):b[0]=="close"&&oa(b[1],c);if(!a.doCallback)a.callback=
null}},y=function(a,b){if(b){var c;try{if(typeof b=="function")c=b;else if(T(b))if(b.match(/,/)){var d=b.split(",");c=eval(d[0]);if(typeof c=="function"&&d.length>1)return c(d[1])}else c=eval(b);else return;if(typeof c=="function")return a&&u[a]?c(a,u[a],p[a],j[a],j.name):c(Ka,p,j,j.name)}catch(f){}}},wa=function(b){if(!a.layout.browser.mozilla){var c=u[b];p[b].tagName=="IFRAME"?c.css(o.hidden).css(o.visible):c.find("IFRAME").css(o.hidden).css(o.visible)}},ia=function(b,c){var d=T(b),f=d?u[b]:a(b);
if(!f.length)return 0;isNaN(c)&&(c=d?ba(b):f.outerWidth());return a.layout.cssWidth(f,c)},V=function(b,c){var d=T(b),f=d?u[b]:a(b);if(!f.length)return 0;isNaN(c)&&(c=d?ba(b):f.outerHeight());return a.layout.cssHeight(f,c)},La=function(a){var b=o[a].dir,a={minWidth:1001-ia(a,1E3),minHeight:1001-V(a,1E3)};if(b=="horz")a.minSize=a.minHeight;if(b=="vert")a.minSize=a.minWidth;return a},Ma=function(b,c,d){var f=b;T(b)?f=u[b]:b.jquery||(f=a(b));b=V(f,c);f.css({height:b,visibility:"visible"});b>0&&f.innerWidth()>
0?d&&f.data("autoHidden")&&(f.show().data("autoHidden",!1),a.layout.browser.mozilla||f.css(o.hidden).css(o.visible)):d&&!f.data("autoHidden")&&f.hide().data("autoHidden",!0)},U=function(b,c,d){if(!d)d=o[b].dir;T(c)&&c.match(/%/)&&(c=parseInt(c,10)/100);if(c===0)return 0;else if(c>=1)return parseInt(c,10);else if(c>0){var b=j,f;d=="horz"?f=v.innerHeight-(u.north?b.north.spacing_open:0)-(u.south?b.south.spacing_open:0):d=="vert"&&(f=v.innerWidth-(u.west?b.west.spacing_open:0)-(u.east?b.east.spacing_open:
0));return Math.floor(f*c)}else if(b=="center")return 0;else{f=u[b];var d=d=="horz"?"height":"width",b=a.layout.showInvisibly(f),e=f.css(d);f.css(d,"auto");c=d=="height"?f.outerHeight():f.outerWidth();f.css(d,e).css(b);return c}},ba=function(a,b){var c=u[a],d=j[a],f=p[a],e=b?d.spacing_open:0,d=b?d.spacing_closed:0;return!c||f.isHidden?0:f.isClosed||f.isSliding&&b?d:o[a].dir=="horz"?c.outerHeight()+e:c.outerWidth()+e},ja=function(a,b){if(E()){var c=j[a],d=p[a],f=o[a],e=f.dir;f.side.toLowerCase();f.sizeType.toLowerCase();
var f=b!=void 0?b:d.isSliding,g=c.spacing_open,l=o.altSide[a],h=p[l],m=u[l],i=!m||h.isVisible===!1||h.isSliding?0:e=="horz"?m.outerHeight():m.outerWidth(),l=(!m||h.isHidden?0:j[l][h.isClosed!==!1?"spacing_closed":"spacing_open"])||0,h=e=="horz"?v.innerHeight:v.innerWidth,m=La("center"),m=e=="horz"?J(j.center.minHeight,m.minHeight):J(j.center.minWidth,m.minWidth),f=h-g-(f?0:U("center",m,e)+i+l),e=d.minSize=J(U(a,c.minSize),La(a).minSize),g=c.maxSize?U(a,c.maxSize):1E5,f=d.maxSize=Math.min(g,f),d=d.resizerPosition=
{},g=v.insetTop,i=v.insetLeft,l=v.innerWidth,h=v.innerHeight,c=c.spacing_open;switch(a){case "north":d.min=g+e;d.max=g+f;break;case "west":d.min=i+e;d.max=i+f;break;case "south":d.min=g+h-f-c;d.max=g+h-e-c;break;case "east":d.min=i+l-f-c,d.max=i+l-e-c}}},ka=function(b){return a.layout.getElementDimensions(b)},Da=function(b,c){var d=a(b),f=d.data("layoutRole"),e=d.data("layoutEdge"),g=j[e][f+"Class"],e="-"+e,l=d.hasClass(g+"-closed")?"-closed":"-open",R=l=="-closed"?"-open":"-closed",l=g+"-hover "+
(g+e+"-hover ")+(g+l+"-hover ")+(g+e+l+"-hover ");c&&(l+=g+R+"-hover "+(g+e+R+"-hover "));f=="resizer"&&d.hasClass(g+"-sliding")&&(l+=g+"-sliding-hover "+(g+e+"-sliding-hover "));return a.trim(l)},ga=function(b,c){var d=a(c||this);b&&d.data("layoutRole")=="toggler"&&b.stopPropagation();d.addClass(Da(d))},ha=function(b,c){var d=a(c||this);d.removeClass(Da(d,!0))},Ea=function(b){a("body").disableSelection();ga(b,this)},xa=function(b,c){var d=c||this,f=a(d).data("layoutEdge"),e=f+"ResizerLeave";P.clear(f+
"_openSlider");P.clear(e);c?p[f].isResizing||a("body").enableSelection():(ha(b,this),P.set(e,function(){xa(b,d)},200))},E=function(){return p.initialized||p.creatingLayout?!0:l()},l=function(){var b=j;if(!z.is(":visible"))return!1;if(!rb("center").length)return b.showErrorMessages&&alert(K.errCenterPaneMissing),!1;p.creatingLayout=!0;a.extend(v,ka(z));Ib();Na();if(b.scrollToBookmarkOnLoad){var c=self.location;c.hash&&c.replace(c.hash)}b.resizeWithWindow&&!z.data("layoutRole")&&a(window).bind("resize."+
N,m);delete p.creatingLayout;p.initialized=!0;y(null,b.onload_end||b.onload);return!0},m=function(){var a=Number(j.resizeWithWindowDelay);a<10&&(a=100);P.clear("winResize");P.set("winResize",function(){P.clear("winResize");P.clear("winResizeRepeater");var a=ka(z);(a.innerWidth!==v.innerWidth||a.innerHeight!==v.innerHeight)&&Oa()},a);P.data.winResizeRepeater||ca()},ca=function(){var a=Number(j.resizeWithWindowMaxDelay);a>0&&P.set("winResizeRepeater",function(){ca();Oa()},a)},pa=function(){var a=j;
p.cookie=Ba();y(null,a.onunload_start);a.useStateCookie&&a.cookie.autoSave&&aa();y(null,a.onunload_end||a.onunload)},B=function(b){if(!b||b=="all")b=o.borderPanes;a.each(b.split(","),function(b,c){var d=j[c];if(d.enableCursorHotkey||d.customHotkey)return a(document).bind("keydown."+N,e),!1})},Wa=function(){function b(a){for(var d in c)a[d]!=void 0&&(a[c[d]]=a[d],delete a[d])}d=Ia(d);var c={applyDefaultStyles:"applyDemoStyles"};b(d.defaults);a.each(o.allPanes.split(","),function(a,c){b(d[c])});d.effects&&
(a.extend(M,d.effects),delete d.effects);a.extend(j.cookie,d.cookie);a.each("name,containerClass,zIndex,scrollToBookmarkOnLoad,resizeWithWindow,resizeWithWindowDelay,resizeWithWindowMaxDelay,onresizeall,onresizeall_start,onresizeall_end,onload,onload_start,onload_end,onunload,onunload_start,onunload_end,autoBindCustomButtons,useStateCookie".split(","),function(a,b){d[b]!==void 0?j[b]=d[b]:d.defaults[b]!==void 0&&(j[b]=d.defaults[b],delete d.defaults[b])});a.each("paneSelector,resizerCursor,customHotkey".split(","),
function(a,b){delete d.defaults[b]});a.extend(!0,j.defaults,d.defaults);o.center=a.extend(!0,{},o.panes,o.center);var f=j.zIndex;if(f===0||f>0)o.zIndex.pane_normal=f,o.zIndex.resizer_normal=f+1,o.zIndex.iframe_mask=f+1;a.extend(j.center,d.center);var e=a.extend(!0,{},j.defaults,d.defaults,j.center),f="paneClass,contentSelector,applyDemoStyles,triggerEventsOnLoad,showOverflowOnHover,onresize,onresize_start,onresize_end,resizeNestedLayout,resizeContentWhileDragging,onsizecontent,onsizecontent_start,onsizecontent_end".split(",");
a.each(f,function(a,b){j.center[b]=e[b]});var g,l=j.defaults;a.each(o.borderPanes.split(","),function(b,c){o[c]=a.extend(!0,{},o.panes,o[c]);g=j[c]=a.extend(!0,{},j.defaults,j[c],d.defaults,d[c]);if(!g.paneClass)g.paneClass="ui-layout-pane";if(!g.resizerClass)g.resizerClass="ui-layout-resizer";if(!g.togglerClass)g.togglerClass="ui-layout-toggler";a.each(["_open","_close",""],function(b,f){var e="fxName"+f,O="fxSpeed"+f,va="fxSettings"+f;g[e]=d[c][e]||d[c].fxName||d.defaults[e]||d.defaults.fxName||
g[e]||g.fxName||l[e]||l.fxName||"none";var w=g[e];if(w=="none"||!a.effects||!a.effects[w]||!M[w]&&!g[va]&&!g.fxSettings)w=g[e]="none";w=M[w]||{};e=w.all||{};w=w[c]||{};g[va]=a.extend({},e,w,l.fxSettings||{},l[va]||{},g.fxSettings,g[va],d.defaults.fxSettings,d.defaults[va]||{},d[c].fxSettings,d[c][va]||{});g[O]=d[c][O]||d[c].fxSpeed||d.defaults[O]||d.defaults.fxSpeed||g[O]||g[va].duration||g.fxSpeed||g.fxSettings.duration||l.fxSpeed||l.fxSettings.duration||w.duration||e.duration||"normal"})})},rb=
function(a){a=j[a].paneSelector;if(a.substr(0,1)==="#")return z.find(a).eq(0);else{var b=z.children(a).eq(0);return b.length?b:z.children("form:first").children(a).eq(0)}},Ib=function(){a.each(o.allPanes.split(","),function(a,b){zb(b,!0)});sb();a.each(o.borderPanes.split(","),function(a,b){u[b]&&p[b].isVisible&&(ja(b),sa(b))});ta("center");setTimeout(function(){a.each(o.allPanes.split(","),function(a,b){var c=j[b];u[b]&&p[b].isVisible&&(c.triggerEventsOnLoad&&y(b,c.onresize_end||c.onresize),Fa(b))})},
50);j.showErrorMessages&&z.innerHeight()<2&&alert(K.errContainerHeight.replace(/CONTAINER/,v.ref))},zb=function(b,d){if(d||E()){var f=j[b],e=p[b],l=o[b],h=l.dir,w=b=="center",m={},i=u[b],q;i?tb(b):ua[b]=!1;i=u[b]=rb(b);if(i.length){i.data("layoutCSS")||i.data("layoutCSS",a.layout.getElementCSS(i,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"));i.data("parentLayout",Ka).data("layoutRole","pane").data("layoutEdge",b).css(l.cssReq).css("zIndex",
o.zIndex.pane_normal).css(f.applyDemoStyles?l.cssDemo:{}).addClass(f.paneClass+" "+f.paneClass+"-"+b).bind("mouseenter."+N,ga).bind("mouseleave."+N,ha);Ab(b,!1);if(!w)q=e.size=U(b,f.size),l=U(b,f.minSize)||1,w=U(b,f.maxSize)||1E5,q>0&&(q=J(Math.min(q,w),l)),e.isClosed=!1,e.isSliding=!1,e.isResizing=!1,e.isHidden=!1;e.tagName=i[0].tagName;e.edge=b;e.noRoom=!1;e.isVisible=!0;switch(b){case "north":m.top=v.insetTop;m.left=v.insetLeft;m.right=v.insetRight;break;case "south":m.bottom=v.insetBottom;m.left=
v.insetLeft;m.right=v.insetRight;break;case "west":m.left=v.insetLeft;break;case "east":m.right=v.insetRight}if(h=="horz")m.height=J(1,V(b,q));else if(h=="vert")m.width=J(1,ia(b,q));i.css(m);h!="horz"&&ta(b,!0);f.initClosed&&f.closable&&!f.initHidden?oa(b,!0,!0):f.initHidden||f.initClosed?ib(b):e.noRoom||i.css("display","block");i.css("visibility","visible");f.showOverflowOnHover&&i.hover(g,c);p.initialized&&(sb(b),B(b),Oa(),e.isVisible&&(f.triggerEventsOnLoad&&y(b,f.onresize_end||f.onresize),Fa(b)))}else u[b]=
!1}},sb=function(b){if(!b||b=="all")b=o.borderPanes;a.each(b.split(","),function(b,c){var d=u[c];L[c]=!1;W[c]=!1;if(d){var d=j[c],f=p[c],e=d.resizerClass,g=d.togglerClass;o[c].side.toLowerCase();var O="-"+c,l=L[c]=a("<div></div>"),m=d.closable?W[c]=a("<div></div>"):!1;!f.isVisible&&d.slidable&&l.attr("title",d.sliderTip).css("cursor",d.sliderCursor);l.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+"-resizer":"").data("parentLayout",Ka).data("layoutRole","resizer").data("layoutEdge",
c).css(o.resizers.cssReq).css("zIndex",o.zIndex.resizer_normal).css(d.applyDemoStyles?o.resizers.cssDemo:{}).addClass(e+" "+e+O).appendTo(z);m&&(m.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+"-toggler":"").data("parentLayout",Ka).data("layoutRole","toggler").data("layoutEdge",c).css(o.togglers.cssReq).css(d.applyDemoStyles?o.togglers.cssDemo:{}).addClass(g+" "+g+O).appendTo(l),d.togglerContent_open&&a("<span>"+d.togglerContent_open+"</span>").data("layoutRole","togglerContent").data("layoutEdge",
c).addClass("content content-open").css("display","none").appendTo(m),d.togglerContent_closed&&a("<span>"+d.togglerContent_closed+"</span>").data("layoutRole","togglerContent").data("layoutEdge",c).addClass("content content-closed").css("display","none").appendTo(m),Pa(c));Jb(c);f.isVisible?Qa(c):(cb(c),Ga(c,!0))}});ya("all")},Ab=function(b,c){if(E()){var d=j[b],f=d.contentSelector,e=u[b],g;f&&(g=ua[b]=d.findNestedContent?e.find(f).eq(0):e.children(f).eq(0));g&&g.length?(g.data("layoutCSS")||g.data("layoutCSS",
a.layout.getElementCSS(g,"height")),g.css(o.content.cssReq),d.applyDemoStyles&&(g.css(o.content.cssDemo),e.css(o.content.cssDemoPane)),p[b].content={},c!==!1&&Na(b)):ua[b]=!1}},Kb=function(){var b;a.each("toggle,open,close,pin,toggle-slide,open-slide".split(","),function(c,d){a.each(o.borderPanes.split(","),function(c,e){a(".ui-layout-button-"+d+"-"+e).each(function(){b=a(this).data("layoutName")||a(this).attr("layoutName");(b==void 0||b==j.name)&&f(this,d,e)})})})},Jb=function(b){var c=typeof a.fn.draggable==
"function",d;if(!b||b=="all")b=o.borderPanes;a.each(b.split(","),function(b,f){var e=j[f],g=p[f],O=o[f],l=O.dir=="horz"?"top":"left",m,h;if(!c||!u[f]||!e.resizable)return e.resizable=!1,!0;var i=L[f],q=e.resizerClass,x=q+"-drag",B=q+"-"+f+"-drag",ca=q+"-dragging",pa=q+"-"+f+"-dragging",r=q+"-dragging-limit",A=q+"-"+f+"-dragging-limit",Wa=!1;g.isClosed||i.attr("title",e.resizerTip).css("cursor",e.resizerCursor);i.bind("mouseenter."+N,Ea).bind("mouseleave."+N,xa);i.draggable({containment:z[0],axis:O.dir==
"horz"?"y":"x",delay:0,distance:1,helper:"clone",opacity:e.resizerDragOpacity,addClasses:!1,zIndex:o.zIndex.resizer_drag,start:function(){e=j[f];g=p[f];h=e.resizeWhileDragging;if(!1===y(f,e.ondrag_start))return!1;o.isLayoutBusy=!0;g.isResizing=!0;P.clear(f+"_closeSlider");ja(f);m=g.resizerPosition;i.addClass(x+" "+B);Wa=!1;d=a(e.maskIframesOnResize===!0?"iframe":e.maskIframesOnResize).filter(":visible");var b,c=0;d.each(function(){b="ui-layout-mask-"+ ++c;a(this).data("layoutMaskID",b);a('<div id="'+
b+'" class="ui-layout-mask ui-layout-mask-'+f+'"/>').css({background:"#fff",opacity:"0.001",zIndex:o.zIndex.iframe_mask,position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css(a(this).position()).appendTo(this.parentNode)});a("body").disableSelection()},drag:function(a,b){Wa||(b.helper.addClass(ca+" "+pa).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),Wa=!0,g.isSliding&&u[f].css("zIndex",o.zIndex.pane_sliding));var c=0;if(b.position[l]<m.min)b.position[l]=
m.min,c=-1;else if(b.position[l]>m.max)b.position[l]=m.max,c=1;c?(b.helper.addClass(r+" "+A),window.defaultStatus="Panel has reached its "+(c>0&&f.match(/north|west/)||c<0&&f.match(/south|east/)?"maximum":"minimum")+" size"):(b.helper.removeClass(r+" "+A),window.defaultStatus="");h&&G(a,b,f)},stop:function(b,c){a("body").enableSelection();window.defaultStatus="";i.removeClass(x+" "+B);g.isResizing=!1;o.isLayoutBusy=!1;G(b,c,f,!0)}});var G=function(b,c,f,g){var b=c.position,c=o[f],O;switch(f){case "north":O=
b.top;break;case "west":O=b.left;break;case "south":O=v.offsetHeight-b.top-e.spacing_open;break;case "east":O=v.offsetWidth-b.left-e.spacing_open}if(g){if(a("div.ui-layout-mask").each(function(){this.parentNode.removeChild(this)}),!1===y(f,e.ondrag_end||e.ondrag))return!1}else d.each(function(){a("#"+a(this).data("layoutMaskID")).css(a(this).position()).css({width:this.offsetWidth+"px",height:this.offsetHeight+"px"})});mb(f,O-v["inset"+c.side])}})},tb=function(b,c,d){if(E()&&u[b]){var f=u[b],e=ua[b],
g=L[b],l=W[b],m=j[b].paneClass,h=m+"-"+b,m=[m,m+"-open",m+"-closed",m+"-sliding",h,h+"-open",h+"-closed",h+"-sliding"];a.merge(m,Da(f,!0));f&&f.length&&(c&&!f.data("layoutContainer")&&(!e||!e.length||!e.data("layoutContainer"))?f.remove():(f.removeClass(m.join(" ")).removeData("layoutParent").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+N),f.data("layoutContainer")||f.css(f.data("layoutCSS")).removeData("layoutCSS"),e&&e.length&&!e.data("layoutContainer")&&
e.css(e.data("layoutCSS")).removeData("layoutCSS")));l&&l.length&&l.remove();g&&g.length&&g.remove();u[b]=ua[b]=L[b]=W[b]=!1;d||(Oa(),p[b]={})}},ib=function(a,b){if(E()){var c=j[a],d=p[a],f=u[a],e=L[a];if(f&&!d.isHidden&&!(p.initialized&&!1===y(a,c.onhide_start)))if(d.isSliding=!1,e&&e.hide(),!p.initialized||d.isClosed){if(d.isClosed=!0,d.isHidden=!0,d.isVisible=!1,f.hide(),ta(o[a].dir=="horz"?"all":"center"),p.initialized||c.triggerEventsOnLoad)y(a,c.onhide_end||c.onhide)}else d.isHiding=!0,oa(a,
!1,b)}},bb=function(a,b,c,d){if(E()){var f=p[a];if(u[a]&&f.isHidden&&!1!==y(a,j[a].onshow_start))f.isSliding=!1,f.isShowing=!0,b===!1?oa(a,!0):na(a,!1,c,d)}},Ua=function(b,c){if(E()){T(b)||(b.stopImmediatePropagation(),b=a(this).data("layoutEdge"));var d=p[T(b)?a.trim(b):b==void 0||b==null?"":b];d.isHidden?bb(b):d.isClosed?na(b,!!c):oa(b)}},Mb=function(a){var b=p[a];u[a].hide();b.isClosed=!0;b.isVisible=!1},oa=function(a,b,c,d){function f(){if(l.isClosed){Ga(a,!0);var b=o.altSide[a];p[b].noRoom&&
(ja(b),sa(b));if(!d&&(p.initialized||g.triggerEventsOnLoad))m||y(a,g.onclose_end||g.onclose),m&&y(a,g.onshow_end||g.onshow),h&&y(a,g.onhide_end||g.onhide)}H(a)}if(!p.initialized&&u[a])Mb(a);else if(E()){var e=u[a],g=j[a],l=p[a],c=!c&&!l.isClosed&&g.fxName_close!="none",m=l.isShowing,h=l.isHiding;delete l.isShowing;delete l.isHiding;if(e&&(g.closable||m||h)&&(b||!l.isClosed||m))if(o.isLayoutBusy)Ja("close",a,b);else if(m||!1!==y(a,g.onclose_start)){o[a].isMoving=!0;o.isLayoutBusy=!0;l.isClosed=!0;
l.isVisible=!1;if(h)l.isHidden=!0;else if(m)l.isHidden=!1;l.isSliding?la(a,!1):ta(o[a].dir=="horz"?"all":"center",!1);cb(a);c?(Ha(a,!0),e.hide(g.fxName_close,g.fxSettings_close,g.fxSpeed_close,function(){Ha(a,!1);f()})):(e.hide(),f())}}},cb=function(b){var c=L[b],d=W[b],f=j[b],e=o[b].side.toLowerCase(),g=f.resizerClass,l=f.togglerClass,m="-"+b;c.css(e,v["inset"+o[b].side]).removeClass(g+"-open "+g+m+"-open").removeClass(g+"-sliding "+g+m+"-sliding").addClass(g+"-closed "+g+m+"-closed").unbind("dblclick."+
N);f.resizable&&typeof a.fn.draggable=="function"&&c.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title","");d&&(d.removeClass(l+"-open "+l+m+"-open").addClass(l+"-closed "+l+m+"-closed").attr("title",f.togglerTip_closed),d.children(".content-open").hide(),d.children(".content-closed").css("display","block"));q(b,!1);p.initialized&&ya("all")},na=function(a,b,c,d){function f(){l.isVisible&&(wa(a),l.isSliding||ta(o[a].dir=="vert"?"center":"all",!1),Qa(a));H(a)}
if(E()){var e=u[a],g=j[a],l=p[a],c=!c&&l.isClosed&&g.fxName_open!="none",m=l.isShowing;delete l.isShowing;if(e&&(g.resizable||g.closable||m)&&(!l.isVisible||l.isSliding))if(l.isHidden&&!m)bb(a,!0);else if(o.isLayoutBusy)Ja("open",a,b);else if(ja(a,b),!1!==y(a,g.onopen_start))if(ja(a,b),l.minSize>l.maxSize)q(a,!1),!d&&g.noRoomToOpenTip&&alert(g.noRoomToOpenTip);else{o[a].isMoving=!0;o.isLayoutBusy=!0;b?la(a,!0):l.isSliding?la(a,!1):g.slidable&&Ga(a,!1);l.noRoom=!1;sa(a);l.isVisible=!0;l.isClosed=!1;
if(m)l.isHidden=!1;c?(Ha(a,!0),e.show(g.fxName_open,g.fxSettings_open,g.fxSpeed_open,function(){Ha(a,!1);f()})):(e.show(),f())}}},Qa=function(b,c){var d=u[b],f=L[b],e=W[b],g=j[b],l=p[b],m=o[b].side.toLowerCase(),h=g.resizerClass,i=g.togglerClass,x="-"+b;f.css(m,v["inset"+o[b].side]+ba(b)).removeClass(h+"-closed "+h+x+"-closed").addClass(h+"-open "+h+x+"-open");l.isSliding?f.addClass(h+"-sliding "+h+x+"-sliding"):f.removeClass(h+"-sliding "+h+x+"-sliding");g.resizerDblClickToggle&&f.bind("dblclick",
Ua);ha(0,f);g.resizable&&typeof a.fn.draggable=="function"?f.draggable("enable").css("cursor",g.resizerCursor).attr("title",g.resizerTip):l.isSliding||f.css("cursor","default");e&&(e.removeClass(i+"-closed "+i+x+"-closed").addClass(i+"-open "+i+x+"-open").attr("title",g.togglerTip_open),ha(0,e),e.children(".content-closed").hide(),e.children(".content-open").css("display","block"));q(b,!l.isSliding);a.extend(l,ka(d));p.initialized&&(ya("all"),Na(b,!0));if(!c&&(p.initialized||g.triggerEventsOnLoad)&&
d.is(":visible"))y(b,g.onopen_end||g.onopen),l.isShowing&&y(b,g.onshow_end||g.onshow),p.initialized&&(y(b,g.onresize_end||g.onresize),Fa(b))},Xa=function(b){function c(){e.isClosed?o[f].isMoving||na(f,!0):la(f,!0)}if(E()){var d=T(b)?null:b,f=d?a(this).data("layoutEdge"):b,e=p[f],b=j[f].slideDelay_open;d&&d.stopImmediatePropagation();e.isClosed&&d&&d.type=="mouseenter"&&b>0?P.set(f+"_openSlider",c,b):c()}},ub=function(b){function c(){e.isClosed?la(f,!1):o[f].isMoving||oa(f)}if(E()){var d=T(b)?null:
b,f=d?a(this).data("layoutEdge"):b,b=j[f],e=p[f],g=o[f].isMoving?1E3:300;if(!e.isClosed&&!e.isResizing)if(b.slideTrigger_close=="click")c();else if(!b.preventQuickSlideClose||!o.isLayoutBusy)if(!b.preventPrematureSlideClose||!d||!a.layout.isMouseOverElem(d,u[f]))d?P.set(f+"_closeSlider",c,J(b.slideDelay_close,g)):c()}},Ha=function(b,c){var d=u[b];if(c)d.css({zIndex:o.zIndex.pane_animate}),b=="south"?d.css({top:v.insetTop+v.innerHeight-d.outerHeight()}):b=="east"&&d.css({left:v.insetLeft+v.innerWidth-
d.outerWidth()});else{d.css({zIndex:p[b].isSliding?o.zIndex.pane_sliding:o.zIndex.pane_normal});b=="south"?d.css({top:"auto"}):b=="east"&&d.css({left:"auto"});var f=j[b];a.layout.browser.msie&&f.fxOpacityFix&&f.fxName_open!="slide"&&d.css("filter")&&d.css("opacity")==1&&d[0].style.removeAttribute("filter")}},Ga=function(a,b){var c=j[a],d=L[a],f=c.slideTrigger_open.toLowerCase();if(d&&(!b||c.slidable)){if(f.match(/mouseover/))f=c.slideTrigger_open="mouseenter";else if(!f.match(/click|dblclick|mouseenter/))f=
c.slideTrigger_open="click";d[b?"bind":"unbind"](f+"."+N,Xa).css("cursor",b?c.sliderCursor:"default").attr("title",b?c.sliderTip:"")}},la=function(a,b){function c(b){P.clear(a+"_closeSlider");b.stopPropagation()}var d=j[a],f=p[a],e=o.zIndex,g=d.slideTrigger_close.toLowerCase(),l=b?"bind":"unbind",m=u[a],h=L[a];f.isSliding=b;P.clear(a+"_closeSlider");b&&Ga(a,!1);m.css("zIndex",b?e.pane_sliding:e.pane_normal);h.css("zIndex",b?e.pane_sliding:e.resizer_normal);if(!g.match(/click|mouseleave/))g=d.slideTrigger_close=
"mouseleave";h[l](g,ub);g=="mouseleave"&&(m[l]("mouseleave."+N,ub),h[l]("mouseenter."+N,c),m[l]("mouseenter."+N,c));b?g=="click"&&!d.resizable&&(h.css("cursor",b?d.sliderCursor:"default"),h.attr("title",b?d.togglerTip_open:"")):P.clear(a+"_closeSlider")},sa=function(b,c,d,f){var c=j[b],e=p[b],g=o[b],l=u[b],m=L[b],h=g.dir=="vert",i=!1;if(b=="center"||h&&e.noVerticalRoom)if((i=e.maxHeight>0)&&e.noRoom){l.show();m&&m.show();e.isVisible=!0;e.noRoom=!1;if(h)e.noVerticalRoom=!1;wa(b)}else if(!i&&!e.noRoom)l.hide(),
m&&m.hide(),e.isVisible=!1,e.noRoom=!0;if(b!="center")if(e.minSize<=e.maxSize){if(e.size>e.maxSize?Ca(b,e.maxSize,d,f):e.size<e.minSize?Ca(b,e.minSize,d,f):m&&l.is(":visible")&&(d=g.side.toLowerCase(),f=e.size+v["inset"+g.side],a.layout.cssNum(m,d)!=f&&m.css(d,f)),e.noRoom)e.wasOpen&&c.closable?c.autoReopen?na(b,!1,!0,!0):e.noRoom=!1:bb(b,e.wasOpen,!0,!0)}else if(!e.noRoom)e.noRoom=!0,e.wasOpen=!e.isClosed&&!e.isSliding,e.isClosed||(c.closable?oa(b,!0,!0):ib(b,!0))},mb=function(a,b,c){if(E()){var d=
j[a],f=d.resizeWhileDragging&&!o.isLayoutBusy;d.autoResize=!1;Ca(a,b,c,f)}},Ca=function(b,c,d,f){if(E()){var e=j[b],g=p[b],l=u[b],m=L[b],h=o[b].side.toLowerCase(),i=o[b].sizeType.toLowerCase(),q="inset"+o[b].side,x=o.isLayoutBusy&&!e.triggerEventsWhileDragging,B;ja(b);B=g.size;c=U(b,c);c=J(c,U(b,e.minSize));c=Math.min(c,g.maxSize);if(c<g.minSize)sa(b,!1,d);else if(f||c!=B)!d&&p.initialized&&g.isVisible&&y(b,e.onresize_start),l.css(i,J(1,o[b].dir=="horz"?V(b,c):ia(b,c))),g.size=c,a.extend(g,ka(l)),
m&&l.is(":visible")&&m.css(h,c+v[q]),Na(b),!d&&!x&&p.initialized&&g.isVisible&&(y(b,e.onresize_end||e.onresize),Fa(b)),d||(g.isSliding||ta(o[b].dir=="horz"?"all":"center",x,f),ya("all")),b=o.altSide[b],c<B&&p[b].noRoom&&(ja(b),sa(b,!1,d))}},ta=function(b,c,d){if(!b||b=="all")b="east,west,center";a.each(b.split(","),function(b,f){if(u[f]){var e=j[f],g=p[f],l=u[f],m=!0,h={},m={top:ba("north",!0),bottom:ba("south",!0),left:ba("west",!0),right:ba("east",!0),width:0,height:0};m.width=v.innerWidth-m.left-
m.right;m.height=v.innerHeight-m.bottom-m.top;m.top+=v.insetTop;m.bottom+=v.insetBottom;m.left+=v.insetLeft;m.right+=v.insetRight;a.extend(g,ka(l));if(f=="center"){if(!d&&g.isVisible&&m.width==g.outerWidth&&m.height==g.outerHeight)return!0;a.extend(g,La(f),{maxWidth:m.width,maxHeight:m.height});h=m;h.width=ia(f,h.width);h.height=V(f,h.height);m=h.width>0&&h.height>0;if(!m&&!p.initialized&&e.minWidth>0){var i=e.minWidth-g.outerWidth,q=j.east.minSize||0,x=j.west.minSize||0,B=p.east.size,ca=p.west.size,
pa=B,o=ca;i>0&&p.east.isVisible&&B>q&&(pa=J(B-q,B-i),i-=B-pa);i>0&&p.west.isVisible&&ca>x&&(o=J(ca-x,ca-i),i-=ca-o);if(i==0){B!=q&&Ca("east",pa,!0);ca!=x&&Ca("west",o,!0);ta("center",c,d);return}}}else{g.isVisible&&!g.noVerticalRoom&&a.extend(g,ka(l),La(f));if(!d&&!g.noVerticalRoom&&m.height==g.outerHeight)return!0;h.top=m.top;h.bottom=m.bottom;h.height=V(f,m.height);g.maxHeight=J(0,h.height);m=g.maxHeight>0;if(!m)g.noVerticalRoom=!0}m?(!c&&p.initialized&&y(f,e.onresize_start),l.css(h),g.noRoom&&
!g.isClosed&&!g.isHidden&&sa(f),g.isVisible&&(a.extend(g,ka(l)),p.initialized&&Na(f))):!g.noRoom&&g.isVisible&&sa(f);if(!g.isVisible)return!0;if(f=="center")g=a.layout.browser,g=g.isIE6||g.msie&&!g.boxModel,u.north&&(g||p.north.tagName=="IFRAME")&&u.north.css("width",ia(u.north,v.innerWidth)),u.south&&(g||p.south.tagName=="IFRAME")&&u.south.css("width",ia(u.south,v.innerWidth));!c&&p.initialized&&(y(f,e.onresize_end||e.onresize),Fa(f))}})},Oa=function(){if(p.initialized){if(z.is(":visible:")&&(a.extend(p.container,
ka(z)),v.outerHeight)){if(!1===y(null,j.onresizeall_start))return!1;var b,c,d;a.each(["south","north","east","west"],function(a,b){u[b]&&(d=p[b],c=j[b],c.autoResize&&d.size!=c.size?Ca(b,c.size,!0,!0):(ja(b),sa(b,!1,!0,!0)))});ta("all",!0,!0);ya("all");c=j;a.each(o.allPanes.split(","),function(a,d){if((b=u[d])&&p[d].isVisible)y(d,c[d].onresize_end||c[d].onresize),Fa(d)});y(null,c.onresizeall_end||c.onresizeall)}}else l()},Fa=function(a){var b=u[a],c=ua[a];j[a].resizeNestedLayout&&(b.data("layoutContainer")?
b.layout().resizeAll():c&&c.data("layoutContainer")&&c.layout().resizeAll())},Na=function(b,c){if(E()){if(!b||b=="all")b=o.allPanes;a.each(b.split(","),function(a,b){function d(a){return J(m.css.paddingBottom,parseInt(a.css("marginBottom"),10)||0)}function f(){var a=j[b].contentIgnoreSelector,a=g.nextAll().not(a||":lt(0)"),c=a.filter(":visible"),e=c.filter(":last");h={top:g[0].offsetTop,height:g.outerHeight(),numFooters:a.length,hiddenFooters:a.length-c.length,spaceBelow:0};h.spaceAbove=h.top;h.bottom=
h.top+h.height;h.spaceBelow=e.length?e[0].offsetTop+e.outerHeight()-h.bottom+d(e):d(g)}var e=u[b],g=ua[b],l=j[b],m=p[b],h=m.content;if(!e||!g||!e.is(":visible"))return!0;if(!1!==y(null,l.onsizecontent_start)){if(!o.isLayoutBusy||h.top==void 0||c||l.resizeContentWhileDragging)f(),h.hiddenFooters>0&&e.css("overflow")=="hidden"&&(e.css("overflow","visible"),f(),e.css("overflow","hidden"));e=m.innerHeight-(h.spaceAbove-m.css.paddingTop)-(h.spaceBelow-m.css.paddingBottom);if(!g.is(":visible")||h.height!=
e)Ma(g,e,!0),h.height=e;p.initialized&&(y(b,l.onsizecontent_end||l.onsizecontent),Fa(b))}})}},ya=function(b){if(!b||b=="all")b=o.borderPanes;a.each(b.split(","),function(b,c){var d=j[c],f=p[c],e=u[c],g=L[c],l=W[c],m;if(e&&g){var h=o[c].dir,i=f.isClosed?"_closed":"_open",q=d["spacing"+i],x=d["togglerAlign"+i],i=d["togglerLength"+i],B;if(q==0)g.hide();else{!f.noRoom&&!f.isHidden&&g.show();h=="horz"?(B=e.outerWidth(),f.resizerLength=B,g.css({width:J(1,ia(g,B)),height:J(0,V(g,q)),left:a.layout.cssNum(e,
"left")})):(B=e.outerHeight(),f.resizerLength=B,g.css({height:J(1,V(g,B)),width:J(0,ia(g,q)),top:v.insetTop+ba("north",!0)}));ha(d,g);if(l){if(i==0||f.isSliding&&d.hideTogglerOnSlide){l.hide();return}else l.show();if(!(i>0)||i=="100%"||i>B)i=B,x=0;else if(T(x))switch(x){case "top":case "left":x=0;break;case "bottom":case "right":x=B-i;break;default:x=Math.floor((B-i)/2)}else e=parseInt(x,10),x=x>=0?e:B-i+e;if(h=="horz"){var ca=ia(l,i);l.css({width:J(0,ca),height:J(1,V(l,q)),left:x,top:0});l.children(".content").each(function(){m=
a(this);m.css("marginLeft",Math.floor((ca-m.outerWidth())/2))})}else{var pa=V(l,i);l.css({height:J(0,pa),width:J(1,ia(l,q)),top:x,left:0});l.children(".content").each(function(){m=a(this);m.css("marginTop",Math.floor((pa-m.outerHeight())/2))})}ha(0,l)}if(!p.initialized&&(d.initHidden||f.noRoom))g.hide(),l&&l.hide()}}})},Pa=function(a){if(E()){var b=W[a],c=j[a];if(b)c.closable=!0,b.bind("click."+N,function(b){b.stopPropagation();Ua(a)}).bind("mouseenter."+N,ga).bind("mouseleave."+N,ha).css("visibility",
"visible").css("cursor","pointer").attr("title",p[a].isClosed?c.togglerTip_closed:c.togglerTip_open).show()}},z=a(this).eq(0);if(!z.length)return j.showErrorMessages&&alert(K.errContainerMissing),null;if(z.data("layoutContainer")&&z.data("layout"))return z.data("layout");var u={},ua={},L={},W={},v=p.container,N=p.id,Ka={options:j,state:p,container:z,panes:u,contents:ua,resizers:L,togglers:W,toggle:Ua,hide:ib,show:bb,open:na,close:oa,slideOpen:Xa,slideClose:ub,slideToggle:function(a){Ua(a,!0)},initContent:Ab,
sizeContent:Na,sizePane:mb,swapPanes:function(b,c){function d(b){var c=u[b],f=ua[b];return!c?!1:{pane:b,P:c?c[0]:!1,C:f?f[0]:!1,state:a.extend({},p[b]),options:a.extend({},j[b])}}function f(b,c){if(b){var d=b.P,e=b.C,g=b.pane,m=o[c],h=m.side.toLowerCase(),i="inset"+m.side,q=a.extend({},p[c]),x=j[c],B={resizerCursor:x.resizerCursor};a.each("fxName,fxSpeed,fxSettings".split(","),function(a,b){B[b]=x[b];B[b+"_open"]=x[b+"_open"];B[b+"_close"]=x[b+"_close"]});u[c]=a(d).data("layoutEdge",c).css(o.hidden).css(m.cssReq);
ua[c]=e?a(e):!1;j[c]=a.extend({},b.options,B);p[c]=a.extend({},b.state);d.className=d.className.replace(RegExp(x.paneClass+"-"+g,"g"),x.paneClass+"-"+c);sb(c);m.dir!=o[g].dir?(d=l[c]||0,ja(c),d=J(d,p[c].minSize),mb(c,d,!0)):L[c].css(h,v[i]+(p[c].isVisible?ba(c):0));b.state.isVisible&&!q.isVisible?Qa(c,!0):(cb(c),Ga(c,!0));b=null}}if(E()){p[b].edge=c;p[c].edge=b;var e=!1;!1===y(b,j[b].onswap_start)&&(e=!0);!e&&!1===y(c,j[c].onswap_start)&&(e=!0);if(e)p[b].edge=b,p[c].edge=c;else{var e=d(b),g=d(c),
l={};l[b]=e?e.state.size:0;l[c]=g?g.state.size:0;u[b]=!1;u[c]=!1;p[b]={};p[c]={};W[b]&&W[b].remove();W[c]&&W[c].remove();L[b]&&L[b].remove();L[c]&&L[c].remove();L[b]=L[c]=W[b]=W[c]=!1;f(e,c);f(g,b);e=g=l=null;u[b]&&u[b].css(o.visible);u[c]&&u[c].css(o.visible);Oa();y(b,j[b].onswap_end||j[b].onswap);y(c,j[c].onswap_end||j[c].onswap)}}},resizeAll:Oa,initPanes:E,destroy:function(){a(window).unbind("."+N);a(document).unbind("."+N);a.each(o.allPanes.split(","),function(a,b){tb(b,!1,!0)});z.removeData("layout").removeData("layoutContainer").removeClass(j.containerClass);
!z.data("layoutEdge")&&z.data("layoutCSS")&&z.css(z.data("layoutCSS")).removeData("layoutCSS");v.tagName=="BODY"&&(z=a("html")).data("layoutCSS")&&z.css(z.data("layoutCSS")).removeData("layoutCSS");pa()},addPane:zb,removePane:tb,setSizeLimits:ja,bindButton:f,addToggleBtn:i,addOpenBtn:r,addCloseBtn:h,addPinBtn:t,allowOverflow:g,resetOverflow:c,encodeJSON:ab,decodeJSON:Va,getState:Ba,getCookie:A,saveCookie:aa,deleteCookie:function(){aa("",{expires:-1})},loadCookie:x,loadState:ra,cssWidth:ia,cssHeight:V,
enableClosable:Pa,disableClosable:function(a,b){if(E()){var c=W[a];if(c)j[a].closable=!1,p[a].isClosed&&na(a,!1,!0),c.unbind("."+N).css("visibility",b?"hidden":"visible").css("cursor","default").attr("title","")}},enableSlidable:function(a){if(E()){var b=L[a];if(b&&b.data("draggable"))j[a].slidable=!0,s.isClosed&&Ga(a,!0)}},disableSlidable:function(a){if(E()){var b=L[a];if(b)j[a].slidable=!1,p[a].isSliding?oa(a,!1,!0):(Ga(a,!1),b.css("cursor","default").attr("title",""),ha(null,b[0]))}},enableResizable:function(a){if(E()){var b=
L[a],c=j[a];if(b&&b.data("draggable"))c.resizable=!0,b.draggable("enable").bind("mouseenter."+N,Ea).bind("mouseleave."+N,xa),p[a].isClosed||b.css("cursor",c.resizerCursor).attr("title",c.resizerTip)}},disableResizable:function(a){if(E()){var b=L[a];if(b&&b.data("draggable"))j[a].resizable=!1,b.draggable("disable").unbind("."+N).css("cursor","default").attr("title",""),ha(null,b[0])}}};return function(){Wa();var b=j;a.layout.browser.boxModel=a.support.boxModel;b.useStateCookie&&b.cookie.autoLoad&&
x();p.creatingLayout=!0;if(!1===y(null,b.onload_start))return"cancel";var c=v.tagName=z[0].tagName,d=j,f=c=="BODY",e={},g=z.is(":visible");v.selector=z.selector.split(".slice")[0];v.ref=c+"/"+v.selector;z.data("layout",Ka).data("layoutContainer",N).addClass(d.containerClass);z.data("layoutCSS")||(f?(e=a.extend(a.layout.getElementCSS(z,"overflow,position,margin,padding,border"),{height:z.css("height"),overflow:z.css("overflow"),overflowX:z.css("overflowX"),overflowY:z.css("overflowY")}),c=a("html"),
c.data("layoutCSS",{height:"auto",overflow:c.css("overflow"),overflowX:c.css("overflowX"),overflowY:c.css("overflowY")})):e=a.layout.getElementCSS(z,"overflow,position,margin,padding,border,top,bottom,left,right,width,height,overflow,overflowX,overflowY"),z.data("layoutCSS",e));try{if(f)a("html").css({height:"100%",overflow:"hidden",overflowX:"hidden",overflowY:"hidden"}),a("body").css({position:"relative",height:"100%",overflow:"hidden",overflowX:"hidden",overflowY:"hidden",margin:0,padding:0,border:"none"}),
a.extend(v,ka(z));else{var e={overflow:"hidden",overflowX:"hidden",overflowY:"hidden"},m=z.css("position");z.css("height");if(!z.data("layoutRole")&&(!m||!m.match(/fixed|absolute|relative/)))e.position="relative";z.css(e);g&&(a.extend(v,ka(z)),d.showErrorMessages&&v.innerHeight<2&&alert(K.errContainerHeight.replace(/CONTAINER/,v.ref)))}}catch(h){}B();b.autoBindCustomButtons&&Kb();a(window).bind("unload."+N,pa);b.initPanes&&l();delete p.creatingLayout;return p.initialized}()==="cancel"?null:Ka}})(jQuery);(function(a){var d,e,g=function(a,c){var d=0,e=[];c&&(c.length?e=c:e[c-1]=null);this.complete=function(){d+=1;d===e.length&&(a(e),d=0,e=[])};this.push=function(a){e.push(a)};this.getList=function(){return e}},c=function(){var a=[];this.push=function(c){a.push(c);a.length===1&&c()};this.next=function(){a.shift();if(a.length)a[0]()}};d=function(b){var d=this,e,r,h={namespace:"file_upload",uploadFormFilter:function(){return!0},fileInputFilter:function(){return!0},cssClass:"file_upload",dragDropSupport:!0,
dropZone:b,url:function(a){return a.attr("action")},method:function(a){return a.attr("method")},fieldName:function(a){return a.attr("name")},formData:function(a){return a.serializeArray()},requestHeaders:null,multipart:!0,multiFileRequest:!1,withCredentials:!1,forceIframeUpload:!1,sequentialUploads:!1,maxChunkSize:null,maxFileReaderSize:5E7},t={},q={},G=/^http(s)?:\/\//,A,aa=new g(function(a){if(typeof h.onLoadAll==="function")h.onLoadAll(a)}),x=new c,ra=function(){aa.complete();x.next()},Ba=function(){return typeof XMLHttpRequest!==
"undefined"&&typeof XMLHttpRequestUpload!=="undefined"&&typeof File!=="undefined"&&(!h.multipart||typeof FormData!=="undefined"||typeof FileReader!=="undefined"&&typeof XMLHttpRequest.prototype.sendAsBinary==="function")},ab=function(){if(h.dragDropSupport)typeof h.onDocumentDragEnter==="function"&&(t["dragenter."+h.namespace]=function(a){h.onDocumentDragEnter(a)}),typeof h.onDocumentDragLeave==="function"&&(t["dragleave."+h.namespace]=function(a){h.onDocumentDragLeave(a)}),t["dragover."+h.namespace]=
d.onDocumentDragOver,t["drop."+h.namespace]=d.onDocumentDrop,a(document).bind(t),typeof h.onDragEnter==="function"&&(q["dragenter."+h.namespace]=function(a){h.onDragEnter(a)}),typeof h.onDragLeave==="function"&&(q["dragleave."+h.namespace]=function(a){h.onDragLeave(a)}),q["dragover."+h.namespace]=d.onDragOver,q["drop."+h.namespace]=d.onDrop,h.dropZone.bind(q);r.bind("change."+h.namespace,d.onChange)},Va=function(){a.each(t,function(b,c){a(document).unbind(b,c)});a.each(q,function(a,b){h.dropZone.unbind(a,
b)});r.unbind("change."+h.namespace)},K=function(a){return typeof a.uploadedBytes!=="undefined"},j=function(a,b,c){var d;typeof document.createEvent==="function"&&typeof ProgressEvent!=="undefined"?(d=document.createEvent("ProgressEvent"),d.initProgressEvent("progress",!1,!1,a,b,c)):d={lengthComputable:!0,loaded:b,total:c};return d},M=function(a,b,c){var d;if(typeof c.progressTotal==="undefined")if(a[b])d=a[b].size,c.progressTotal=d?d:1;else{for(b=d=0;b<a.length;b+=1)d+=a[b].size;c.progressTotal=
d}return c.progressTotal},p=function(b,c,d,f,e){var g=0,h=0;if(b.lengthComputable&&typeof e.onProgressAll==="function")e.progressLoaded=parseInt(b.loaded/b.total*M(c,d,e),10),c=aa.getList(),a.each(c,function(a,b){g+=b[3].progressLoaded||0;h+=M(b[0],b[1],b[3])}),b=j(!0,g,h),e.onProgressAll(b,c)},o=function(a,b,c,d,f){var e;if(K(f)){f.uploadedBytes+=f.chunkSize;e=j(!0,f.uploadedBytes,b[c].size);if(typeof f.onProgress==="function")f.onProgress(e,b,c,d,f);p(e,b,c,d,f);if(f.uploadedBytes<b[c].size){typeof f.resumeUpload===
"function"?f.resumeUpload(a,b,c,d,f,function(){Ma(a,b,c,d,f,!0)}):Ma(a,b,c,d,f,!0);return}}f.progressLoaded=M(b,c,f);if(typeof f.onLoad==="function")f.onLoad(a,b,c,d,f);ra()},P=function(a,b,c,d){if(c.upload)c.upload.onprogress=function(f){var e=f;K(d)&&f.lengthComputable&&(e=j(!0,d.uploadedBytes+parseInt(f.loaded/f.total*d.chunkSize,10),a[b].size));if(typeof d.onProgress==="function")d.onProgress(e,a,b,c,d);p(e,a,b,c,d)};c.onload=function(f){o(f,a,b,c,d)};c.onabort=function(f){d.progressTotal=d.progressLoaded;
if(typeof d.onAbort==="function")d.onAbort(f,a,b,c,d);ra()};c.onerror=function(f){d.progressTotal=d.progressLoaded;if(typeof d.onError==="function")d.onError(f,a,b,c,d);ra()}},T=function(a){return typeof a.url==="function"?a.url(a.uploadForm||e):a.url},J=function(a){return typeof a.method==="function"?a.method(a.uploadForm||e):a.method},Ia=function(a){return typeof a.fieldName==="function"?a.fieldName(a.fileInput||r):a.fieldName},Ja=function(b){var c;if(typeof b.formData==="function")return b.formData(b.uploadForm||
e);else if(a.isArray(b.formData))return b.formData;else if(b.formData)return c=[],a.each(b.formData,function(a,b){c.push({name:a,value:b})}),c;return[]},H=function(b){if(G.test(b)){var c=location.host,d=location.protocol.length+2,f=b.indexOf(c,d),c=f+c.length;return(f===d||f===b.indexOf("@",d)+1)&&(b.length===c||a.inArray(b.charAt(c),["/","?","#"])!==-1)?!0:!1}return!0},y=function(b,c,d,f){var b=b[c],c=T(f),e=H(c);d.open(J(f),c,!0);if(e){if(d.setRequestHeader("X-Requested-With","XMLHttpRequest"),
!f.multipart||K(f))d.setRequestHeader("X-File-Name",b.name),d.setRequestHeader("X-File-Type",b.type),d.setRequestHeader("X-File-Size",b.size),K(f)?f.multipart||d.setRequestHeader("Content-Type","application/octet-stream"):d.setRequestHeader("Content-Type",b.type)}else if(f.withCredentials)d.withCredentials=!0;a.isArray(f.requestHeaders)?a.each(f.requestHeaders,function(a,b){d.setRequestHeader(b.name,b.value)}):f.requestHeaders&&a.each(f.requestHeaders,function(a,b){d.setRequestHeader(a,b)})},wa=function(b,
c,d){var f=new FormData,e;a.each(Ja(d),function(a,b){f.append(b.name,b.value)});for(e=0;e<b.length;e+=1)f.append(Ia(d),b[e]);c.send(f)},ia=function(a,b){a.reader=new FileReader;a.reader.onload=b;a.reader.readAsBinaryString(a)},V=function(b,c,d,f){var e="",g=[];a.each(f,function(a,c){e+="--"+b+'\r\nContent-Disposition: form-data; name="'+unescape(encodeURIComponent(c.name))+'"\r\n\r\n'+unescape(encodeURIComponent(c.value))+"\r\n"});a.each(c,function(a,c){e+="--"+b+'\r\nContent-Disposition: form-data; name="'+
unescape(encodeURIComponent(d))+'"; filename="'+unescape(encodeURIComponent(c.name))+'"\r\nContent-Type: '+unescape(encodeURIComponent(c.type))+"\r\n\r\n";g.push(e);g.push(c.reader.result);delete c.reader;e="\r\n"});e+="--"+b+"--\r\n";g.push(e);return g.join("")},La=function(a,b,c){var d="----MultiPartFormBoundary"+(new Date).getTime(),f,e;b.setRequestHeader("Content-Type","multipart/form-data; boundary="+d);f=new g(function(){b.sendAsBinary(V(d,a,Ia(c),Ja(c)))},a.length);for(e=0;e<a.length;e+=1)ia(a[e],
f.complete)},Ma=function(b,c,d,f,e,g){var h;h=function(){if(!g&&typeof e.onSend==="function"&&e.onSend(b,c,d,f,e)===!1)ra();else{var h;var i=c[d];h=e;var x=h.uploadedBytes,q=h.maxChunkSize;if(i&&typeof i.slice==="function"&&(x||q&&q<i.size))h.uploadedBytes=x=x||0,i=i.slice(x,q||i.size-x),h.chunkSize=i.size;h=i;P(c,d,f,e);y(c,d,f,e);e.multipart?(h=typeof d==="number"?[h]:c,typeof FormData!=="undefined"?wa(h,f,e):typeof FileReader!=="undefined"&&typeof f.sendAsBinary==="function"?La(h,f,e):a.error("Browser does not support multipart/form-data XHR file uploads")):
f.upload?f.send(h):a.error("Browser does not support XHR file uploads")}};if(!g&&(aa.push(Array.prototype.slice.call(arguments,1)),e.sequentialUploads)){x.push(h);return}h()},U=function(b,c,d,f,e){var g=new XMLHttpRequest,i=a.extend({},h);i.fileInput=d;i.uploadForm=f;typeof i.initUpload==="function"?i.initUpload(b,c,e,g,i,function(){Ma(b,c,e,g,i)}):Ma(b,c,e,g,i)},ba=function(b,c,d,f,e){var g=0;typeof d==="undefined"?a.each(c,function(a,b){g+=b.size?b.size:1}):g=c[d].size?c[d].size:1;b=j(!0,g,g);e.progressLoaded=
g;p(b,c,d,f,e)},ja=function(b,c,d){var f=Ja(d);c.find(":input").not(":disabled").attr("disabled",!0).addClass(d.namespace+"_disabled");a.each(f,function(b,f){a('<input type="hidden"/>').attr("name",f.name).val(f.value).addClass(d.namespace+"_form_data").appendTo(c)});b.attr("name",Ia(d)).appendTo(c)},ka=function(a,b,c){a.detach();b.find("."+c.namespace+"_disabled").removeAttr("disabled").removeClass(c.namespace+"_disabled");b.find("."+c.namespace+"_form_data").remove()},Da=function(b,c,d,f,e,g,h){var i;
i=function(){if(typeof g.onSend==="function"&&g.onSend(b,c,h,e,g)===!1)ra();else{var i=f.attr("action"),x=f.attr("method"),q=f.attr("target");e.unbind("abort").bind("abort",function(a){e.readyState=0;e.unbind("load").attr("src","javascript".concat(":false;"));ba(a,c,h,e,g);if(typeof g.onAbort==="function")g.onAbort(a,c,h,e,g);ra()}).unbind("load").bind("load",function(b){e.readyState=4;ba(b,c,h,e,g);if(typeof g.onLoad==="function")g.onLoad(b,c,h,e,g);a('<iframe src="javascript:false;" style="display:none;"></iframe>').appendTo(f).remove();
ra()});f.attr("action",T(g)).attr("method",J(g)).attr("target",e.attr("name"));ja(d,f,g);e.readyState=2;f.get(0).submit();ka(d,f,g);f.attr("action",i).attr("method",x).attr("target",q)}};aa.push([c,h,e,g]);g.sequentialUploads?x.push(i):i()},ga=function(a,b){if(typeof b.name==="undefined"&&typeof b.size==="undefined")b.name=b.fileName,b.size=b.fileSize},ha=function(b,c,d,f){if(!b||!c||!d)a.error("Iframe based File Upload requires a file input change event");else{var e=a('<iframe src="javascript:false;" style="display:none;" name="iframe_'+
h.namespace+"_"+(new Date).getTime()+'"></iframe>'),g=a.extend({},h),i=b.target&&b.target.files,i=i?Array.prototype.slice.call(i,0):[{name:c.val(),type:null,size:null}];a.each(i,ga);f=i.length===1?0:f;g.fileInput=c;g.uploadForm=d;e.readyState=0;e.abort=function(){e.trigger("abort")};e.bind("load",function(){e.unbind("load");typeof g.initUpload==="function"?g.initUpload(b,i,f,e,g,function(){Da(b,i,c,d,e,g,f)}):Da(b,i,c,d,e,g,f)}).appendTo(d)}},Ea=function(b,c,d,f){var e;a:{var g=e=0,i;if(h.multipart&&
typeof FormData==="undefined"){for(i=0;i<c.length;i+=1){e=c[i].size;if(e>h.maxFileReaderSize){e=!1;break a}g+=e}if(h.multiFileRequest&&g>h.maxFileReaderSize){e=!1;break a}}e=!0}if(e)if(c=Array.prototype.slice.call(c,0),a.each(c,ga),h.multiFileRequest&&h.multipart&&c.length)U(b,c,d,f);else for(e=0;e<c.length;e+=1)U(b,c,d,f,e);else ha(b,d,f)},xa=function(){e=(b.is("form")?b:b.find("form")).filter(h.uploadFormFilter)},E=function(){r=(e.length?e:b).find("input:file").filter(h.fileInputFilter)};this.onDocumentDragOver=
function(a){if(typeof h.onDocumentDragOver==="function"&&h.onDocumentDragOver(a)===!1)return!1;a.preventDefault()};this.onDocumentDrop=function(a){if(typeof h.onDocumentDrop==="function"&&h.onDocumentDrop(a)===!1)return!1;a.preventDefault()};this.onDragOver=function(a){if(typeof h.onDragOver==="function"&&h.onDragOver(a)===!1)return!1;var b=a.originalEvent.dataTransfer;if(b&&b.files)b.dropEffect=b.effectAllowed="copy",a.preventDefault()};this.onDrop=function(a){if(typeof h.onDrop==="function"&&h.onDrop(a)===
!1)return!1;var b=a.originalEvent.dataTransfer;b&&b.files&&Ba()&&Ea(a,b.files);a.preventDefault()};this.onChange=function(b){if(typeof h.onChange==="function"&&h.onChange(b)===!1)return!1;var c=a(b.target),d=a(b.target.form);if(d.length===1){c.data("file_upload_form",d);var f=c.clone(!0);a("<form/>").append(f).get(0).reset();c.after(f).detach();E()}else d=c.data("file_upload_form");!h.forceIframeUpload&&b.target.files&&Ba()?Ea(b,b.target.files,c,d):ha(b,c,d)};this.init=function(c){c&&(a.extend(h,
c),A=c);xa();E();b.data(h.namespace)?a.error('FileUpload with namespace "'+h.namespace+'" already assigned to this element'):(b.data(h.namespace,d).addClass(h.cssClass),h.dropZone.not(b).addClass(h.cssClass),ab(),typeof h.init==="function"&&h.init())};this.options=function(c){var d,f,e,g;if(typeof c==="undefined")return a.extend({},h);A&&a.extend(A,c);Va();a.each(c,function(b,c){switch(b){case "namespace":a.error("The FileUpload namespace cannot be updated.");return;case "uploadFormFilter":g=e=!0;
break;case "fileInputFilter":g=!0;break;case "cssClass":d=h.cssClass;break;case "dropZone":f=h.dropZone}h[b]=c});e&&xa();g&&E();typeof d!=="undefined"?(b.removeClass(d).addClass(h.cssClass),(f?f:h.dropZone).not(b).removeClass(d),h.dropZone.not(b).addClass(h.cssClass)):f&&(f.not(b).removeClass(h.cssClass),h.dropZone.not(b).addClass(h.cssClass));ab()};this.option=function(a,b){var c;if(typeof b==="undefined")return h[a];c={};c[a]=b;d.options(c)};this.destroy=function(){typeof h.destroy==="function"&&
h.destroy();Va();b.removeData(h.namespace).removeClass(h.cssClass);h.dropZone.not(b).removeClass(h.cssClass)};this.upload=function(a){typeof a.length==="undefined"&&(a=[a]);Ea(null,a)}};e={init:function(b){return this.each(function(){(new d(a(this))).init(b)})},option:function(b,c,d){var d=d?d:"file_upload",e=a(this).data(d);if(e)if(b){if(typeof b==="string"&&typeof c==="undefined")return e.option(b)}else return e.options();else a.error('No FileUpload with namespace "'+d+'" assigned to this element');
return this.each(function(){var e=a(this).data(d);e?typeof b==="string"?e.option(b,c):e.options(b):a.error('No FileUpload with namespace "'+d+'" assigned to this element')})},destroy:function(b){b=b?b:"file_upload";return this.each(function(){var c=a(this).data(b);c?c.destroy():a.error('No FileUpload with namespace "'+b+'" assigned to this element')})},upload:function(b,c){c=c?c:"file_upload";return this.each(function(){var d=a(this).data(c);d?d.upload(b):a.error('No FileUpload with namespace "'+
c+'" assigned to this element')})}};a.fn.fileUpload=function(b){if(e[b])return e[b].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof b==="object"||!b)return e.init.apply(this,arguments);else a.error('Method "'+b+'" does not exist on jQuery.fileUpload')}})(jQuery);(function(a){var d,e,g=function(a){var b=0,d=[];this.complete=function(){b+=1;b===d.length+1&&(a(d),b=0,d=[])};this.push=function(a){d.push(a)};this.getList=function(){return d}};d=function(c,b){var d=this,e,r,h=new g(function(a){d.hideProgressBarAll(function(){d.resetProgressBarAll();if(typeof d.onCompleteAll==="function")d.onCompleteAll(a)})}),t=function(a){return typeof a.uploadTable==="function"?a.uploadTable(a):a.uploadTable};this.requestHeaders={Accept:"application/json, text/javascript, */*; q=0.01"};
this.dropZone=c;this.imageTypes=/^image\/(gif|jpeg|png)$/;this.previewMaxWidth=this.previewMaxHeight=80;this.previewLoadDelay=100;this.previewAsCanvas=!0;this.previewSelector=".file_upload_preview";this.progressSelector=".file_upload_progress div";this.cancelSelector=".file_upload_cancel button";this.cssClassSmall="file_upload_small";this.cssClassLarge="file_upload_large";this.cssClassHighlight="file_upload_highlight";this.dropEffect="highlight";this.progressAllNode=this.buildUploadRow=this.buildDownloadRow=
this.uploadTable=this.downloadTable=null;this.loadImage=function(a,b,c,d,e,f){var g,h,i;if(e&&!e.test(a.type))return null;h=function(a){var b=document.createElement("canvas"),e=Math.min((c||a.width)/a.width,(d||a.height)/a.height);e>1&&(e=1);a.width=parseInt(a.width*e,10);a.height=parseInt(a.height*e,10);if(f||typeof b.getContext!=="function")return a;b.width=a.width;b.height=a.height;b.getContext("2d").drawImage(a,0,0,a.width,a.height);return b};g=document.createElement("img");(i=typeof URL!=="undefined"?
URL:typeof webkitURL!=="undefined"?webkitURL:null)&&typeof i.createObjectURL==="function"?(g.onload=function(){i.revokeObjectURL(this.src);b(h(g))},g.src=i.createObjectURL(a)):typeof FileReader!=="undefined"&&typeof FileReader.prototype.readAsDataURL==="function"?(g.onload=function(){b(h(g))},e=new FileReader,e.onload=function(a){g.src=a.target.result},e.readAsDataURL(a)):b(null)};this.addNode=function(a,b,c){a&&a.length&&b&&b.length?b.css("display","none").appendTo(a).fadeIn(function(){if(typeof c===
"function")try{c()}catch(a){throw b.stop(),a;}}):typeof c==="function"&&c()};this.removeNode=function(a,b){a&&a.length?a.fadeOut(function(){a.remove();if(typeof b==="function")try{b()}catch(c){throw a.stop(),c;}}):typeof b==="function"&&b()};this.replaceNode=function(a,b,c){if(!b||!b.length)return d.removeNode(a,c);a&&a.length?a.fadeOut(function(){b.css("display","none");a.replaceWith(b);b.fadeIn(function(){if(typeof c==="function")try{c()}catch(d){throw a.stop(),b.stop(),d;}})}):typeof c==="function"&&
c()};this.resetProgressBarAll=function(){d.progressbarAll&&d.progressbarAll.progressbar("value",0)};this.hideProgressBarAll=function(b){d.progressbarAll&&!a(t(d)).find(d.progressSelector+":visible:first").length?d.progressbarAll.fadeOut(b):typeof b==="function"&&b()};this.onAbort=function(a,b,c,d,e){e.removeNode(e.uploadRow,e.hideProgressBarAll)};this.cancelUpload=function(a,b,c,d,e){var f=d.readyState;d.abort();if(typeof f!=="number"||f<2)e.onAbort(a,b,c,d,e)};this.initProgressBar=function(b,c){return!b||
!b.length?null:typeof b.progressbar==="function"?b.progressbar({value:c}):(b.addClass("progressbar").append(a("<div/>").css("width",c+"%")).progressbar=function(b,c){return this.each(function(){b==="destroy"?a(this).removeClass("progressbar").empty():a(this).children().css("width",c+"%")})},b)};this.destroyProgressBar=function(a){return!a||!a.length?null:a.progressbar("destroy")};this.initUploadProgress=function(a,b){!a.upload&&b.progressbar&&b.progressbar.progressbar("value",100)};this.initUploadProgressAll=
function(){d.progressbarAll&&d.progressbarAll.is(":hidden")&&d.progressbarAll.fadeIn()};this.onSend=function(a,b,c,d,e){e.initUploadProgress(d,e)};this.onProgress=function(a,b,c,d,e){e.progressbar&&a.lengthComputable&&e.progressbar.progressbar("value",parseInt(a.loaded/a.total*100,10))};this.onProgressAll=function(a){d.progressbarAll&&a.lengthComputable&&d.progressbarAll.progressbar("value",parseInt(a.loaded/a.total*100,10))};this.onLoadAll=function(){h.complete()};this.initProgressBarAll=function(){if(!d.progressbarAll)d.progressbarAll=
d.initProgressBar(typeof d.progressAllNode==="function"?d.progressAllNode(d):d.progressAllNode,0)};this.destroyProgressBarAll=function(){d.destroyProgressBar(d.progressbarAll)};this.loadPreviewImage=function(b,c,d){c=c||0;d.uploadRow.find(d.previewSelector).each(function(){var e=a(this),f=b[c];setTimeout(function(){d.loadImage(f,function(b){d.addNode(e,a(b))},d.previewMaxWidth,d.previewMaxHeight,d.imageTypes,!d.previewAsCanvas)},d.previewLoadDelay);c+=1})};this.initUploadRow=function(a,b,c,d,e){if(a=
e.uploadRow=typeof e.buildUploadRow==="function"?e.buildUploadRow(b,c,e):null)e.progressbar=e.initProgressBar(a.find(e.progressSelector),0),a.find(e.cancelSelector).click(function(a){e.cancelUpload(a,b,c,d,e);a.preventDefault()}),e.loadPreviewImage(b,c,e)};this.initUpload=function(a,b,c,d,e,f){e.initUploadRow(a,b,c,d,e);e.addNode(t(e),e.uploadRow,function(){typeof e.beforeSend==="function"?e.beforeSend(a,b,c,d,e,f):f()});e.initUploadProgressAll()};this.parseResponse=function(b){return typeof b.responseText!==
"undefined"?a.parseJSON(b.responseText):a.parseJSON(b.contents().text())};this.initDownloadRow=function(a,b,c,d,e){var f;try{f=e.response=e.parseResponse(d,e)}catch(g){if(typeof e.onError==="function")e.originalEvent=a,e.onError(g,b,c,d,e);else throw g;}e.downloadRow=typeof e.buildDownloadRow==="function"?e.buildDownloadRow(f,e):null};this.onLoad=function(a,b,c,d,e){var f=t(e),g=typeof e.downloadTable==="function"?e.downloadTable(e):e.downloadTable,i=function(){if(typeof e.onComplete==="function")e.onComplete(a,
b,c,d,e);h.complete()};h.push(Array.prototype.slice.call(arguments,1));e.initDownloadRow(a,b,c,d,e);f&&e.uploadRow&&e.uploadRow.length&&(!g||f.get(0)===g.get(0))?e.replaceNode(e.uploadRow,e.downloadRow,i):e.removeNode(e.uploadRow,function(){e.addNode(g,e.downloadRow,i)})};this.dropZoneEnlarge=function(){r||(typeof d.dropZone.switchClass==="function"?d.dropZone.switchClass(d.cssClassSmall,d.cssClassLarge):(d.dropZone.addClass(d.cssClassLarge),d.dropZone.removeClass(d.cssClassSmall)),r=!0)};this.dropZoneReduce=
function(){typeof d.dropZone.switchClass==="function"?d.dropZone.switchClass(d.cssClassLarge,d.cssClassSmall):(d.dropZone.addClass(d.cssClassSmall),d.dropZone.removeClass(d.cssClassLarge));r=!1};this.onDocumentDragEnter=function(){d.dropZoneEnlarge()};this.onDocumentDragOver=function(){e&&clearTimeout(e);e=setTimeout(function(){d.dropZoneReduce()},200)};this.onDragEnter=this.onDragLeave=function(){d.dropZone.toggleClass(d.cssClassHighlight)};this.onDrop=function(){e&&clearTimeout(e);d.dropEffect&&
typeof d.dropZone.effect==="function"?d.dropZone.effect(d.dropEffect,function(){d.dropZone.removeClass(d.cssClassHighlight);d.dropZoneReduce()}):(d.dropZone.removeClass(d.cssClassHighlight),d.dropZoneReduce())};this.init=function(){d.initProgressBarAll();typeof d.initExtended==="function"&&d.initExtended()};this.destroy=function(){typeof d.destroyExtended==="function"&&d.destroyExtended();d.destroyProgressBarAll()};a.extend(this,b)};e={init:function(c){return this.each(function(){a(this).fileUpload(new d(a(this),
c))})},option:function(c,b,d){return!c||typeof c==="string"&&typeof b==="undefined"?a(this).fileUpload("option",c,b,d):this.each(function(){a(this).fileUpload("option",c,b,d)})},destroy:function(c){return this.each(function(){a(this).fileUpload("destroy",c)})},upload:function(c,b){return this.each(function(){a(this).fileUpload("upload",c,b)})}};a.fn.fileUploadUI=function(c){if(e[c])return e[c].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof c==="object"||!c)return e.init.apply(this,
arguments);else a.error('Method "'+c+'" does not exist on jQuery.fileUploadUI')}})(jQuery);(function(a){function d(){var a=!1,b=!1;this.stopPropagation=function(){a=!0};this.isPropagationStopped=function(){return a};this.stopImmediatePropagation=function(){b=!0};this.isImmediatePropagationStopped=function(){return b}}function e(){this.__nonDataRow=!0}function g(){this.__group=!0;this.__updated=!1;this.count=0;this.title=this.value=null;this.collapsed=!1;this.totals=null}function c(){this.__groupTotals=!0;this.group=null}function b(){var a=null;this.isActive=function(b){return b?a===b:a!==
null};this.activate=function(b){if(b!==a){if(a!==null)throw"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController";if(!b.commitCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()";if(!b.cancelCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()";a=b}};this.deactivate=function(b){if(a!==b)throw"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one";
a=null};this.commitCurrentEdit=function(){return a?a.commitCurrentEdit():!0};this.cancelCurrentEdit=function(){return a?a.cancelCurrentEdit():!0}}a.extend(!0,window,{Slick:{Event:function(){var a=[];this.subscribe=function(b){a.push(b)};this.unsubscribe=function(b){for(var c=a.length-1;c>=0;c--)a[c]===b&&a.splice(c,1)};this.notify=function(b,c,e){for(var c=c||new d,e=e||this,g,q=0;q<a.length&&!c.isPropagationStopped()&&!c.isImmediatePropagationStopped();q++)g=a[q].call(e,c,b);return g}},EventData:d,
Range:function(a,b,c,d){c===void 0&&d===void 0&&(c=a,d=b);this.fromRow=Math.min(a,c);this.fromCell=Math.min(b,d);this.toRow=Math.max(a,c);this.toCell=Math.max(b,d);this.isSingleRow=function(){return this.fromRow==this.toRow};this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell};this.contains=function(a,b){return a>=this.fromRow&&a<=this.toRow&&b>=this.fromCell&&b<=this.toCell};this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+
")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}},NonDataRow:e,Group:g,GroupTotals:c,EditorLock:b,GlobalEditorLock:new b}});g.prototype=new e;g.prototype.equals=function(a){return this.value===a.value&&this.count===a.count&&this.collapsed===a.collapsed};c.prototype=new e})(jQuery);(function(a){a.extend(!0,window,{Slick:{RowSelectionModel:function(d){function e(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].fromRow;d<=a[c].toRow;d++)b.push(d);return b}function g(a){for(var b=[],c=t.getColumns().length-1,d=0;d<a.length;d++)b.push(new Slick.Range(a[d],0,a[d],c));return b}function c(a,b){var c,d=[];for(c=a;c<=b;c++)d.push(c);for(c=b;c<a;c++)d.push(c);return d}function b(){return e(q)}function f(a){q=a;G.onSelectedRangesChanged.notify(q)}function i(a,b){A.selectActiveRow&&f([new Slick.Range(b.row,
0,b.row,t.getColumns().length-1)])}function r(a){var d=t.getActiveCell();if(d&&a.shiftKey&&!a.ctrlKey&&!a.altKey&&!a.metaKey&&(a.which==38||a.which==40)){var e=b();e.sort(function(a,b){return a-b});e.length||(e=[d.row]);var h=e[0],e=e[e.length-1],d=a.which==40?d.row<e||h==e?++e:++h:d.row<e?--e:--h;d>=0&&d<t.getDataLength()&&(t.scrollRowIntoView(d),q=g(c(h,e)),f(q));a.preventDefault();a.stopPropagation()}}function h(b){var c=t.getCellFromEvent(b);if(!c||!t.canCellBeActive(c.row,c.cell))return!1;var d=
e(q),h=a.inArray(c.row,d);if(!b.ctrlKey&&!b.shiftKey&&!b.metaKey)return!1;else if(t.getOptions().multiSelect)if(h===-1&&(b.ctrlKey||b.metaKey))d.push(c.row),t.setActiveCell(c.row,c.cell);else if(h!==-1&&(b.ctrlKey||b.metaKey))d=a.grep(d,function(a){return a!==c.row}),t.setActiveCell(c.row,c.cell);else if(d.length&&b.shiftKey){for(var h=d.pop(),i=Math.min(c.row,h),r=Math.max(c.row,h),d=[];i<=r;i++)i!==h&&d.push(i);d.push(h);t.setActiveCell(c.row,c.cell)}q=g(d);f(q);b.stopImmediatePropagation();return!0}
var t,q=[],G=this,A,aa={selectActiveRow:!0};a.extend(this,{getSelectedRows:b,setSelectedRows:function(a){f(g(a))},getSelectedRanges:function(){return q},setSelectedRanges:f,init:function(b){A=a.extend(!0,{},aa,d);t=b;t.onActiveCellChanged.subscribe(i);t.onKeyDown.subscribe(r);t.onClick.subscribe(h)},destroy:function(){t.onActiveCellChanged.unsubscribe(i);t.onKeyDown.unsubscribe(r);t.onClick.unsubscribe(h)},onSelectedRangesChanged:new Slick.Event})}}})})(jQuery);/*

 (c) 2009-2010 Michael Leibman
 michael{dot}leibman{at}gmail{dot}com
 http://github.com/mleibman/slickgrid
 Distributed under MIT license.
 All rights reserved.

 SlickGrid v2.0 alpha

 NOTES:
 Cell/row DOM manipulations are done directly bypassing jQuery's DOM manipulation methods.
 This increases the speed dramatically, but can only be done safely because there are no event handlers
 or data associated with any cell/row DOM nodes.  Cell editors must make sure they implement .destroy()
 and do proper cleanup.
*/
if(typeof jQuery==="undefined")throw"SlickGrid requires jquery module to be loaded";if(!jQuery.fn.drag)throw"SlickGrid requires jquery.event.drag module to be loaded";if(typeof Slick==="undefined")throw"slick.core.js not loaded";
(function(a){a.extend(!0,window,{Slick:{Grid:function(e,g,c,b){function f(a){for(var b=Ya.length;b>=0;b--)if(Ya[b]===a){Ya[b].destroy&&Ya[b].destroy();Ya.splice(b,1);break}}function i(){var b=a("<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>").appendTo("body"),c={width:b.width()-b[0].clientWidth,height:b.height()-b[0].clientHeight};b.remove();return c}function r(){for(var a=0,b=c.length;b--;)a+=c[b].width||Lb.width;return a}function h(a){X.width(a);
ac=a>vb-d.width}function t(a){a&&a.jquery&&a.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function q(){for(var b=1E6,c=a.browser.mozilla?5E6:1E9,d=a("<div style='display:none' />").appendTo(document.body);b<=c;)if(d.css("height",b+1E6),d.height()!==b+1E6)break;else b+=1E6;d.remove();return b}function G(){for(var b=X[0];(b=b.parentNode)!=document.body;)(b==ma[0]||b.scrollWidth!=b.clientWidth||b.scrollHeight!=b.clientHeight)&&a(b).bind("scroll.slickgrid",
Fa)}function A(){function d(){a(this).addClass("ui-state-hover")}function e(){a(this).removeClass("ui-state-hover")}var f;ea.empty();wb.empty();Ta={};for(f=0;f<c.length;f++){var g=c[f]=a.extend({},Lb,c[f]);Ta[g.id]=f;var h=a("<div class='ui-state-default slick-header-column' id='"+fa+g.id+"' />").html("<span class='slick-column-name'>"+g.name+"</span>").width(g.width-nb).attr("title",g.toolTip||g.name||"").data("fieldId",g.id).addClass(g.headerCssClass||"").appendTo(ea);(b.enableColumnReorder||g.sortable)&&
h.hover(d,e);g.sortable&&h.append("<span class='slick-sort-indicator' />");b.showHeaderRow&&a("<div class='ui-state-default slick-headerrow-column c"+f+"'></div>").appendTo(wb)}J(ob,Za);ra();b.enableColumnReorder&&x()}function aa(){ea.click(function(b){if(!a(b.target).hasClass("slick-resizable-handle")&&(b=a(b.target).closest(".slick-header-column"),b.length&&(b=c[p(b.data("fieldId"))],b.sortable&&M().commitCurrentEdit())))b.id===ob?Za=!Za:(ob=b.id,Za=!0),J(ob,Za),j(D.onSort,{sortCol:b,sortAsc:Za})})}
function x(){ea.sortable({containment:"parent",axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",forcePlaceholderSize:!0,start:function(b,c){a(c.helper).addClass("slick-header-column-active")},beforeStop:function(b,c){a(c.helper).removeClass("slick-header-column-active")},stop:function(b){if(M().commitCurrentEdit()){for(var d=ea.sortable("toArray"),e=[],f=0;f<d.length;f++)e.push(c[p(d[f].replace(fa,""))]);
Ja(e);j(D.onColumnsReordered,{});b.stopPropagation();ra()}else a(this).sortable("cancel")}})}function ra(){var d,e,f,g,i,l,m,o,p;g=ea.children();g.find(".slick-resizable-handle").remove();g.each(function(a){c[a].resizable&&(m===void 0&&(m=a),o=a)});m!==void 0&&g.each(function(q,r){q<m||b.forceFitColumns&&q>=o||(a(r),a("<div class='slick-resizable-handle' />").appendTo(r).bind("dragstart",function(h){if(!M().commitCurrentEdit())return!1;f=h.pageX;a(this).parent().addClass("slick-header-column-active");
var m=h=null;g.each(function(b,d){c[b].previousWidth=a(d).outerWidth()});if(b.forceFitColumns){m=h=0;for(d=q+1;d<g.length;d++)e=c[d],e.resizable&&(m!==null&&(e.maxWidth?m+=e.maxWidth-e.previousWidth:m=null),h+=e.previousWidth-Math.max(e.minWidth||0,$a))}var j=0,o=0;for(d=0;d<=q;d++)e=c[d],e.resizable&&(o!==null&&(e.maxWidth?o+=e.maxWidth-e.previousWidth:o=null),j+=e.previousWidth-Math.max(e.minWidth||0,$a));h===null&&(h=1E5);j===null&&(j=1E5);m===null&&(m=1E5);o===null&&(o=1E5);l=f+Math.min(h,o);
i=f-Math.min(j,m);p=X.width()}).bind("drag",function(a){var m=Math.min(l,Math.max(i,a.pageX))-f,j;if(m<0){j=m;for(d=q;d>=0;d--)if(e=c[d],e.resizable)a=Math.max(e.minWidth||0,$a),j&&e.previousWidth+j<a?(j+=e.previousWidth-a,e.width=a):(e.width=e.previousWidth+j,j=0);if(b.forceFitColumns){j=-m;for(d=q+1;d<g.length;d++)if(e=c[d],e.resizable)j&&e.maxWidth&&e.maxWidth-e.previousWidth<j?(j-=e.maxWidth-e.previousWidth,e.width=e.maxWidth):(e.width=e.previousWidth+j,j=0)}else b.syncColumnCellResize&&h(p+m)}else{j=
m;for(d=q;d>=0;d--)if(e=c[d],e.resizable)j&&e.maxWidth&&e.maxWidth-e.previousWidth<j?(j-=e.maxWidth-e.previousWidth,e.width=e.maxWidth):(e.width=e.previousWidth+j,j=0);if(b.forceFitColumns){j=-m;for(d=q+1;d<g.length;d++)if(e=c[d],e.resizable)a=Math.max(e.minWidth||0,$a),j&&e.previousWidth+j<a?(j+=e.previousWidth-a,e.width=a):(e.width=e.previousWidth+j,j=0)}else b.syncColumnCellResize&&h(p+m)}P();b.syncColumnCellResize&&T()}).bind("dragend",function(){var b;a(this).parent().removeClass("slick-header-column-active");
for(d=0;d<g.length;d++)e=c[d],b=a(g[d]).outerWidth(),e.previousWidth!==b&&e.rerenderOnResize&&U();T();ga();j(D.onColumnsResized,{})}))})}function Ba(b){var c=0;a.each(["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],function(a,d){c+=parseFloat(b.css(d))||0});return c}function ab(){var b,c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],d=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];b=a("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo(ea);
nb=bc=0;a.each(c,function(a,c){nb+=parseFloat(b.css(c))||0});a.each(d,function(a,c){bc+=parseFloat(b.css(c))||0});b.remove();var e=a("<div class='slick-row' />").appendTo(X);b=a("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(e);xb=Nb=0;a.each(c,function(a,c){xb+=parseFloat(b.css(c))||0});a.each(d,function(a,c){Nb+=parseFloat(b.css(c))||0});e.remove();$a=Math.max(nb,xb)}function Va(){eb=a("<style type='text/css' rel='stylesheet' />").appendTo(a("head"));for(var d=["."+
fa+" .slick-header-column { left: 1000px; }","."+fa+" .slick-top-panel { height:"+b.topPanelHeight+"px; }","."+fa+" .slick-headerrow-columns { height:"+b.headerRowHeight+"px; }","."+fa+" .slick-cell { height:"+(b.rowHeight-Nb)+"px; }","."+fa+" .slick-row { width:"+r()+"px; }","."+fa+" .lr { float:none; position:absolute; }"],e=r(),g=0,f,h=0;h<c.length;h++)f=c[h].width,d.push("."+fa+" .l"+h+" { left: "+g+"px; }"),d.push("."+fa+" .r"+h+" { right: "+(e-g-f)+"px; }"),d.push("."+fa+" .c"+h+" { width:"+
(f-xb)+"px; }"),g+=c[h].width;eb[0].styleSheet?eb[0].styleSheet.cssText=d.join(" "):eb[0].appendChild(document.createTextNode(d.join(" ")));d=document.styleSheets;for(h=0;h<d.length;h++)if((d[h].ownerNode||d[h].owningElement)==eb[0]){Ob=d[h];break}}function K(a){for(var b=Ob.cssRules||Ob.rules,c=0;c<b.length;c++)if(b[c].selectorText==a)return b[c];return null}function j(a,b,c){c=c||new Slick.EventData;b=b||{};b.grid=D;return a.notify(b,c,D)}function M(){return b.editorLock}function p(a){return Ta[a]}
function o(){var a,e,g=[],f=0,h=b.autoHeight?vb:vb-d.width,i=0;for(a=i=0;a<c.length;a++)e=c[a],g.push(e.width),i+=e.width,f+=e.width-Math.max(e.minWidth||0,$a);for(U();i>h;){if(!f)return;var j=(i-h)/f;for(a=0;a<c.length&&i>h;a++)if(e=c[a],e.resizable&&!(e.minWidth===e.width||e.width===$a))e=Math.floor(j*(e.width-Math.max(e.minWidth||0,$a)))||1,i-=e,g[a]-=e}for(f=i;i<h;){j=h/i;for(a=0;a<c.length&&i<h;a++)e=c[a],e.resizable&&!(e.maxWidth<=e.width)&&(e=Math.min(Math.floor(j*e.width)-e.width,e.maxWidth-
e.width||1E6)||1,i+=e,g[a]+=e);if(f==i)break;f=i}for(a=0;a<c.length;a++)c[a].width=g[a];P();T();ga()}function P(){for(var b,d=0,e=ea.children(),f=e.length;d<f;d++)b=a(e[d]),b.width()!==c[d].width-nb&&b.width(c[d].width-nb)}function T(){for(var a=r(),b=0,d,e,f=0;f<c.length;f++)d=c[f].width,e=K("."+fa+" .c"+f),e.style.width=d-xb+"px",e=K("."+fa+" .l"+f),e.style.left=b+"px",e=K("."+fa+" .r"+f),e.style.right=a-b-d+"px",b+=c[f].width;e=K("."+fa+" .slick-row");e.style.width=a+"px"}function J(a,b){ob=a;
Za=b;var c=Ta[ob];ea.children().removeClass("slick-header-column-sorted");ea.find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc");c!=null&&ea.children().eq(c).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(Za?"slick-sort-indicator-asc":"slick-sort-indicator-desc")}function Ia(a,d){Pb=[];for(var e={},f=0;f<d.length;f++)for(var g=d[f].fromRow;g<=d[f].toRow;g++){e[g]||Pb.push(g);e[g]={};for(var h=d[f].fromCell;h<=d[f].toCell;h++)if(Yb(g,
h))e[g][c[h].id]=b.selectedCellCssClass}rb(b.selectedCellCssClass,e);j(D.onSelectedRowsChanged,{rows:$b()},a)}function Ja(a){c=a;U();A();eb.remove();Va();ha();ca()}function H(){return g.getLength?g.getLength():g.length}function y(a){return g.getItem?g.getItem(a):g[a]}function wa(a){var c=S;kb=Math.min(lb-1,Math.floor(a/jb));S=Math.round(kb*Cb);a-=S;if(S!=c){var d=xa(a);Ma(d.top,d.bottom);for(var e in Y)Y[e].style.top=e*b.rowHeight-S+"px"}if(pb!=a)db=pb+c<a+S?1:-1,ma[0].scrollTop=Qb=Z=pb=a,j(D.onViewportChanged,
{})}function ia(a,b,c){return c===null||c===void 0?"":c}function V(a,c){var d=g.getItemMetadata&&g.getItemMetadata(a),e=d&&d.columns&&(d.columns[c.id]||d.columns[Ta[c.id]]);return e&&e.formatter||d&&d.formatter||c.formatter||b.formatterFactory&&b.formatterFactory.getFormatter(c)||ia}function La(a,d){var e=c[d],f=g.getItemMetadata&&g.getItemMetadata(a);return(f=f&&f.columns)&&f[e.id]&&f[e.id].editor!==void 0?f[e.id].editor:f&&f[d]&&f[d].editor!==void 0?f[d].editor:e.editor||b.editorFactory&&b.editorFactory.getEditor(e)}
function Ma(a){for(var b in Y)(b=parseInt(b,10))!==F&&(b<a.top||b>a.bottom)&&ba(b)}function U(){C&&la();for(var a in Y)ba(a)}function ba(a){var b=Y[a];b&&(X[0].removeChild(b),delete Y[a],delete Db[a],Rb--,cc++)}function ja(a){var b,c;if(a&&a.length){b=db=0;for(c=a.length;b<c;b++)C&&F===b&&la(),Y[a[b]]&&ba(a[b])}}function ka(a){ja([a])}function Da(b){Y[b]&&(a(Y[b]).children().each(function(a){var d=c[a];b===F&&a===Q&&C?C.loadValue(y(F)):this.innerHTML=y(b)?V(b,d)(b,a,y(b)[d.field],d,y(b)):""}),l(b))}
function ga(){qa=b.autoHeight?b.rowHeight*(H()+(b.enableAddRow?1:0)+(b.leaveSpaceForNewRows?Eb-1:0)):parseFloat(a.css(da[0],"height",!0))-b.headerHeight-Ba(ea)-(b.showTopPanel?b.topPanelHeight+Ba(fb):0)-(b.showHeaderRow?b.headerRowHeight+Ba(gb):0);Eb=Math.ceil(qa/b.rowHeight);vb=parseFloat(a.css(da[0],"width",!0));ma.height(qa);for(var d=0,e=c.length;e--;)d+=c[e].width;h(d);Ea();m()}function ha(){b.forceFitColumns?o():ga()}function Ea(){var a=H()+(b.enableAddRow?1:0)+(b.leaveSpaceForNewRows?Eb-1:
0),c=Sa,e=b.enableAddRow?H():H()-1,f;for(f in Y)f>=e&&ba(f);Ra=Math.max(b.rowHeight*a,qa-d.height);Ra<Bb?(Sa=jb=Ra,lb=1,Cb=0):(Sa=Bb,jb=Sa/100,lb=Math.floor(Ra/jb),Cb=(Ra-Sa)/(lb-1));if(Sa!==c)X.css("height",Sa),Z=ma[0].scrollTop;a=Z+S<=Ra-qa;Ra==0||Z==0?kb=S=0:a?wa(Z+S):wa(Ra-qa);Sa!=c&&b.autoHeight&&ga()}function xa(){return{top:Math.floor((Z+S)/b.rowHeight),bottom:Math.ceil((Z+S+qa)/b.rowHeight)}}function E(){b.enableAsyncPostRender&&(clearTimeout(Sb),Sb=setTimeout(pa,b.asyncPostRenderDelay))}
function l(a){delete Db[a];qb=Math.min(qb,a);yb=Math.max(yb,a);E()}function m(){var a=xa(),d=xa(void 0),e=Math.round(qa/b.rowHeight);db==-1?(d.top-=e,d.bottom+=3):db==1?(d.top-=3,d.bottom+=e):(d.top-=3,d.bottom+=3);d.top=Math.max(0,d.top);d.bottom=Math.min(b.enableAddRow?H():H()-1,d.bottom);Ma(d);var f,h=X[0];f=[];for(var i=[],j=!1,e=d.top;e<=d.bottom;e++)if(!Y[e]){Rb++;i.push(e);var m=f,l=e,o=y(l),p=void 0,p="slick-row "+(l<H()&&!o?" loading":"")+(l%2==1?" odd":" even"),q=g.getItemMetadata&&g.getItemMetadata(l);
q&&q.cssClasses&&(p+=" "+q.cssClasses);m.push("<div class='ui-widget-content "+p+"' row='"+l+"' style='top:"+(b.rowHeight*l-S)+"px'>");for(var q=void 0,r=0,u=c.length;r<u;r++){var t=c[r],q=Pa(l,r),p="slick-cell lr l"+r+" r"+Math.min(c.length-1,r+q-1)+(t.cssClass?" "+t.cssClass:"");l===F&&r===Q&&(p+=" active");for(var v in za)za[v][l]&&za[v][l][t.id]&&(p+=" "+za[v][l][t.id]);m.push("<div class='"+p+"'>");o&&m.push(V(l,t)(l,r,o[t.field],t,o));m.push("</div>");q&&(r+=q-1)}m.push("</div>");I&&F===e&&
(j=!0);dc++}d=document.createElement("div");d.innerHTML=f.join("");e=0;for(f=d.childNodes.length;e<f;e++)Y[i[e]]=h.appendChild(d.firstChild);j&&(I=w(F,Q));qb=a.top;yb=Math.min(b.enableAddRow?H():H()-1,a.bottom);E();Qb=Z;Fb=null}function ca(){Z=ma[0].scrollTop;var a=ma[0].scrollLeft,b=Math.abs(Z-pb);if(a!==ec)ec=a,Gb[0].scrollLeft=a,fb[0].scrollLeft=a,gb[0].scrollLeft=a;b&&(db=pb<Z?1:-1,pb=Z,b<qa?wa(Z+S):(b=S,kb=Math.min(lb-1,Math.floor(Z*((Ra-qa)/(Sa-qa))*(1/jb))),S=Math.round(kb*Cb),b!=S&&U()),Fb&&
clearTimeout(Fb),Math.abs(Qb-Z)<qa?m():Fb=setTimeout(m,50),j(D.onViewportChanged,{}));j(D.onScroll,{scrollLeft:a,scrollTop:Z})}function pa(){for(;qb<=yb;){var a=db>=0?qb++:yb--,d=Y[a];if(d&&!(Db[a]||a>=H())){for(var e=y(a),d=d.childNodes,f=0,g=0,h=c.length;f<h;++f){var i=c[f];i.asyncPostRender&&i.asyncPostRender(d[g],qb,e,i);++g}Db[a]=!0;Sb=setTimeout(pa,b.asyncPostRenderDelay);break}}}function B(b,c){if(za[b])throw"addCellCssStyles: cell CSS hash with key '"+b+"' already exists.";za[b]=c;var d,e;
for(e in Y)if(c[e])for(var f in c[e])(d=w(e,Ta[f]))&&a(d).addClass(c[e][f])}function Wa(b){if(za[b]){var c,d;for(d in Y)if(za[b][d])for(var e in za[b][d])(c=w(d,Ta[e]))&&a(c).removeClass(za[b][d][e]);delete za[b]}}function rb(a,b){Wa(a);B(a,b)}function Ib(a,b){var c=Qa(a);if(!c||!cb(c.row,c.cell))return!1;retval=j(D.onDragInit,b,a);return a.isImmediatePropagationStopped()?retval:!1}function zb(a,b){var c=Qa(a);if(!c||!cb(c.row,c.cell))return!1;c=j(D.onDragStart,b,a);return a.isImmediatePropagationStopped()?
c:!1}function sb(a,b){return j(D.onDrag,b,a)}function Ab(a,b){j(D.onDragEnd,b,a)}function Kb(a){j(D.onKeyDown,{},a);if(!a.isImmediatePropagationStopped())if(!a.shiftKey&&!a.altKey&&!a.ctrlKey)if(a.which==27){if(!M().isActive())return;Ca()}else if(a.which==37)O();else if(a.which==39)Ka();else if(a.which==38)Vb();else if(a.which==40)va();else if(a.which==9)Wb();else if(a.which==13)b.editable&&(C?F===H()?va():mb():M().commitCurrentEdit()&&sa());else return;else if(a.which==9&&a.shiftKey&&!a.ctrlKey&&
!a.altKey)Xb();else return;a.stopPropagation();a.preventDefault();try{a.originalEvent.keyCode=0}catch(c){}}function Jb(a){var c=Qa(a);if(c&&!(C!==null&&F==c.row&&Q==c.cell)&&(j(D.onClick,{row:c.row,cell:c.cell},a),!a.isImmediatePropagationStopped()&&R(c.row,c.cell)&&(!M().isActive()||M().commitCurrentEdit())))ya(c.row,!1),Ha(w(c.row,c.cell),c.row===H()||b.autoEdit)}function tb(b){var c=a(b.target).closest(".slick-cell",X);c.length!==0&&(I===c[0]&&C!==null||j(D.onContextMenu,{},b))}function ib(a){var c=
Qa(a);c&&!(C!==null&&F==c.row&&Q==c.cell)&&(j(D.onDblClick,{row:c.row,cell:c.cell},a),a.isImmediatePropagationStopped()||b.editable&&Zb(c.row,c.cell,!0))}function bb(b){var d=a(b.target).closest(".slick-header-column",".slick-header-columns"),d=d&&c[D.getColumnIndex(d.data("fieldId"))];j(D.onHeaderContextMenu,{column:d},b)}function Ua(b){var d=a(b.target).closest(".slick-header-column",".slick-header-columns"),d=d&&c[D.getColumnIndex(d.data("fieldId"))];j(D.onHeaderClick,{column:d},b)}function Mb(a){j(D.onMouseEnter,
{},a)}function oa(a){j(D.onMouseLeave,{},a)}function cb(a,b){return!(a<0||a>=H()||b<0||b>=c.length)}function na(a){var b=/l\d+/.exec(a.className)||/c\d+/.exec(a.className);if(!b)throw"getCellFromNode: cannot get cell - "+a.className;return parseInt(b[0].substr(1,b[0].length-1),10)}function Qa(b){b=a(b.target).closest(".slick-cell",X);return!b.length?null:{row:b.parent().attr("row")|0,cell:na(b[0])}}function Xa(){a.browser.msie?X[0].setActive():X[0].focus()}function ub(){if(I){var b=a(I).position().left,
c=b+a(I).outerWidth(),d=ma.scrollLeft(),e=d+ma.width();b<d?ma.scrollLeft(b):c>e&&ma.scrollLeft(Math.min(b,c-ma[0].clientWidth))}}function Ha(c,d){I!==null&&(la(),a(I).removeClass("active"));var e=I!==c;I=c;I!=null?(F=parseInt(a(I).parent().attr("row")),Q=Tb=na(I),a(I).addClass("active"),b.editable&&d&&Ga(F,Q)?(clearTimeout(Ub),b.asyncEditorLoading?Ub=setTimeout(function(){sa()},b.asyncEditorLoadDelay):sa()):Xa()):F=Q=null;e&&(ub(),j(D.onActiveCellChanged,Na()))}function Ga(a,b){return a<H()&&!y(a)?
!1:c[b].cannotTriggerInsert&&a>=H()?!1:!La(a,b)?!1:!0}function la(){if(C){j(D.onBeforeCellEditorDestroy,{editor:C});C.destroy();C=null;if(I&&(a(I).removeClass("editable invalid"),y(F))){var b=c[Q];I.innerHTML=V(F,b)(F,Q,y(F)[b.field],b,y(F));l(F)}a.browser.msie&&(document.selection&&document.selection.empty?document.selection.empty():window.getSelection&&(b=window.getSelection())&&b.removeAllRanges&&b.removeAllRanges());M().deactivate(Hb)}}function sa(d){if(I){if(!b.editable)throw"Grid : makeActiveCellEditable : should never get called when options.editable is false";
clearTimeout(Ub);if(Ga(F,Q)){var e=c[Q],f=y(F);if(j(D.onBeforeEditCell,{row:F,cell:Q,item:f,column:e})===!1)Xa();else{M().activate(Hb);a(I).addClass("editable");if(!d)I.innerHTML="";C=new (d||La(F,Q))({grid:D,gridPosition:ta(da[0]),position:ta(I),container:I,column:e,item:f||{},commitChanges:mb,cancelChanges:Ca});f&&C.loadValue(f);fc=C.serializeValue();C.position&&Fa()}}}}function mb(){M().commitCurrentEdit()&&(Xa(),b.autoEdit&&va())}function Ca(){M().cancelCurrentEdit()&&Xa()}function ta(b){var c=
{top:b.offsetTop,left:b.offsetLeft,bottom:0,right:0,width:a(b).outerWidth(),height:a(b).outerHeight(),visible:!0};c.bottom=c.top+c.height;c.right=c.left+c.width;for(var d=b.offsetParent;(b=b.parentNode)!=document.body;){if(c.visible&&b.scrollHeight!=b.offsetHeight&&a(b).css("overflowY")!="visible")c.visible=c.bottom>b.scrollTop&&c.top<b.scrollTop+b.clientHeight;if(c.visible&&b.scrollWidth!=b.offsetWidth&&a(b).css("overflowX")!="visible")c.visible=c.right>b.scrollLeft&&c.left<b.scrollLeft+b.clientWidth;
c.left-=b.scrollLeft;c.top-=b.scrollTop;if(b===d)c.left+=b.offsetLeft,c.top+=b.offsetTop,d=b.offsetParent;c.bottom=c.top+c.height;c.right=c.left+c.width}return c}function Oa(){return ta(I)}function Fa(){if(I){var a;j(D.onActiveCellPositionChanged,{});C&&(a=a||Oa(),C.show&&C.hide&&(a.visible?C.show():C.hide()),C.position&&C.position(a))}}function Na(){return I?{row:F,cell:Q}:null}function ya(a,c){var e=a*b.rowHeight,f=(a+1)*b.rowHeight-qa+(ac?d.height:0);(a+1)*b.rowHeight>Z+qa+S?(wa(c?e:f),m()):a*
b.rowHeight<Z+S&&(wa(c?f:e),m())}function Pa(a,b){var lc;var d=g.getItemMetadata&&g.getItemMetadata(a);if(!d||!d.columns)return 1;lc=(d=d.columns[c[b].id]||d.columns[b])&&d.colspan,d=lc;d==="*"&&(d=c.length-b);return d||1}function z(a){for(var b=0;b<c.length;){if(R(a,b))return b;b+=Pa(a,b)}return null}function u(a,b){if(b>=c.length)return null;do b+=Pa(a,b);while(b<c.length&&!R(a,b));return b<c.length?{row:a,cell:b,posX:b}:null}function ua(a,b){if(b<=0)return null;var c=z(a);if(c===null||c>=b)return null;
for(var c={row:a,cell:c,posX:c},d;;){d=u(c.row,c.cell,c.posX);if(!d)return null;if(d.cell>=b)return c;c=d}}function L(a,c,d){for(var e;;){if(++a>=H()+(b.enableAddRow?1:0))return null;for(e=c=0;c<=d;)e=c,c+=Pa(a,c);if(R(a,e))return{row:a,cell:e,posX:d}}}function W(a,b,c){for(var d;;){if(--a<0)return null;for(d=b=0;b<=c;)d=b,b+=Pa(a,b);if(R(a,d))return{row:a,cell:d,posX:c}}}function v(a,c,d){if(c=u(a,c,d))return c;for(c=null;++a<H()+(b.enableAddRow?1:0);)if(c=z(a),c!==null)return{row:a,cell:c,posX:c};
return null}function N(a,b,d){for(var e,f;!e;){if(e=ua(a,b,d))break;if(--a<0)return null;b=0;f=a;for(var g=0,h=null;g<c.length;)R(f,g)&&(h=g),g+=Pa(f,g);f=h;f!==null&&(e={row:a,cell:f,posX:f})}return e}function Ka(){hb("right")}function O(){hb("left")}function va(){hb("down")}function Vb(){hb("up")}function Wb(){hb("next")}function Xb(){hb("prev")}function hb(a){if(I&&b.enableCellNavigation&&M().commitCurrentEdit()&&(a=(0,{up:W,down:L,left:ua,right:u,prev:N,next:v}[a])(F,Q,Tb))){var c=a.row==H();
ya(a.row,!c);Ha(w(a.row,a.cell),c||b.autoEdit);Tb=a.posX}}function w(b,c){if(Y[b])for(var d=a(Y[b]).children(),e,f=0;f<d.length;f++)if(e=na(d[f]),e===c)return d[f];else if(e>c)break;return null}function R(a,d){if(!b.enableCellNavigation||a>=H()+(b.enableAddRow?1:0)||a<0||d>=c.length||d<0)return!1;var e=g.getItemMetadata&&g.getItemMetadata(a);return e&&typeof e.focusable==="boolean"?e.focusable:(e=e&&e.columns)&&e[c[d].id]&&typeof e[c[d].id].focusable==="boolean"?e[c[d].id].focusable:e&&e[d]&&typeof e[d].focusable===
"boolean"?e[d].focusable:typeof c[d].focusable==="boolean"?c[d].focusable:!0}function Yb(a,b){if(a>=H()||a<0||b>=c.length||b<0)return!1;var d=g.getItemMetadata&&g.getItemMetadata(a);return d&&typeof d.selectable==="boolean"?d.selectable:(d=d&&d.columns&&(d.columns[c[b].id]||d.columns[b]))&&typeof d.selectable==="boolean"?d.selectable:typeof c[b].selectable==="boolean"?c[b].selectable:!0}function Zb(a,c,d){R(a,c)&&M().commitCurrentEdit()&&(ya(a,!1),c=w(a,c),Ha(c,d||a===H()||b.autoEdit),C||Xa())}function hc(){var d=
y(F),e=c[Q];if(C){if(C.isValueChanged()){var f=C.validate();return f.valid?(F<H()?(f={row:F,cell:Q,editor:C,serializedValue:C.serializeValue(),prevSerializedValue:fc,execute:function(){this.editor.applyValue(d,this.serializedValue);Da(this.row)},undo:function(){this.editor.applyValue(d,this.prevSerializedValue);Da(this.row)}},b.editCommandHandler?(la(),b.editCommandHandler(d,e,f)):(f.execute(),la()),j(D.onCellChange,{row:F,cell:Q,item:d})):(f={},C.applyValue(f,C.serializeValue()),la(),j(D.onAddNewRow,
{item:f,column:e})),!M().isActive()):(a(I).addClass("invalid"),a(I).stop(!0,!0).effect("highlight",{color:"red"},300),j(D.onValidationError,{editor:C,cellNode:I,validationResults:f,row:F,cell:Q,column:e}),C.focus(),!1)}la()}return!0}function ic(){la();return!0}function jc(a){for(var b=[],d=c.length-1,e=0;e<a.length;e++)b.push(new Slick.Range(a[e],0,a[e],d));return b}function $b(){if(!Aa)throw"Selection model is not set";return Pb}var kc={headerHeight:25,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,
leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,enableCellNavigation:!0,enableCellRangeSelection:!1,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:60,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showHeaderRow:!1,headerRowHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1},
Lb={name:"",resizable:!0,sortable:!1,minWidth:30,rerenderOnResize:!1,headerCssClass:null},Bb,Ra,Sa,jb,lb,Cb,kb=0,S=0,db=1,da,fa="slickgrid_"+Math.round(1E6*Math.random()),D=this,Gb,ea,wb,gb,fb,gc,ma,X,eb,Ob,qa,vb,ac,nb,bc,xb,Nb,$a,Tb,F,Q,I=null,C=null,fc,Hb,Y={},Rb=0,Eb,pb=0,Z=0,Qb=0,ec=0,Aa,Pb=[],Ya=[],za={},Ta={},ob,Za=!0,Ub=null,Fb=null,Sb=null,Db={},yb=null,qb=null,dc=0,cc=0;this.debug=function(){var a="";a+="\ncounter_rows_rendered:  "+dc;a+="\ncounter_rows_removed:  "+cc;a+="\nrenderedRows:  "+
Rb;a+="\nnumVisibleRows:  "+Eb;a+="\nmaxSupportedCssHeight:  "+Bb;a+="\nn(umber of pages):  "+lb;a+="\n(current) page:  "+kb;a+="\npage height (ph):  "+jb;a+="\nscrollDir:  "+db;alert(a)};this.eval=function(a){return eval(a)};a.extend(this,{slickGridVersion:"2.0a1",onScroll:new Slick.Event,onSort:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,
onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsResized:new Slick.Event,onCellChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,
onSelectedRowsChanged:new Slick.Event,registerPlugin:function(a){Ya.unshift(a);a.init(D)},unregisterPlugin:f,getColumns:function(){return c},setColumns:Ja,getColumnIndex:p,updateColumnHeader:function(a,b,d){var a=Ta[a],e=ea.children().eq(a);if(e)c[a].name=b,c[a].toolTip=d,e.attr("title",d||b||"").children().eq(0).html(b)},setSortColumn:J,autosizeColumns:o,getOptions:function(){return b},setOptions:function(c){M().commitCurrentEdit()&&(la(),b.enableAddRow!==c.enableAddRow&&ka(H()),b=a.extend(b,c),
m())},getData:function(){return g},getDataLength:H,getDataItem:y,setData:function(a,b){U();g=a;b&&wa(0)},getSelectionModel:function(){return Aa},setSelectionModel:function(a){Aa&&(Aa.onSelectedRangesChanged.unsubscribe(Ia),Aa.destroy&&Aa.destroy());Aa=a;Aa.init(D);Aa.onSelectedRangesChanged.subscribe(Ia)},getSelectedRows:$b,setSelectedRows:function(a){if(!Aa)throw"Selection model is not set";Aa.setSelectedRanges(jc(a))},render:m,invalidate:function(){Ea();U();m()},invalidateRow:ka,invalidateRows:ja,
invalidateAllRows:U,updateCell:function(a,b){var d=w(a,b);if(d){var e=c[b],f=y(a);C&&F===a&&Q===b?C.loadValue(f):(d.innerHTML=f?V(a,e)(a,b,f[e.field],e,f):"",l(a))}},updateRow:Da,getViewport:xa,resizeCanvas:ga,updateRowCount:Ea,scrollRowIntoView:ya,getCanvasNode:function(){return X[0]},getCellFromPoint:function(a,d){for(var e=Math.floor((d+S)/b.rowHeight),f=0,g=0,h=0;h<c.length&&g<a;h++)g+=c[h].width,f++;f<0&&(f=0);return{row:e,cell:f-1}},getCellFromEvent:Qa,getActiveCell:Na,setActiveCell:function(a,
d){if(!(a>H()||a<0||d>=c.length||d<0)&&b.enableCellNavigation)ya(a,!1),Ha(w(a,d),!1)},getActiveCellNode:function(){return I},getActiveCellPosition:Oa,resetActiveCell:function(){Ha(null,!1)},editActiveCell:sa,getCellEditor:function(){return C},getCellNode:w,getCellNodeBox:function(a,d){if(!cb(a,d))return null;for(var e=a*b.rowHeight-S,f=e+b.rowHeight-1,g=0,h=0;h<d;h++)g+=c[h].width;return{top:e,left:g,bottom:f,right:g+c[d].width}},canCellBeSelected:Yb,canCellBeActive:R,navigatePrev:Xb,navigateNext:Wb,
navigateUp:Vb,navigateDown:va,navigateLeft:O,navigateRight:Ka,gotoCell:Zb,getTopPanel:function(){return gc[0]},showTopPanel:function(){b.showTopPanel=!0;fb.slideDown("fast",ga)},hideTopPanel:function(){b.showTopPanel=!1;fb.slideUp("fast",ga)},showHeaderRowColumns:function(){b.showHeaderRow=!0;gb.slideDown("fast",ga)},hideHeaderRowColumns:function(){b.showHeaderRow=!1;gb.slideUp("fast",ga)},getHeaderRow:function(){return wb[0]},getHeaderRowColumn:function(a){a=Ta[a];return(a=wb.children().eq(a))&&
a[0]},getGridPosition:function(){return ta(da[0])},flashCell:function(c,d,e){e=e||100;if(Y[c]){var f=a(w(c,d)),g=function(a){a&&setTimeout(function(){f.queue(function(){f.toggleClass(b.cellFlashingCssClass).dequeue();g(a-1)})},e)};g(4)}},addCellCssStyles:B,setCellCssStyles:rb,removeCellCssStyles:Wa,destroy:function(){M().cancelCurrentEdit();j(D.onBeforeDestroy,{});for(var a=0;a<Ya.length;a++)f(Ya[a]);b.enableColumnReorder&&ea.sortable&&ea.sortable("destroy");X.parents().unbind("scroll.slickgrid");
da.unbind(".slickgrid");eb.remove();X.unbind("draginit dragstart dragend drag");da.empty().removeClass(fa)},getEditorLock:M,getEditController:function(){return Hb}});(function(){da=a(e);if(da.length<1)throw Error("SlickGrid requires a valid container, "+e+" does not exist in the DOM.");Bb=q();d=d||i();b=a.extend({},kc,b);Lb.width=b.defaultColumnWidth;if(b.enableColumnReorder&&!a.fn.sortable)throw Error('SlickGrid\'s "enableColumnReorder = true" option requires jquery-ui.sortable module to be loaded');
Hb={commitCurrentEdit:hc,cancelCurrentEdit:ic};da.empty().attr("tabIndex",0).attr("hideFocus",!0).css("overflow","hidden").css("outline",0).addClass(fa).addClass("ui-widget");/relative|absolute|fixed/.test(da.css("position"))||da.css("position","relative");Gb=a("<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />").appendTo(da);ea=a("<div class='slick-header-columns' style='width:10000px; left:-1000px' />").appendTo(Gb);gb=a("<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />").appendTo(da);
wb=a("<div class='slick-headerrow-columns' style='width:10000px;' />").appendTo(gb);fb=a("<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />").appendTo(da);gc=a("<div class='slick-top-panel' style='width:10000px' />").appendTo(fb);b.showTopPanel||fb.hide();b.showHeaderRow||gb.hide();ma=a("<div class='slick-viewport' tabIndex='0' hideFocus style='width:100%;overflow-x:auto;outline:0;position:relative;overflow-y:auto;'>").appendTo(da);X=a("<div class='grid-canvas' tabIndex='0' hideFocus />").appendTo(ma);
ab();t(ea);b.enableTextSelectionOnCells||ma.bind("selectstart.ui",function(b){return a(b.target).is("input,textarea")});vb=parseFloat(a.css(da[0],"width",!0));A();aa();Va();ha();G();ma.bind("scroll.slickgrid",ca);da.bind("resize.slickgrid",ha);Gb.bind("contextmenu.slickgrid",bb).bind("click.slickgrid",Ua);X.bind("keydown.slickgrid",Kb).bind("click.slickgrid",Jb).bind("dblclick.slickgrid",ib).bind("contextmenu.slickgrid",tb).bind("draginit",Ib).bind("dragstart",zb).bind("drag",sb).bind("dragend",Ab);
X.delegate(".slick-cell","mouseenter",Mb);X.delegate(".slick-cell","mouseleave",oa)})()}}});var d})(jQuery);